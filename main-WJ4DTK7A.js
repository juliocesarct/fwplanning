import{$ as Xh,$a as bd,A as qr,Aa as ld,B as je,Ba as rn,C as Ue,Ca as _a,D as Y,Da as Wr,E as Re,Ea as Fn,F as Hh,Fa as rs,G as On,Ga as is,H as Vn,Ha as ya,I as q,Ia as hd,J as W,Ja as ss,K as le,Ka as dd,L as Be,La as fd,M as _e,Ma as pd,N as ce,Na as md,O as Ji,Oa as gd,P as mt,Pa as _d,Q as gt,Qa as yd,R as _t,Ra as vd,S as Xi,Sa as Id,T as Qh,Ta as Bt,U as pa,Ua as os,V as $r,Va as qt,W as zr,X as jr,Xa as $t,Y as Lt,Ya as wd,Z as Yh,Za as Td,_ as Jh,_a as Ed,a as me,aa as Zh,ab as as,b as ge,ba as ma,bb as Ad,c as A,ca as ga,cb as kd,d as nn,da as Ft,e as $h,ea as ed,eb as Sd,f as zh,fa as td,fb as Cd,g as ha,ga as it,gb as Un,h as da,ha as nd,hb as Rd,i as fa,ia as Ge,ib as Pd,j as Wi,ja as rd,jb as Dd,k as Ot,ka as yt,kb as Ke,l as Ki,la as Ut,m as jh,ma as Zi,n as j,na as id,o as Vt,oa as Mn,p as Hi,pa as es,q as Gh,qa as sd,r as Qi,ra as od,s as Wh,sa as ad,t as Se,ta as Ln,u as Ce,ua as ts,v as xn,va as ns,w as Yi,wa as Gr,x as Mt,xa as We,y as Kh,ya as cd,z as G,za as ud}from"./chunk-Y45SICEN.js";var Nd={firebaseConfig:{apiKey:"AIzaSyBhtbtHAs6G_oBGnkouj1Y1gbOtHhzlXdQ",authDomain:"fwplanning-2841b.firebaseapp.com",projectId:"fwplanning-2841b",storageBucket:"fwplanning-2841b.firebasestorage.app",messagingSenderId:"934243537679",appId:"1:934243537679:web:73b6f9029ada9e9a53247a",measurementId:"G-GBWGVW1H04"}};var xd={perComponent:{},onRoot:{}},Od={perComponent:{"kendo-grid":{"--background-color-groupable":"var(--color-neutral-light-05)"},"kendo-grid .k-grid-header, kendo-grid .k-grouping-header, kendo-grid .k-grid-add-row, kendo-grid .k-grid-footer":{color:"var(--color-neutral-dark-70)"},"kendo-grid .k-grid-content":{"background-color":"var(--color-neutral-light-00)"},"kendo-grid .k-grid-toolbar":{color:"var(--color-neutral-dark-90)"},"po-badge":{"--color":"var(--color-neutral-dark-95)"},"po-badge[p-status=warning]":{"--color":"var(--color-neutral-light-00)"}},onRoot:{"--color-page-background-color-page":"var(--color-neutral-light-00)"}},Ld={color:{brand:{"01":{lightest:"#ffebee",lighter:"#ef9a9a",light:"#ef5350",base:"#c20c18",dark:"#a5131a",darker:"#5d0d11",darkest:"#400a08"},"02":{base:"var(--color-brand-01-base)"},"03":{base:"var(--color-brand-01-base)"}},action:_a,neutral:ge(me({},Wr),{light:ge(me({},Wr.light),{"05":"#f2f2f2",10:"#e5e5e5",20:"#cccccc",30:"#b2b2b2"}),mid:{40:"#999999",60:"#666666"},dark:{70:"#4d4d4d",80:"#363636",90:"#1a1a1a",95:"#0d0d0d"}}),feedback:ge(me({},Fn),{negative:{lightest:"#f1e8fd",lighter:"#d691e1",light:"#ba6bcd",base:"#7b1fa2",dark:"#4a148c",darker:"#3e166f",darkest:"#1e0a36"}}),categorical:rs,"categorical-overlay":is}},d_={color:{brand:{"01":{lightest:"#ffebee",lighter:"#ef9a9a",light:"#ef5350",base:"#c20c18",dark:"#a5131a",darker:"#5d0d11",darkest:"#400a08"},"02":{base:"var(--color-brand-01-base)"},"03":{base:"var(--color-brand-01-base)"}},action:ge(me({},Ld.color?.action),{disabled:"var(--color-neutral-mid-40)"}),neutral:ge(me({},Wr),{light:ge(me({},Wr.light),{"05":"#f2f2f2",10:"#e5e5e5",20:"#cccccc",30:"#b2b2b2"}),mid:{40:"#999999",60:"#666666"},dark:{70:"#4d4d4d",80:"#363636",90:"#1a1a1a",95:"#0d0d0d"}}),feedback:ge(me({},Fn),{negative:{lightest:"#f1e8fd",lighter:"#d691e1",light:"#ba6bcd",base:"#7b1fa2",dark:"#4a148c",darker:"#3e166f",darkest:"#1e0a36"}}),categorical:rs,"categorical-overlay":is}},Fd={color:{brand:{"01":{lightest:"#d7f0fe",lighter:"#9cd8fc",light:"#6bc5fa",base:"#045b8f",dark:"#013f65",darker:"#002944",darkest:"#00182b"},"02":{base:"var(--color-brand-01-base)"},"03":{base:"var(--color-brand-01-base)"}},action:_a,neutral:{light:{"00":"#ffffff","05":"#f2f2f2",10:"#e5e5e5",20:"#cccccc",30:"#b2b2b2"},mid:{40:"#999999",60:"#666666"},dark:{70:"#4d4d4d",80:"#363636",90:"#1a1a1a",95:"#121212"}},feedback:Fn,categorical:rs,"categorical-overlay":is}},f_={color:{brand:{"01":{lightest:"#e3eefb",lighter:"#afd3fa",light:"#3dadfa",base:"#0079b8",dark:"#00659a",darker:"#004064",darkest:"#051f31"},"02":{base:"#0079b8"},"03":{base:"#0079b8"}},action:ge(me({},Fd.color?.action),{disabled:"var(--color-neutral-mid-40)"}),neutral:{light:{"00":"#fbfbfb","05":"#eeeeee",10:"#d9d9d9",20:"#c1c1c1",30:"#a1a1a1"},mid:{40:"#7c7c7c",60:"#5a5a5a"},dark:{70:"#3b3b3b",80:"#2b2b2b",90:"#202020",95:"#1c1c1c"}},feedback:ge(me({},Fn),{info:ge(me({},Fn.info),{base:"#23489f"})}),categorical:gd,"categorical-overlay":_d}},va={color:{brand:{"01":{lightest:"#00182b",lighter:"#002944",light:"#013f65",base:"#045b8f",dark:"#6bc5fa",darker:"#9cd8fc",darkest:"#d7f0fe"},"02":{base:"var(--color-brand-01-dark)"},"03":{base:"var(--color-brand-01-dark)"}},action:ge(me({},ya),{disabled:"var(--color-neutral-light-30)"}),neutral:{light:{"00":"#121212","05":"#1a1a1a",10:"#363636",20:"#4d4d4d",30:"#666666"},mid:{40:"#999999",60:"#b2b2b2"},dark:{70:"#cccccc",80:"#e5e5e5",90:"#f2f2f2",95:"#ffffff"}},feedback:ss,categorical:dd,"categorical-overlay":fd}},p_=ge(me({},va),{color:ge(me({},va.color),{brand:{"01":{lightest:"#051f31",lighter:"#004064",light:"#00659a",base:"#0079b8",dark:"#3dadfa",darker:"#afd3fa",darkest:"#e3eefb"},"02":{base:"var(--color-brand-01-dark)"},"03":{base:"var(--color-brand-01-dark)"}},action:ya,neutral:hd,feedback:ge(me({},ss),{info:ge(me({},ss.info),{base:"#23489f"})}),categorical:pd,"categorical-overlay":md})}),Vd={perComponent:{".po-lookup-filter-content .po-field-icon-container-right":{top:"50%"},"po-accordion":{"--font-weight":"var(--font-weight-normal)"},"po-accordion-manager":{"--font-weight":"var(--font-weight-normal)"},"po-button":{"--font-weight":"var(--font-weight-normal)","--border-width":"var(--border-width-sm)"},"po-button .po-button[p-kind=primary]:disabled":{color:"var(--color-neutral-light-00)"},"po-button-group":{"--button-group-container-margin":"-1px"},"po-button-group .po-button":{"--font-weight":"var(--font-weight-normal)","--border-width":"var(--border-width-sm)"},"po-badge":{"--font-weight":"var(--font-weight-normal)"},"po-breadcrumb":{"--font-weight":"var(--font-weight-normal)"},"po-link":{"--font-weight":"var(--font-weight-normal)","--font-weight-lvl0":"var(--font-weight-normal)"},"po-combo":{"--color":"var(--color-neutral-light-30)","--min-width":"auto"},"po-dropdown":{"--font-weight":"var(--font-weight-normal)","--border-width":"var(--border-width-sm)"},"po-dynamic-view po-info .po-info-container-content":{"--padding":"4px 0 var(--spacing-sm) 0"},"po-dynamic-view po-info .po-info-label-horizontal":{"--padding":"0 var(--spacing-xs) var(--spacing-sm) 0"},"po-dynamic-view po-tag":{"--gap":"0.25rem","--padding":"0 0 var(--spacing-sm) 0"},"po-info .po-info-label":{"--color-info-color-text-label":"var(--color-neutral-dark-90)","font-weight":"var(--font-weight-normal)"},"po-input, po-url, po-select, po-login, po-email, po-password, po-lookup, po-decimal, po-number, po-datepicker, po-datepicker-range, po-datepicker-range .po-datepicker-range-field, .po-datepicker-range-field, div.po-lookup-filter-content input.po-input, input.po-input":{"--color":"var(--color-neutral-light-30)","--font-weight":"var(--font-weight-normal)","--font-weight-selected":"var(--font-weight-normal)"},"po-label":{"--font-weight-field":"var(--font-weight-normal)","--font-size-required":"var(--font-size-default)"},"po-menu-item":{"--font-weight-lvl0":"var(--font-weight-normal)"},"po-menu-filter":{"--color":"var(--color-neutral-light-30)","--color-icon-read":"var(--color-brand-01-dark)"},"po-multiselect":{"--color":"var(--color-neutral-light-30)","--color-icon":"var(--color-brand-01-dark)"},".po-item-list__check .po-field-container-bottom":{padding:"0"},".po-item-list__check .po-field-container .po-field-container-content":{padding:"var(--spacing-xs) 0"},"po-page-header .po-page-header-title":{"--font-family":"var(--font-family-theme-extra-light)"},"po-popup po-item-list":{"--font-weight":"var(--font-weight-normal)","--font-weight-selected":"var(--font-weight-normal)"},"po-rich-text":{"--border-rich-text-body-border":"1px solid var(--color-neutral-light-30)","--border-rich-text-toolbar-border":"1px solid var(--color-neutral-light-30)"},"po-rich-text .po-button":{"--border-width":"var(--border-width-sm)"},"po-search":{"--color":"var(--color-neutral-light-30)"},"po-table":{"--font-weight-headline":"var(--font-weight-normal)"},"po-table-list-manager":{"--font-weight":"var(--font-weight-normal)"},".po-table-list-manager-item-switch .po-field-container-bottom":{padding:"0"},".po-table-column-selectable .po-field-container-bottom":{padding:"0"},".po-table-list-manager-item-switch .po-field-container .po-field-container-content":{padding:"var(--spacing-xs) 0"},"po-tag":{"--font-size":"var(--font-size-sm)","--font-weight":"var(--font-weight-normal)"},"po-textarea":{"--color":"var(--color-neutral-light-30)"},"po-tabs":{"--background":"var(--color-transparent)"},"po-tab-button":{"--background-item-selected":"var(--color-brand-01-lightest)"},"po-tab-dropdown po-item-list":{"--font-weight":"var(--font-weight-normal)"},".po-tab-button-default:not(.po-tab-button-disabled, .po-tab-dropdown-content):hover":{"--background-item-hover":"var(--color-brand-01-lightest)"},"po-tab-dropdown .po-button[p-kind='tertiary']:hover":{"--background-hover":"var(--color-brand-01-lightest)"},".po-list-view-select .po-field-container-bottom":{padding:"0"},".po-list-view-select .po-field-container .po-field-container-content":{padding:"var(--spacing-xs) 0"}},onRoot:{"--font-size-default-normal":"16px","--font-family-default-bold":"var(--font-family-theme)"}},Md={perComponent:{"po-combo":{"--background":"var(--color-neutral-light-00)","--color-hover":"var(--color-secondary-dark-20)","--color-focused":"var(--color-secondary)","--background-disabled":"var(--color-neutral-light-05)"},"po-checkbox":{"--border-color":"var(--color-neutral)","--color-checked-disabled":"var(--color-neutral)"},"po-disclaimer":{"--outline-color-focused":"var(--color-action-focus)"},"po-divider":{"--font-size":"var(--font-size-default)","--line-height":"var(--line-height-none)","--text-transform":"none"},"po-dropdown":{"--color-hover":"var(--color-action-focus),"},".po-field-container-content:not(.po-listbox-container-search):not(.po-lookup):not(.po-combo-container-content) .po-field-icon-container-left, .po-field-container-content:not(.po-listbox-container-search):not(.po-lookup):not(.po-combo-container-content) .po-field-icon-container-right":{top:"47%"},"po-field-container .po-field-container-content":{"--padding":"4px 0 var(--spacing-xs) 0"},"po-field-container-bottom .po-field-container-bottom:empty":{"--padding-bottom":"var(--spacing-xs)"},"po-field-container-bottom .po-field-container-bottom:not(:empty)":{"--padding-bottom":"var(--spacing-sm)"},"po-rich-text-body .po-rich-text-body:focus-visible, po-info .po-info-link:focus-visible, po-list-view a.po-list-view-title-link:focus-visible, po-stepper-circle .po-stepper-circle:focus-visible":{"border-color":"var(--color-action-default);","outline-color":"var(--color-action-focus);","outline-width":"var(--outline-width-focus-visible);","outline-style":"solid;","outline-offset":"2px;"},"po-input, po-url, po-login, po-email, po-password, po-lookup, po-decimal, po-number, po-datepicker, po-datepicker-range, po-datepicker-range .po-datepicker-range-field, div.po-lookup-filter-content input.po-input, input.po-input":{"--background":"var(--color-neutral-light-00)","--background-disabled":"var(--color-neutral-light-05)"},"po-item-list":{"--outline-color-focused":"var(--color-outline-focused)","--background-pressed":"var(--color-secondary-light-40)","--color-option":"var(--color-neutral-dark-60)"},"po-lookup":{"--background":"var(--color-neutral-light-00)","--background-disabled":"var(--color-neutral-light-05)","--color-disabled":"var(--color-neutral-light-30)","--color-hover":"var(--color-brand-01-dark)"},"po-menu-filter":{"--color":"var(--color-neutral)","--background":"var(--color-neutral-light-00)"},"po-multiselect":{"--color":"var(--color-neutral)","--background":"var(--color-neutral-light-00)","--background-disabled":"var(--color-neutral-light-05)"},".po-item-list__check .po-field-container-bottom":{padding:"0"},".po-item-list__check .po-field-container .po-field-container-content":{padding:"var(--spacing-xs) 0"},"po-rich-text":{"--color-rich-text-body-background-color":"var(--color-neutral-light-00)"},"po-rich-text[ng-reflect-readonly=true]":{"--color-rich-text-body-background-color":"var(--color-neutral-light-00)","--border-rich-text-body-border":"1px solid var(--color-neutral-light-30)","--border-rich-text-toolbar-border":"1px solid var(--color-neutral-light-30)"},"po-search":{"--background":"var(--color-neutral-light-00)","--background-disabled":"var(--color-neutral-light-05)"},"po-select":{"--background":"var(--color-neutral-light-00)","--background-disabled":"var(--color-neutral-light-05)","--background-image":`url("data:image/svg+xml,%3Csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M18.707 8.29301C18.316 7.90201 17.684 7.90201 17.293 8.29301L12 13.586L6.70701 8.29301C6.31601 7.90201 5.68401 7.90201 5.29301 8.29301C4.90201 8.68401 4.90201 9.31601 5.29301 9.70701L11.293 15.707C11.488 15.902 11.744 16 12 16C12.256 16 12.512 15.902 12.707 15.707L18.707 9.70701C19.098 9.31601 19.098 8.68401 18.707 8.29301Z' fill='#013F65'/%3E%3C/svg%3E%0A")`},"po-tabs, po-tab-button":{"--background":"var(--color-transparent)"},"po-tab-button":{"--background-item-selected":"var(--color-brand-01-lightest)"},"po-table-list-manager":{"--color-type":"var(--color-neutral)"},".po-table-list-manager-item-switch .po-field-container-bottom":{padding:"0"},".po-table-column-selectable .po-field-container-bottom":{padding:"0"},".po-table-list-manager-item-switch .po-field-container .po-field-container-content":{padding:"var(--spacing-xs) 0"},"po-textarea":{"--background":"var(--color-neutral-light-00)","--background-disabled":"var(--color-neutral-light-05)"},"po-widget":{"--shadow":"var(--shadow-sm)"},".po-list-view-select .po-field-container-bottom":{padding:"0"},".po-list-view-select .po-field-container .po-field-container-content":{padding:"var(--spacing-xs) 0"},"thf-grid .components-form .po-field-container-content":{"padding-top":"8px"},"thf-grid .components-form .po-field-container-bottom":{"padding-bottom":"0px"},"thf-grid .components-form .po-field-container-content .po-field-icon-container-left, thf-grid .components-form .po-field-container-content .po-field-icon-container-left.ng-star-inserted, thf-grid .components-form .po-field-container-content:not(.po-combo-container-content) .po-field-icon-container-right:not(.po-clickable), thf-grid .components-form .po-field-container-content > div.thf-lookup-input .po-field-icon-container-right.po-clickable":{top:"50% !important"},"thf-grid .components-form .po-field-container-content > div:not(.thf-lookup-input) .po-field-icon-container-right.po-clickable":{top:"53% !important"}},onRoot:{"--font-family":"Lato","--font-family-theme":"Lato, sans-serif","--font-family-theme-bold":"Lato-Bold, sans-serif","--font-family-theme-extra-light":"Lato-Light, sans-serif","--font-family-heading":"Lato, sans-serif","--font-family-default-bold":"var(--font-family-theme-bold)","--color-neutral":"var(--color-neutral-dark-70)","--color-primary-light-80":"color-mix(in srgb, var(--color-brand-02-base) 80%, white)","--color-primary-light-95":"color-mix(in srgb, var(--color-brand-02-base) 95%, white)","--color-primary-alpha-50":"color-mix(in srgb, var(--color-brand-02-base) 50%, transparent)","--color-primary-dark-20":"color-mix(in srgb, var(--color-brand-02-base) 20%, black)","--color-primary-dark-40":"color-mix(in srgb, var(--color-brand-02-base) 40%, black)","--color-secondary":"var(--color-brand-01-base)","--color-secondary-light-20":"var(--color-brand-01-lighter)","--color-secondary-light-40":"var(--color-brand-01-light)","--color-secondary-dark-20":"var(--color-brand-01-dark)","--color-secondary-dark-40":"var(--color-brand-01-darker)","--color-secondary-dark-60":"#052d3e","--color-secondary-dark-80":"var(--color-brand-01-darkest)","--color-secondary-dark-60-alpha-70":"color-mix(in srgb, var(--color-neutral-mid-60) 70%, black)","--color-tertiary-light-90":"color-mix(in srgb, var(--color-brand-03-base) 90%, white)","--color-tertiary-dark-5":"color-mix(in srgb, var(--color-brand-03-base) 5%, black)","--color-tertiary-dark-40":"#186d76","--color-tertiary-dark-60":"#10484e","--color-feedback-negative-base-dark-20":"#9e3933","--color-calendar-arrow":"var(--color-action-default)","--color-calendar-title":"var(--color-action-default)","--color-calendar-text-box-background-active":"var(--color-neutral-light-00)","--color-calendar-background-color-border-today":"var(--color-action-default)","--color-calendar-color-box-foreground":"var(--color-neutral)","--color-calendar-color-box-foreground-selected":"var(--color-neutral-light-00)","--color-calendar-color-box-foreground-pressed":"var(--color-neutral-light-00)","--color-calendar-color-box-foreground-range":"var(--color-action-default)","--color-calendar-color-box-foreground-today":"var(--color-action-default)","--color-calendar-background-color-box-background-range":"var(--color-brand-01-lightest)","--color-chart-legend-text":"var(--color-neutral)","--color-checkbox-group-background-color":"var(--color-neutral-light-00)","--color-checkbox-group-background-color-active":"var(--color-action-default)","--color-checkbox-group-background-color-disabled":"var(--color-neutral-light-10)","--color-checkbox-group-background-color-icon-disabled":"var(--color-neutral-light-30)","--color-checkbox-group-box-shadow-color-focusable":"var(--color-brand-01-dark)","--color-checkbox-group-border-input":"var(--color-neutral-light-30)","--color-checkbox-group-border-input-active":"var(--color-action-default)","--color-checkbox-group-border-input-disabled":"var(--color-neutral-light-30)","--color-checkbox-group-color-active":"var(--color-neutral-light-00)","--color-datepicker-range-color-focused":"var(--color-secondary)","--color-disclaimer-group-font-title":"var(--color-neutral)","--color-gauge-description-text-color":"var(--color-neutral)","--color-gauge-description-bottom-focus":"var(--color-secondary)","--color-gauge-legend-text":"var(--color-neutral)","--color-gauge-pointer-color":"var(--color-neutral)","--color-info-color-text-label":"var(--color-neutral)","--color-info-color-link":"var(--color-action-default)","--color-info-color-link-hover":"var(--color-brand-01-dark)","--color-info-color-link-pressed":"var(--color-brand-01-darker)","--color-list-view-color-primary":"var(--color-action-default)","--color-list-view-color-primary-hover":"var(--color-brand-01-dark)","--color-list-view-color-select-all-label":"var(--color-neutral)","--color-lookup-search-border-text-focusable":"var(--color-action-default)","--color-lookup-advanced-search-link-color-text":"var(--color-action-default)","--color-menu-panel-background-color-item-selected":"var(--color-black-alpha-30)","--color-menu-panel-background-color-menu":"var(--color-neutral-dark-80)","--color-menu-panel-border-top-logo":"var(--color-neutral-alpha-45)","--color-menu-panel-color-menu-item-text":"var(--color-action-default)","--color-menu-panel-color-menu-item-selected":"var(--color-neutral-light-00)","--color-modal-password-recovery-link-color":"var(--color-action-default)","--color-modal-password-recovery-link-color-hover":"var(--color-brand-01-dark)","--color-modal-password-recovery-text-color":"var(--color-neutral)","--color-navbar-action-color-content":"var(--color-action-default)","--color-navbar-item-color":"var(--color-action-default)","--color-navbar-item-color-selected":"var(--color-neutral)","--color-navbar-item-color-shadow-selected":"var(--color-action-default)","--color-navbar-item-navigation-color-icon":"var(--color-action-default)","--color-page-background-color-page":"var(--color-neutral-light-00)","--color-page-blocked-user-link-color":"var(--color-action-default)","--color-page-blocked-user-link-color-hover":"var(--color-brand-01-dark)","--color-page-blocked-user-text-color":"var(--color-neutral)","--color-page-change-password-color-link":"var(--color-action-default)","--color-page-change-password-color-text":"var(--color-neutral)","--color-page-change-password-color-required":"var(--color-neutral)","--color-page-content-background-color-scrollbar":"var(--color-action-default)","--color-page-list-color-link-text":"var(--color-action-default)","--color-page-login-header-product-name-color":"var(--color-neutral)","--color-page-login-header-welcome-color":"var(--color-brand-03-base)","--color-page-login-link-color":"var(--color-action-default)","--color-page-login-link-hover-color":"var(--color-brand-01-dark)","--color-page-login-popover-color-attempts":"var(--color-action-default)","--color-page-login-support-color":"var(--color-action-default)","--color-page-slide-close-button-color":"var(--color-action-default)","--color-popover-background-color-scrollbar":"var(--color-action-default)","--color-popover-color-text-title":"var(--color-neutral)","--color-rich-text-body-text-selected-color":"var(--color-brand-01-lighter)","--color-slide-background-color-active-circle":"var(--color-action-default)","--color-slide-border-arrow":"var(--color-action-default)","--color-table-color-subtitle-text":"var(--color-neutral-light-00)","--color-table-color-single-action-hover":"var(--color-brand-01-dark)","--color-toolbar-background-color-toolbar":"var(--color-neutral-light-05)","--color-toolbar-color-default":"var(--color-action-default)","--color-toolbar-color-title":"var(--color-brand-03-base)","--color-tree-view-item-header-button-color":"var(--color-action-default)","--color-tree-view-item-header-button-focus":"var(--color-secondary)","--color-tree-view-item-header-label-text-color":"var(--color-neutral)","--color-upload-color-text-filename-loading":"var(--color-neutral-light-00)","--color-upload-border-hover":"var(--color-brand-01-dark)","--color-upload-color-hover":"var(--color-brand-01-dark)","--color-upload-border-pressed":"var(--color-brand-01-darker)","--color-upload-color-pressed":"var(--color-brand-01-darker)","--color-upload-color-text-load-waiting":"var(--color-neutral)","--color-upload-drag-drop-overlay-text":"var(--color-action-default)","--color-upload-drag-drop-area-label-text":"var(--color-neutral)","--color-upload-drag-drop-area-select-files-text":"var(--color-action-default)","--color-upload-drag-drop-area-border-primary":"var(--color-action-default)","--color-upload-file-restrictions-color-text":"var(--color-neutral)","--color-widget-color-action-active":"var(--color-brand-01-dark)","--color-widget-color-action-hover":"var(--color-brand-01-dark)","--color-widget-color-action":"var(--color-action-default)","--color-widget-color-default":"var(--color-neutral)","--color-widget-color-title-action":"var(--color-action-default)","--color-widget-color-widget-primary":"var(--color-neutral-light-00)"}},m_={name:"sunset",type:[{light:Ld,a11y:We.AAA},{light:d_,a11y:We.AA}],active:{type:rn.light,a11y:We.AAA}},cs={name:"totvs",type:[{light:Fd,dark:va,a11y:We.AAA},{light:f_,dark:p_,a11y:We.AA}],active:{type:rn.light,a11y:We.AA}},Ud=function(n){return n.Totvs="totvs",n.Sunset="sunset",n}(Ud||{}),Bd=(()=>{class n{constructor(t){this.themeService=t,this.applyThfBaseStyle()}applyThfBaseStyle(){this.themeService.setPerComponentAndOnRoot(void 0,Md.perComponent,Md.onRoot,Object.values(Ud)),this.themeService.setPerComponentAndOnRoot({a11y:We.AA},Vd.perComponent,Vd.onRoot),this.themeService.setPerComponentAndOnRoot({type:rn.light},xd.perComponent,xd.onRoot),this.themeService.setPerComponentAndOnRoot({type:rn.dark},Od.perComponent,Od.onRoot),this.themeService.getThemeActive()===void 0&&this.themeService.setTheme(cs,rn.light,We.AA,!1)}setTheme(t,r=rn.light,i=We.AAA,o=!0){t===yd?this.themeService.resetBaseTheme():(t===m_||t===cs)&&this.applyThfBaseStyle(),this.themeService.setTheme(t,r,i,o)}getThemeActive(){return this.themeService.getThemeActive()}applyTheme(t){return this.themeService.applyTheme(t)}setCurrentThemeA11y(t){this.themeService.setCurrentThemeA11y(t)}changeCurrentThemeType(t){this.themeService.changeCurrentThemeType(t)}static{this.\u0275fac=function(r){return new(r||n)(jh(vd))}}static{this.\u0275prov=Ot({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var us=class n{themeService=j(Bd);constructor(){this.themeService.setTheme(cs,1,We.AA)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=je({type:n,selectors:[["app-root"]],decls:3,vars:0,consts:[["p-title","Frame Planning Poker"]],template:function(t,r){t&1&&(q(0,"div"),le(1,"po-toolbar",0)(2,"router-outlet"),W())},dependencies:[Ke,Dd,Ft,nd],encapsulation:2})};var qd=()=>{};var jd=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},g_=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){let o=n[t++],a=n[t++],u=n[t++],h=((i&7)<<18|(o&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{let o=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},ls={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let o=n[i],a=i+1<n.length,u=a?n[i+1]:0,h=i+2<n.length,d=h?n[i+2]:0,p=o>>2,y=(o&3)<<4|u>>4,v=(u&15)<<2|d>>6,S=d&63;h||(S=64,a||(v=64)),r.push(t[p],t[y],t[v],t[S])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(jd(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):g_(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let o=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let y=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||u==null||d==null||y==null)throw new wa;let v=o<<2|u>>4;if(r.push(v),d!==64){let S=u<<4&240|d>>2;if(r.push(S),y!==64){let P=d<<6&192|y;r.push(P)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},wa=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},__=function(n){let e=jd(n);return ls.encodeByteArray(e,!0)},Qr=function(n){return __(n).replace(/\./g,"")},hs=function(n){try{return ls.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Ea(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var y_=()=>Ea().__FIREBASE_DEFAULTS__,v_=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},I_=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&hs(n[1]);return e&&JSON.parse(e)},ds=()=>{try{return qd()||y_()||v_()||I_()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Gd=n=>{var e,t;return(t=(e=ds())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Wd=n=>{let e=Gd(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},ba=()=>{var n;return(n=ds())===null||n===void 0?void 0:n.config},Kd=n=>{var e;return(e=ds())===null||e===void 0?void 0:e[`_${n}`]};var sn=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function qn(n){return n.endsWith(".cloudworkstations.dev")}function Aa(n){return A(this,null,function*(){return(yield fetch(n,{credentials:"include"})).ok})}function Hd(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Qr(JSON.stringify(t)),Qr(JSON.stringify(a)),""].join(".")}var Hr={};function w_(){let n={prod:[],emulator:[]};for(let e of Object.keys(Hr))Hr[e]?n.emulator.push(e):n.prod.push(e);return n}function T_(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var $d=!1;function fs(n,e){if(typeof window>"u"||typeof document>"u"||!qn(window.location.host)||Hr[n]===e||Hr[n]||$d)return;Hr[n]=e;function t(v){return`__firebase__banner__${v}`}let r="__firebase__banner",o=w_().prod.length>0;function a(){let v=document.getElementById(r);v&&v.remove()}function u(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function h(v,S){v.setAttribute("width","24"),v.setAttribute("id",S),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function d(){let v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{$d=!0,a()},v}function p(v,S){v.setAttribute("id",S),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function y(){let v=T_(r),S=t("text"),P=document.getElementById(S)||document.createElement("span"),x=t("learnmore"),D=document.getElementById(x)||document.createElement("a"),$=t("preprendIcon"),F=document.getElementById($)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){let z=v.element;u(z),p(D,x);let ne=d();h(F,$),z.append(F,P,D,ne),document.body.appendChild(z)}o?(P.innerText="Preview backend disconnected.",F.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(F.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,P.innerText="Preview backend running in this workspace."),P.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}function qe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Qd(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(qe())}function E_(){var n;let e=(n=ds())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Yd(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Jd(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Xd(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Zd(){return!E_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Yr(){try{return typeof indexedDB=="object"}catch{return!1}}function ef(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}var b_="FirebaseError",He=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=b_,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ze.prototype.create)}},Ze=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?A_(o,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new He(i,u,r)}};function A_(n,e){return n.replace(k_,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var k_=/\{\$([^}]+)}/g;function on(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let o=n[i],a=e[i];if(zd(o)&&zd(a)){if(!on(o,a))return!1}else if(o!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function zd(n){return n!==null&&typeof n=="object"}function ka(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function tf(n,e){let t=new Ta(n,e);return t.subscribe.bind(t)}var Ta=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");S_(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Ia),i.error===void 0&&(i.error=Ia),i.complete===void 0&&(i.complete=Ia);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function S_(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ia(){}var WE=4*60*60*1e3;function we(n){return n&&n._delegate?n._delegate:n}var Ve=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var an="[DEFAULT]";var Sa=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new sn;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(R_(e))try{this.getOrInitializeService({instanceIdentifier:an})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=an){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return A(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=an){return this.instances.has(e)}getOptions(e=an){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,a]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(o);r===u&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);let a=this.instances.get(i);return a&&e(a,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:C_(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=an){return this.component?this.component.multipleInstances?e:an:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function C_(n){return n===an?void 0:n}function R_(n){return n.instantiationMode==="EAGER"}var ps=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Sa(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var P_=[],H=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(H||{}),D_={debug:H.DEBUG,verbose:H.VERBOSE,info:H.INFO,warn:H.WARN,error:H.ERROR,silent:H.SILENT},N_=H.INFO,x_={[H.DEBUG]:"log",[H.VERBOSE]:"log",[H.INFO]:"info",[H.WARN]:"warn",[H.ERROR]:"error"},O_=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=x_[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},st=class{constructor(e){this.name=e,this._logLevel=N_,this._logHandler=O_,this._userLogHandler=null,P_.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in H))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?D_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,H.DEBUG,...e),this._logHandler(this,H.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,H.VERBOSE,...e),this._logHandler(this,H.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,H.INFO,...e),this._logHandler(this,H.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,H.WARN,...e),this._logHandler(this,H.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,H.ERROR,...e),this._logHandler(this,H.ERROR,...e)}};var V_=(n,e)=>e.some(t=>n instanceof t),nf,rf;function M_(){return nf||(nf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function L_(){return rf||(rf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var sf=new WeakMap,Ra=new WeakMap,of=new WeakMap,Ca=new WeakMap,Da=new WeakMap;function F_(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{t(ot(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&sf.set(t,n)}).catch(()=>{}),Da.set(e,n),e}function U_(n){if(Ra.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});Ra.set(n,e)}var Pa={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Ra.get(n);if(e==="objectStoreNames")return n.objectStoreNames||of.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ot(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function af(n){Pa=n(Pa)}function B_(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(ms(this),e,...t);return of.set(r,e.sort?e.sort():[e]),ot(r)}:L_().includes(n)?function(...e){return n.apply(ms(this),e),ot(sf.get(this))}:function(...e){return ot(n.apply(ms(this),e))}}function q_(n){return typeof n=="function"?B_(n):(n instanceof IDBTransaction&&U_(n),V_(n,M_())?new Proxy(n,Pa):n)}function ot(n){if(n instanceof IDBRequest)return F_(n);if(Ca.has(n))return Ca.get(n);let e=q_(n);return e!==n&&(Ca.set(n,e),Da.set(e,n)),e}var ms=n=>Da.get(n);function uf(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){let a=indexedDB.open(n,e),u=ot(a);return r&&a.addEventListener("upgradeneeded",h=>{r(ot(a.result),h.oldVersion,h.newVersion,ot(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}var $_=["get","getKey","getAll","getAllKeys","count"],z_=["put","add","delete","clear"],Na=new Map;function cf(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Na.get(e))return Na.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=z_.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||$_.includes(t)))return;let o=function(a,...u){return A(this,null,function*(){let h=this.transaction(a,i?"readwrite":"readonly"),d=h.store;return r&&(d=d.index(u.shift())),(yield Promise.all([d[t](...u),i&&h.done]))[0]})};return Na.set(e,o),o}af(n=>ge(me({},n),{get:(e,t,r)=>cf(e,t)||n.get(e,t,r),has:(e,t)=>!!cf(e,t)||n.has(e,t)}));var Oa=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(j_(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function j_(n){let e=n.getComponent();return e?.type==="VERSION"}var Va="@firebase/app",lf="0.12.3";var It=new st("@firebase/app"),G_="@firebase/app-compat",W_="@firebase/analytics-compat",K_="@firebase/analytics",H_="@firebase/app-check-compat",Q_="@firebase/app-check",Y_="@firebase/auth",J_="@firebase/auth-compat",X_="@firebase/database",Z_="@firebase/data-connect",ey="@firebase/database-compat",ty="@firebase/functions",ny="@firebase/functions-compat",ry="@firebase/installations",iy="@firebase/installations-compat",sy="@firebase/messaging",oy="@firebase/messaging-compat",ay="@firebase/performance",cy="@firebase/performance-compat",uy="@firebase/remote-config",ly="@firebase/remote-config-compat",hy="@firebase/storage",dy="@firebase/storage-compat",fy="@firebase/firestore",py="@firebase/vertexai",my="@firebase/firestore-compat",gy="firebase",_y="11.7.3";var Ma="[DEFAULT]",yy={[Va]:"fire-core",[G_]:"fire-core-compat",[K_]:"fire-analytics",[W_]:"fire-analytics-compat",[Q_]:"fire-app-check",[H_]:"fire-app-check-compat",[Y_]:"fire-auth",[J_]:"fire-auth-compat",[X_]:"fire-rtdb",[Z_]:"fire-data-connect",[ey]:"fire-rtdb-compat",[ty]:"fire-fn",[ny]:"fire-fn-compat",[ry]:"fire-iid",[iy]:"fire-iid-compat",[sy]:"fire-fcm",[oy]:"fire-fcm-compat",[ay]:"fire-perf",[cy]:"fire-perf-compat",[uy]:"fire-rc",[ly]:"fire-rc-compat",[hy]:"fire-gcs",[dy]:"fire-gcs-compat",[fy]:"fire-fst",[my]:"fire-fst-compat",[py]:"fire-vertex","fire-js":"fire-js",[gy]:"fire-js-all"};var Jr=new Map,vy=new Map,La=new Map;function hf(n,e){try{n.container.addComponent(e)}catch(t){It.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function et(n){let e=n.name;if(La.has(e))return It.debug(`There were multiple attempts to register component ${e}.`),!1;La.set(e,n);for(let t of Jr.values())hf(t,n);for(let t of vy.values())hf(t,n);return!0}function gs(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function wt(n){return n==null?!1:n.settings!==void 0}var Iy={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},zt=new Ze("app","Firebase",Iy);var Fa=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ve("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw zt.create("app-deleted",{appName:this._name})}};var $n=_y;function qa(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Ma,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw zt.create("bad-app-name",{appName:String(i)});if(t||(t=ba()),!t)throw zt.create("no-options");let o=Jr.get(i);if(o){if(on(t,o.options)&&on(r,o.config))return o;throw zt.create("duplicate-app",{appName:i})}let a=new ps(i);for(let h of La.values())a.addComponent(h);let u=new Fa(t,r,a);return Jr.set(i,u),u}function zn(n=Ma){let e=Jr.get(n);if(!e&&n===Ma&&ba())return qa();if(!e)throw zt.create("no-app",{appName:n});return e}function _s(){return Array.from(Jr.values())}function he(n,e,t){var r;let i=(r=yy[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){let u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),It.warn(u.join(" "));return}et(new Ve(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var wy="firebase-heartbeat-database",Ty=1,Xr="firebase-heartbeat-store",xa=null;function mf(){return xa||(xa=uf(wy,Ty,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Xr)}catch(t){console.warn(t)}}}}).catch(n=>{throw zt.create("idb-open",{originalErrorMessage:n.message})})),xa}function Ey(n){return A(this,null,function*(){try{let t=(yield mf()).transaction(Xr),r=yield t.objectStore(Xr).get(gf(n));return yield t.done,r}catch(e){if(e instanceof He)It.warn(e.message);else{let t=zt.create("idb-get",{originalErrorMessage:e?.message});It.warn(t.message)}}})}function df(n,e){return A(this,null,function*(){try{let r=(yield mf()).transaction(Xr,"readwrite");yield r.objectStore(Xr).put(e,gf(n)),yield r.done}catch(t){if(t instanceof He)It.warn(t.message);else{let r=zt.create("idb-set",{originalErrorMessage:t?.message});It.warn(r.message)}}})}function gf(n){return`${n.name}!${n.options.appId}`}var by=1024,Ay=30,Ua=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Ba(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return A(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=ff();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats.length>Ay){let a=Sy(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){It.warn(r)}})}getHeartbeatsHeader(){return A(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=ff(),{heartbeatsToSend:r,unsentEntries:i}=ky(this._heartbeatsCache.heartbeats),o=Qr(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return It.warn(t),""}})}};function ff(){return new Date().toISOString().substring(0,10)}function ky(n,e=by){let t=[],r=n.slice();for(let i of n){let o=t.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),pf(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),pf(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Ba=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return A(this,null,function*(){return Yr()?ef().then(()=>!0).catch(()=>!1):!1})}read(){return A(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield Ey(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return A(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return df(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return A(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return df(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function pf(n){return Qr(JSON.stringify({version:2,heartbeats:n})).length}function Sy(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function Cy(n){et(new Ve("platform-logger",e=>new Oa(e),"PRIVATE")),et(new Ve("heartbeat",e=>new Ua(e),"PRIVATE")),he(Va,lf,n),he(Va,lf,"esm2017"),he("fire-js","")}Cy("");var Ry="firebase",Py="11.7.3";he(Ry,Py,"app");function $a(n){n===void 0&&(Wh($a),n=j(xn));let e=n.get(Yi);return t=>new nn(r=>{let i=e.add(),o=!1;function a(){o||(i(),o=!0)}let u=t.subscribe({next:h=>{r.next(h),a()},complete:()=>{r.complete(),a()},error:h=>{r.error(h),a()}});return u.add(()=>{r.unsubscribe(),a()}),u})}var un=new Xh("ANGULARFIRE2_VERSION");function vs(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(a=>a.app===t);if(o.length===1)return o[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Gn=(n,e)=>{let t=e?[e]:_s(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},jn=function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n}(jn||{}),_f=ma()&&typeof Zone<"u"?jn.WARN:jn.SILENT;var ys=class{zone;delegate;constructor(e,t=zh){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(a){i?i.runGuarded(()=>{e.apply(this,[a])}):e.apply(this,[a])};return this.delegate.schedule(o,t,r)}},ln=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=j(Mt);this.outsideAngular=t.runOutsideAngular(()=>new ys(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new ys(typeof Zone>"u"?void 0:Zone.current,$h))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ot({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),yf=!1;function Dy(n,e){!yf&&(_f>jn.SILENT||ma())&&(yf=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),_f>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function Ny(n){let e=j(Mt,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function cn(n){let e=j(Mt,{optional:!0});return e?e.run(()=>n()):n()}var xy=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),Qi(t,()=>cn(()=>n.apply(void 0,r)))),Me=(n,e,t)=>(t||=e?jn.WARN:jn.VERBOSE,function(){let r,i=arguments,o,a,u;try{o=j(ln),a=j(Yi),u=j(Gh)}catch{return Dy(n,t),n.apply(this,i)}for(let d=0;d<arguments.length;d++)typeof i[d]=="function"&&(e&&(r||=cn(()=>a.add())),i[d]=xy(i[d],r,u));let h=Ny(()=>n.apply(this,i));return e?h instanceof nn?h.pipe(fa(o.outsideAngular),da(o.insideAngular),$a(u)):h instanceof Promise?cn(()=>new Promise((d,p)=>{a.run(()=>h).then(y=>Qi(u,()=>cn(()=>d(y))),y=>Qi(u,()=>cn(()=>p(y))))})):typeof h=="function"&&r?function(){return setTimeout(r,0),h.apply(this,arguments)}:cn(()=>h):h instanceof nn?h.pipe(fa(o.outsideAngular),da(o.insideAngular)):cn(()=>h)});var hn=class{constructor(e){return e}},Zr=class{constructor(){return _s()}};function Oy(n){return n&&n.length===1?n[0]:new hn(zn())}var za=new Ki("angularfire2._apps"),Vy={provide:hn,useFactory:Oy,deps:[[new Vt,za]]},My={provide:Zr,deps:[[new Vt,za]]};function Ly(n){return(e,t)=>{let r=t.get(Kh);he("angularfire",un.full,"core"),he("angularfire",un.full,"app"),he("angular",Zh.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new hn(i)}}function vf(n,...e){return Hi([Vy,My,{provide:za,useFactory:Ly(n),multi:!0,deps:[Mt,xn,ln,...e]}])}var If=Me(qa,!0);var Fy=new Map,Uy={activated:!1,tokenObservers:[]},By={initialized:!1,enabled:!1};function tt(n){return Fy.get(n)||Object.assign({},Uy)}function bf(){return By}var qy="https://content-firebaseappcheck.googleapis.com/v1";var $y="exchangeDebugToken",wf={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},nb=24*60*60*1e3;var Wa=class{constructor(e,t,r,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return A(this,null,function*(){this.stop();try{this.pending=new sn,this.pending.promise.catch(t=>{}),yield zy(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new sn,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function zy(n){return new Promise(e=>{setTimeout(e,n)})}var jy={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},jt=new Ze("appCheck","AppCheck",jy);function Af(n){if(!tt(n).activated)throw jt.create("use-before-activation",{appName:n.name})}function kf(r,i){return A(this,arguments,function*({url:n,body:e},t){let o={"Content-Type":"application/json"},a=t.getImmediate({optional:!0});if(a){let S=yield a.getHeartbeatsHeader();S&&(o["X-Firebase-Client"]=S)}let u={method:"POST",body:JSON.stringify(e),headers:o},h;try{h=yield fetch(n,u)}catch(S){throw jt.create("fetch-network-error",{originalErrorMessage:S?.message})}if(h.status!==200)throw jt.create("fetch-status-error",{httpStatus:h.status});let d;try{d=yield h.json()}catch(S){throw jt.create("fetch-parse-error",{originalErrorMessage:S?.message})}let p=d.ttl.match(/^([\d.]+)(s)$/);if(!p||!p[2]||isNaN(Number(p[1])))throw jt.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${d.ttl}`});let y=Number(p[1])*1e3,v=Date.now();return{token:d.token,expireTimeMillis:v+y,issuedAtTimeMillis:v}})}function Sf(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${qy}/projects/${t}/apps/${r}:${$y}?key=${i}`,body:{debug_token:e}}}var Gy="firebase-app-check-database",Wy=1,Ka="firebase-app-check-store";var Is=null;function Ky(){return Is||(Is=new Promise((n,e)=>{try{let t=indexedDB.open(Gy,Wy);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(jt.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Ka,{keyPath:"compositeKey"})}}}catch(t){e(jt.create("storage-open",{originalErrorMessage:t?.message}))}}),Is)}function Hy(n,e){return Qy(Yy(n),e)}function Qy(n,e){return A(this,null,function*(){let r=(yield Ky()).transaction(Ka,"readwrite"),o=r.objectStore(Ka).put({compositeKey:n,value:e});return new Promise((a,u)=>{o.onsuccess=h=>{a()},r.onerror=h=>{var d;u(jt.create("storage-set",{originalErrorMessage:(d=h.target.error)===null||d===void 0?void 0:d.message}))}})})}function Yy(n){return`${n.options.appId}-${n.name}`}var ei=new st("@firebase/app-check");function ja(n,e){return Yr()?Hy(n,e).catch(t=>{ei.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function Cf(){return bf().enabled}function Rf(){return A(this,null,function*(){let n=bf();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var Jy={error:"UNKNOWN_ERROR"};function Xy(n){return ls.encodeString(JSON.stringify(n),!1)}function Ha(n,e=!1,t=!1){return A(this,null,function*(){let r=n.app;Af(r);let i=tt(r),o=i.token,a;if(o&&!ti(o)&&(i.token=void 0,o=void 0),!o){let d=yield i.cachedTokenPromise;d&&(ti(d)?o=d:yield ja(r,void 0))}if(!e&&o&&ti(o))return{token:o.token};let u=!1;if(Cf())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=kf(Sf(r,yield Rf()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),u=!0);let d=yield i.exchangeTokenPromise;return yield ja(r,d),i.token=d,{token:d.token}}catch(d){return d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?ei.warn(d.message):t&&ei.error(d),Ga(d)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),u=!0),o=yield tt(r).exchangeTokenPromise}catch(d){d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?ei.warn(d.message):t&&ei.error(d),a=d}let h;return o?a?ti(o)?h={token:o.token,internalError:a}:h=Ga(a):(h={token:o.token},i.token=o,yield ja(r,o)):h=Ga(a),u&&nv(r,h),h})}function Zy(n){return A(this,null,function*(){let e=n.app;Af(e);let{provider:t}=tt(e);if(Cf()){let r=yield Rf(),{token:i}=yield kf(Sf(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function ev(n,e,t,r){let{app:i}=n,o=tt(i),a={next:t,error:r,type:e};if(o.tokenObservers=[...o.tokenObservers,a],o.token&&ti(o.token)){let u=o.token;Promise.resolve().then(()=>{t({token:u.token}),Tf(n)}).catch(()=>{})}o.cachedTokenPromise.then(()=>Tf(n))}function Pf(n,e){let t=tt(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function Tf(n){let{app:e}=n,t=tt(e),r=t.tokenRefresher;r||(r=tv(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function tv(n){let{app:e}=n;return new Wa(()=>A(this,null,function*(){let t=tt(e),r;if(t.token?r=yield Ha(n,!0):r=yield Ha(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=tt(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},wf.RETRIAL_MIN_WAIT,wf.RETRIAL_MAX_WAIT)}function nv(n,e){let t=tt(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function ti(n){return n.expireTimeMillis-Date.now()>0}function Ga(n){return{token:Xy(Jy),error:n}}var Qa=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=tt(this.app);for(let t of e)Pf(this.app,t.next);return Promise.resolve()}};function rv(n,e){return new Qa(n,e)}function iv(n){return{getToken:e=>Ha(n,e),getLimitedUseToken:()=>Zy(n),addTokenListener:e=>ev(n,"INTERNAL",e),removeTokenListener:e=>Pf(n.app,e)}}var sv="@firebase/app-check",ov="0.9.3";var av="app-check",Ef="app-check-internal";function cv(){et(new Ve(av,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return rv(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(Ef).initialize()})),et(new Ve(Ef,n=>{let e=n.getProvider("app-check").getImmediate();return iv(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),he(sv,ov)}cv();var uv="app-check";var ws=class{constructor(){return Gn(uv)}};var lv=["localhost","0.0.0.0","127.0.0.1"],mb=typeof window<"u"&&lv.includes(window.location.hostname);function Ff(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Uf=Ff,Bf=new Ze("auth","Firebase",Ff());var As=new st("@firebase/auth");function dv(n,...e){As.logLevel<=H.WARN&&As.warn(`Auth (${$n}): ${n}`,...e)}function Es(n,...e){As.logLevel<=H.ERROR&&As.error(`Auth (${$n}): ${n}`,...e)}function Df(n,...e){throw ac(n,...e)}function oc(n,...e){return ac(n,...e)}function qf(n,e,t){let r=Object.assign(Object.assign({},Uf()),{[e]:t});return new Ze("auth","Firebase",r).create(e,{appName:n.name})}function bs(n){return qf(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ac(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Bf.create(n,...e)}function Z(n,e,...t){if(!n)throw ac(e,...t)}function ni(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Es(e),new Error(e)}function ks(n,e){n||ni(e)}function fv(){return Nf()==="http:"||Nf()==="https:"}function Nf(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function pv(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(fv()||Jd()||"connection"in navigator)?navigator.onLine:!0}function mv(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var pn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,ks(t>e,"Short delay should be less than long delay!"),this.isMobile=Qd()||Xd()}get(){return pv()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function gv(n,e){ks(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Ss=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ni("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ni("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ni("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var _v={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var yv=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],vv=new pn(3e4,6e4);function $f(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function Ns(o,a,u,h){return A(this,arguments,function*(n,e,t,r,i={}){return zf(n,i,()=>A(this,null,function*(){let d={},p={};r&&(e==="GET"?p=r:d={body:JSON.stringify(r)});let y=ka(Object.assign({key:n.config.apiKey},p)).slice(1),v=yield n._getAdditionalHeaders();v["Content-Type"]="application/json",n.languageCode&&(v["X-Firebase-Locale"]=n.languageCode);let S=Object.assign({method:e,headers:v},d);return Yd()||(S.referrerPolicy="no-referrer"),n.emulatorConfig&&qn(n.emulatorConfig.host)&&(S.credentials="include"),Ss.fetch()(yield jf(n,n.config.apiHost,t,y),S)}))})}function zf(n,e,t){return A(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},_v),e);try{let i=new Xa(n),o=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield o.json();if("needConfirmation"in a)throw Ts(n,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{let u=o.ok?a.errorMessage:a.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ts(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw Ts(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw Ts(n,"user-disabled",a);let p=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw qf(n,p,d);Df(n,p)}}catch(i){if(i instanceof He)throw i;Df(n,"network-request-failed",{message:String(i)})}})}function jf(n,e,t,r){return A(this,null,function*(){let i=`${e}${t}?${r}`,o=n,a=o.config.emulator?gv(n.config,i):`${n.config.apiScheme}://${i}`;return yv.includes(t)&&(yield o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(a).toString():a})}var Xa=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(oc(this.auth,"network-request-failed")),vv.get())})}};function Ts(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=oc(n,e,r);return i.customData._tokenResponse=t,i}function Iv(n,e){return A(this,null,function*(){return Ns(n,"POST","/v1/accounts:delete",e)})}function Cs(n,e){return A(this,null,function*(){return Ns(n,"POST","/v1/accounts:lookup",e)})}function ri(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function cc(n,e=!1){return A(this,null,function*(){let t=we(n),r=yield t.getIdToken(e),i=Gf(r);Z(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let o=typeof i.firebase=="object"?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:r,authTime:ri(Ya(i.auth_time)),issuedAtTime:ri(Ya(i.iat)),expirationTime:ri(Ya(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}})}function Ya(n){return Number(n)*1e3}function Gf(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Es("JWT malformed, contained fewer than 3 sections"),null;try{let i=hs(t);return i?JSON.parse(i):(Es("Failed to decode base64 JWT payload"),null)}catch(i){return Es("Caught error parsing JWT payload as JSON",i?.toString()),null}}function xf(n){let e=Gf(n);return Z(e,"internal-error"),Z(typeof e.exp<"u","internal-error"),Z(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Za(n,e,t=!1){return A(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof He&&wv(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function wv({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var ec=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>A(this,null,function*(){yield this.iteration()}),t)}iteration(){return A(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var si=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ri(this.lastLoginAt),this.creationTime=ri(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Rs(n){return A(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Za(n,Cs(t,{idToken:r}));Z(i?.users.length,t,"internal-error");let o=i.users[0];n._notifyReloadListener(o);let a=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?Wf(o.providerUserInfo):[],u=Tv(n.providerData,a),h=n.isAnonymous,d=!(n.email&&o.passwordHash)&&!u?.length,p=h?d:!1,y={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new si(o.createdAt,o.lastLoginAt),isAnonymous:p};Object.assign(n,y)})}function uc(n){return A(this,null,function*(){let e=we(n);yield Rs(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function Tv(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Wf(n){return n.map(e=>{var{providerId:t}=e,r=ha(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function Ev(n,e){return A(this,null,function*(){let t=yield zf(n,{},()=>A(this,null,function*(){let r=ka({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,a=yield jf(n,i,"/v1/token",`key=${o}`),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",Ss.fetch()(a,{method:"POST",headers:u,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function bv(n,e){return A(this,null,function*(){return Ns(n,"POST","/v2/accounts:revokeToken",$f(n,e))})}var ii=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Z(e.idToken,"internal-error"),Z(typeof e.idToken<"u","internal-error"),Z(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):xf(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Z(e.length!==0,"internal-error");let t=xf(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return A(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Z(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return A(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:o}=yield Ev(e,t);this.updateTokensAndExpiration(r,i,Number(o))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:o}=t,a=new n;return r&&(Z(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Z(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(Z(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return ni("not implemented")}};function Gt(n,e){Z(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var dn=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,o=ha(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ec(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new si(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(e){return A(this,null,function*(){let t=yield Za(this,this.stsTokenManager.getToken(this.auth,e));return Z(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return cc(this,e)}reload(){return uc(this)}_assign(e){this!==e&&(Z(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Z(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return A(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Rs(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return A(this,null,function*(){if(wt(this.auth.app))return Promise.reject(bs(this.auth));let e=yield this.getIdToken();return yield Za(this,Iv(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,o,a,u,h,d,p;let y=(r=t.displayName)!==null&&r!==void 0?r:void 0,v=(i=t.email)!==null&&i!==void 0?i:void 0,S=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,P=(a=t.photoURL)!==null&&a!==void 0?a:void 0,x=(u=t.tenantId)!==null&&u!==void 0?u:void 0,D=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,$=(d=t.createdAt)!==null&&d!==void 0?d:void 0,F=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:z,emailVerified:ne,isAnonymous:Ne,providerData:te,stsTokenManager:w}=t;Z(z&&w,e,"internal-error");let m=ii.fromJSON(this.name,w);Z(typeof z=="string",e,"internal-error"),Gt(y,e.name),Gt(v,e.name),Z(typeof ne=="boolean",e,"internal-error"),Z(typeof Ne=="boolean",e,"internal-error"),Gt(S,e.name),Gt(P,e.name),Gt(x,e.name),Gt(D,e.name),Gt($,e.name),Gt(F,e.name);let _=new n({uid:z,auth:e,email:v,emailVerified:ne,displayName:y,isAnonymous:Ne,photoURL:P,phoneNumber:S,tenantId:x,stsTokenManager:m,createdAt:$,lastLoginAt:F});return te&&Array.isArray(te)&&(_.providerData=te.map(I=>Object.assign({},I))),D&&(_._redirectEventId=D),_}static _fromIdTokenResponse(e,t,r=!1){return A(this,null,function*(){let i=new ii;i.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Rs(o),o})}static _fromGetAccountInfoResponse(e,t,r){return A(this,null,function*(){let i=t.users[0];Z(i.localId!==void 0,"internal-error");let o=i.providerUserInfo!==void 0?Wf(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!o?.length,u=new ii;u.updateFromIdToken(r);let h=new n({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new si(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(h,d),h})}};var Of=new Map;function fn(n){ks(n instanceof Function,"Expected a class definition");let e=Of.get(n);return e?(ks(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Of.set(n,e),e)}var Av=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return A(this,null,function*(){return!0})}_set(t,r){return A(this,null,function*(){this.storage[t]=r})}_get(t){return A(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return A(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),tc=Av;function Ja(n,e,t){return`firebase:${n}:${e}:${t}`}var Ps=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:o}=this.auth;this.fullUserKey=Ja(this.userKey,i.apiKey,o),this.fullPersistenceKey=Ja("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return A(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=yield Cs(this.auth,{idToken:e}).catch(()=>{});return t?dn._fromGetAccountInfoResponse(this.auth,t,e):null}return dn._fromJSON(this.auth,e)})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return A(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return A(this,null,function*(){if(!t.length)return new n(fn(tc),e,r);let i=(yield Promise.all(t.map(d=>A(this,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),o=i[0]||fn(tc),a=Ja(r,e.config.apiKey,e.name),u=null;for(let d of t)try{let p=yield d._get(a);if(p){let y;if(typeof p=="string"){let v=yield Cs(e,{idToken:p}).catch(()=>{});if(!v)break;y=yield dn._fromGetAccountInfoResponse(e,v,p)}else y=dn._fromJSON(e,p);d!==o&&(u=y),o=d;break}}catch{}let h=i.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new n(o,e,r):(o=h[0],u&&(yield o._set(a,u.toJSON())),yield Promise.all(t.map(d=>A(this,null,function*(){if(d!==o)try{yield d._remove(a)}catch{}}))),new n(o,e,r))})}};function Vf(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Rv(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(kv(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Dv(e))return"Blackberry";if(Nv(e))return"Webos";if(Sv(e))return"Safari";if((e.includes("chrome/")||Cv(e))&&!e.includes("edge/"))return"Chrome";if(Pv(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function kv(n=qe()){return/firefox\//i.test(n)}function Sv(n=qe()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Cv(n=qe()){return/crios\//i.test(n)}function Rv(n=qe()){return/iemobile/i.test(n)}function Pv(n=qe()){return/android/i.test(n)}function Dv(n=qe()){return/blackberry/i.test(n)}function Nv(n=qe()){return/webos/i.test(n)}function Kf(n,e=[]){let t;switch(n){case"Browser":t=Vf(qe());break;case"Worker":t=`${Vf(qe())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${$n}/${r}`}var nc=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((a,u)=>{try{let h=e(o);a(h)}catch(h){u(h)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return A(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function xv(t){return A(this,arguments,function*(n,e={}){return Ns(n,"GET","/v2/passwordPolicy",$f(n,e))})}var Ov=6,rc=class{constructor(e){var t,r,i,o;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:Ov,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,o,a,u;let h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(o=h.containsUppercaseLetter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var ic=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ds(this),this.idTokenSubscription=new Ds(this),this.beforeStateQueue=new nc(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Bf,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=fn(t)),this._initializationPromise=this.queue(()=>A(this,null,function*(){var r,i,o;if(!this._deleted&&(this.persistenceManager=yield Ps.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return A(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return A(this,null,function*(){try{let t=yield Cs(this,{idToken:e}),r=yield dn._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return A(this,null,function*(){var t;if(wt(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,o=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=i?._redirectEventId,h=yield this.tryRedirectSignIn(e);(!a||a===u)&&h?.user&&(i=h.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Z(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return A(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return A(this,null,function*(){try{yield Rs(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=mv()}_delete(){return A(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return A(this,null,function*(){if(wt(this.app))return Promise.reject(bs(this));let t=e?we(e):null;return t&&Z(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return A(this,null,function*(){if(!this._deleted)return e&&Z(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>A(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return A(this,null,function*(){return wt(this.app)?Promise.reject(bs(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return wt(this.app)?Promise.reject(bs(this)):this.queue(()=>A(this,null,function*(){yield this.assertedPersistence.setPersistence(fn(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return A(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return A(this,null,function*(){let e=yield xv(this),t=new rc(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ze("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return A(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield bv(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return A(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return A(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&fn(e)||this._popupRedirectResolver;Z(t,this,"argument-error"),this.redirectPersistenceManager=yield Ps.create(this,[fn(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return A(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>A(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return A(this,null,function*(){if(e===this.currentUser)return this.queue(()=>A(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),a=!1,u=this._isInitialized?Promise.resolve():this._initializationPromise;if(Z(u,this,"internal-error"),u.then(()=>{a||o(this.currentUser)}),typeof t=="function"){let h=e.addObserver(t,r,i);return()=>{a=!0,h()}}else{let h=e.addObserver(t);return()=>{a=!0,h()}}}directlySetCurrentUser(e){return A(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Z(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Kf(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return A(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return A(this,null,function*(){var e;if(wt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&dv(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Vv(n){return we(n)}var Ds=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=tf(t=>this.observer=t)}get next(){return Z(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Mv={loadJS(){return A(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Lv(n){Mv=n}function Fv(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function Uv(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(fn);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}var Sb=Fv("rcb"),Cb=new pn(3e4,6e4);var Rb=new pn(2e3,1e4);var Pb=10*60*1e3;var Db=new pn(3e4,6e4);var Nb=new pn(5e3,15e3);var xb=encodeURIComponent("fac");var Mf="@firebase/auth",Lf="1.10.4";var sc=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return A(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Z(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function Bv(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function qv(n){et(new Ve("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;Z(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let h={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Kf(n)},d=new ic(r,i,o,h);return Uv(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),et(new Ve("auth-internal",e=>{let t=Vv(e.getProvider("auth").getImmediate());return(r=>new sc(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),he(Mf,Lf,Bv(n)),he(Mf,Lf,"esm2017")}var $v=5*60,Ob=Kd("authIdTokenMaxAge")||$v;function zv(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}Lv({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let o=oc("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",zv().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});qv("Browser");var qI="auth";var xs=class{constructor(){return Gn(qI)}};var Hf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Qf={};var Tt,lc;(function(){var n;function e(w,m){function _(){}_.prototype=m.prototype,w.D=m.prototype,w.prototype=new _,w.prototype.constructor=w,w.C=function(I,T,b){for(var g=Array(arguments.length-2),dt=2;dt<arguments.length;dt++)g[dt-2]=arguments[dt];return m.prototype[T].apply(I,g)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,m,_){_||(_=0);var I=Array(16);if(typeof m=="string")for(var T=0;16>T;++T)I[T]=m.charCodeAt(_++)|m.charCodeAt(_++)<<8|m.charCodeAt(_++)<<16|m.charCodeAt(_++)<<24;else for(T=0;16>T;++T)I[T]=m[_++]|m[_++]<<8|m[_++]<<16|m[_++]<<24;m=w.g[0],_=w.g[1],T=w.g[2];var b=w.g[3],g=m+(b^_&(T^b))+I[0]+3614090360&4294967295;m=_+(g<<7&4294967295|g>>>25),g=b+(T^m&(_^T))+I[1]+3905402710&4294967295,b=m+(g<<12&4294967295|g>>>20),g=T+(_^b&(m^_))+I[2]+606105819&4294967295,T=b+(g<<17&4294967295|g>>>15),g=_+(m^T&(b^m))+I[3]+3250441966&4294967295,_=T+(g<<22&4294967295|g>>>10),g=m+(b^_&(T^b))+I[4]+4118548399&4294967295,m=_+(g<<7&4294967295|g>>>25),g=b+(T^m&(_^T))+I[5]+1200080426&4294967295,b=m+(g<<12&4294967295|g>>>20),g=T+(_^b&(m^_))+I[6]+2821735955&4294967295,T=b+(g<<17&4294967295|g>>>15),g=_+(m^T&(b^m))+I[7]+4249261313&4294967295,_=T+(g<<22&4294967295|g>>>10),g=m+(b^_&(T^b))+I[8]+1770035416&4294967295,m=_+(g<<7&4294967295|g>>>25),g=b+(T^m&(_^T))+I[9]+2336552879&4294967295,b=m+(g<<12&4294967295|g>>>20),g=T+(_^b&(m^_))+I[10]+4294925233&4294967295,T=b+(g<<17&4294967295|g>>>15),g=_+(m^T&(b^m))+I[11]+2304563134&4294967295,_=T+(g<<22&4294967295|g>>>10),g=m+(b^_&(T^b))+I[12]+1804603682&4294967295,m=_+(g<<7&4294967295|g>>>25),g=b+(T^m&(_^T))+I[13]+4254626195&4294967295,b=m+(g<<12&4294967295|g>>>20),g=T+(_^b&(m^_))+I[14]+2792965006&4294967295,T=b+(g<<17&4294967295|g>>>15),g=_+(m^T&(b^m))+I[15]+1236535329&4294967295,_=T+(g<<22&4294967295|g>>>10),g=m+(T^b&(_^T))+I[1]+4129170786&4294967295,m=_+(g<<5&4294967295|g>>>27),g=b+(_^T&(m^_))+I[6]+3225465664&4294967295,b=m+(g<<9&4294967295|g>>>23),g=T+(m^_&(b^m))+I[11]+643717713&4294967295,T=b+(g<<14&4294967295|g>>>18),g=_+(b^m&(T^b))+I[0]+3921069994&4294967295,_=T+(g<<20&4294967295|g>>>12),g=m+(T^b&(_^T))+I[5]+3593408605&4294967295,m=_+(g<<5&4294967295|g>>>27),g=b+(_^T&(m^_))+I[10]+38016083&4294967295,b=m+(g<<9&4294967295|g>>>23),g=T+(m^_&(b^m))+I[15]+3634488961&4294967295,T=b+(g<<14&4294967295|g>>>18),g=_+(b^m&(T^b))+I[4]+3889429448&4294967295,_=T+(g<<20&4294967295|g>>>12),g=m+(T^b&(_^T))+I[9]+568446438&4294967295,m=_+(g<<5&4294967295|g>>>27),g=b+(_^T&(m^_))+I[14]+3275163606&4294967295,b=m+(g<<9&4294967295|g>>>23),g=T+(m^_&(b^m))+I[3]+4107603335&4294967295,T=b+(g<<14&4294967295|g>>>18),g=_+(b^m&(T^b))+I[8]+1163531501&4294967295,_=T+(g<<20&4294967295|g>>>12),g=m+(T^b&(_^T))+I[13]+2850285829&4294967295,m=_+(g<<5&4294967295|g>>>27),g=b+(_^T&(m^_))+I[2]+4243563512&4294967295,b=m+(g<<9&4294967295|g>>>23),g=T+(m^_&(b^m))+I[7]+1735328473&4294967295,T=b+(g<<14&4294967295|g>>>18),g=_+(b^m&(T^b))+I[12]+2368359562&4294967295,_=T+(g<<20&4294967295|g>>>12),g=m+(_^T^b)+I[5]+4294588738&4294967295,m=_+(g<<4&4294967295|g>>>28),g=b+(m^_^T)+I[8]+2272392833&4294967295,b=m+(g<<11&4294967295|g>>>21),g=T+(b^m^_)+I[11]+1839030562&4294967295,T=b+(g<<16&4294967295|g>>>16),g=_+(T^b^m)+I[14]+4259657740&4294967295,_=T+(g<<23&4294967295|g>>>9),g=m+(_^T^b)+I[1]+2763975236&4294967295,m=_+(g<<4&4294967295|g>>>28),g=b+(m^_^T)+I[4]+1272893353&4294967295,b=m+(g<<11&4294967295|g>>>21),g=T+(b^m^_)+I[7]+4139469664&4294967295,T=b+(g<<16&4294967295|g>>>16),g=_+(T^b^m)+I[10]+3200236656&4294967295,_=T+(g<<23&4294967295|g>>>9),g=m+(_^T^b)+I[13]+681279174&4294967295,m=_+(g<<4&4294967295|g>>>28),g=b+(m^_^T)+I[0]+3936430074&4294967295,b=m+(g<<11&4294967295|g>>>21),g=T+(b^m^_)+I[3]+3572445317&4294967295,T=b+(g<<16&4294967295|g>>>16),g=_+(T^b^m)+I[6]+76029189&4294967295,_=T+(g<<23&4294967295|g>>>9),g=m+(_^T^b)+I[9]+3654602809&4294967295,m=_+(g<<4&4294967295|g>>>28),g=b+(m^_^T)+I[12]+3873151461&4294967295,b=m+(g<<11&4294967295|g>>>21),g=T+(b^m^_)+I[15]+530742520&4294967295,T=b+(g<<16&4294967295|g>>>16),g=_+(T^b^m)+I[2]+3299628645&4294967295,_=T+(g<<23&4294967295|g>>>9),g=m+(T^(_|~b))+I[0]+4096336452&4294967295,m=_+(g<<6&4294967295|g>>>26),g=b+(_^(m|~T))+I[7]+1126891415&4294967295,b=m+(g<<10&4294967295|g>>>22),g=T+(m^(b|~_))+I[14]+2878612391&4294967295,T=b+(g<<15&4294967295|g>>>17),g=_+(b^(T|~m))+I[5]+4237533241&4294967295,_=T+(g<<21&4294967295|g>>>11),g=m+(T^(_|~b))+I[12]+1700485571&4294967295,m=_+(g<<6&4294967295|g>>>26),g=b+(_^(m|~T))+I[3]+2399980690&4294967295,b=m+(g<<10&4294967295|g>>>22),g=T+(m^(b|~_))+I[10]+4293915773&4294967295,T=b+(g<<15&4294967295|g>>>17),g=_+(b^(T|~m))+I[1]+2240044497&4294967295,_=T+(g<<21&4294967295|g>>>11),g=m+(T^(_|~b))+I[8]+1873313359&4294967295,m=_+(g<<6&4294967295|g>>>26),g=b+(_^(m|~T))+I[15]+4264355552&4294967295,b=m+(g<<10&4294967295|g>>>22),g=T+(m^(b|~_))+I[6]+2734768916&4294967295,T=b+(g<<15&4294967295|g>>>17),g=_+(b^(T|~m))+I[13]+1309151649&4294967295,_=T+(g<<21&4294967295|g>>>11),g=m+(T^(_|~b))+I[4]+4149444226&4294967295,m=_+(g<<6&4294967295|g>>>26),g=b+(_^(m|~T))+I[11]+3174756917&4294967295,b=m+(g<<10&4294967295|g>>>22),g=T+(m^(b|~_))+I[2]+718787259&4294967295,T=b+(g<<15&4294967295|g>>>17),g=_+(b^(T|~m))+I[9]+3951481745&4294967295,w.g[0]=w.g[0]+m&4294967295,w.g[1]=w.g[1]+(T+(g<<21&4294967295|g>>>11))&4294967295,w.g[2]=w.g[2]+T&4294967295,w.g[3]=w.g[3]+b&4294967295}r.prototype.u=function(w,m){m===void 0&&(m=w.length);for(var _=m-this.blockSize,I=this.B,T=this.h,b=0;b<m;){if(T==0)for(;b<=_;)i(this,w,b),b+=this.blockSize;if(typeof w=="string"){for(;b<m;)if(I[T++]=w.charCodeAt(b++),T==this.blockSize){i(this,I),T=0;break}}else for(;b<m;)if(I[T++]=w[b++],T==this.blockSize){i(this,I),T=0;break}}this.h=T,this.o+=m},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var m=1;m<w.length-8;++m)w[m]=0;var _=8*this.o;for(m=w.length-8;m<w.length;++m)w[m]=_&255,_/=256;for(this.u(w),w=Array(16),m=_=0;4>m;++m)for(var I=0;32>I;I+=8)w[_++]=this.g[m]>>>I&255;return w};function o(w,m){var _=u;return Object.prototype.hasOwnProperty.call(_,w)?_[w]:_[w]=m(w)}function a(w,m){this.h=m;for(var _=[],I=!0,T=w.length-1;0<=T;T--){var b=w[T]|0;I&&b==m||(_[T]=b,I=!1)}this.g=_}var u={};function h(w){return-128<=w&&128>w?o(w,function(m){return new a([m|0],0>m?-1:0)}):new a([w|0],0>w?-1:0)}function d(w){if(isNaN(w)||!isFinite(w))return y;if(0>w)return D(d(-w));for(var m=[],_=1,I=0;w>=_;I++)m[I]=w/_|0,_*=4294967296;return new a(m,0)}function p(w,m){if(w.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(w.charAt(0)=="-")return D(p(w.substring(1),m));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=d(Math.pow(m,8)),I=y,T=0;T<w.length;T+=8){var b=Math.min(8,w.length-T),g=parseInt(w.substring(T,T+b),m);8>b?(b=d(Math.pow(m,b)),I=I.j(b).add(d(g))):(I=I.j(_),I=I.add(d(g)))}return I}var y=h(0),v=h(1),S=h(16777216);n=a.prototype,n.m=function(){if(x(this))return-D(this).m();for(var w=0,m=1,_=0;_<this.g.length;_++){var I=this.i(_);w+=(0<=I?I:4294967296+I)*m,m*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(P(this))return"0";if(x(this))return"-"+D(this).toString(w);for(var m=d(Math.pow(w,6)),_=this,I="";;){var T=ne(_,m).g;_=$(_,T.j(m));var b=((0<_.g.length?_.g[0]:_.h)>>>0).toString(w);if(_=T,P(_))return b+I;for(;6>b.length;)b="0"+b;I=b+I}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function P(w){if(w.h!=0)return!1;for(var m=0;m<w.g.length;m++)if(w.g[m]!=0)return!1;return!0}function x(w){return w.h==-1}n.l=function(w){return w=$(this,w),x(w)?-1:P(w)?0:1};function D(w){for(var m=w.g.length,_=[],I=0;I<m;I++)_[I]=~w.g[I];return new a(_,~w.h).add(v)}n.abs=function(){return x(this)?D(this):this},n.add=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],I=0,T=0;T<=m;T++){var b=I+(this.i(T)&65535)+(w.i(T)&65535),g=(b>>>16)+(this.i(T)>>>16)+(w.i(T)>>>16);I=g>>>16,b&=65535,g&=65535,_[T]=g<<16|b}return new a(_,_[_.length-1]&-2147483648?-1:0)};function $(w,m){return w.add(D(m))}n.j=function(w){if(P(this)||P(w))return y;if(x(this))return x(w)?D(this).j(D(w)):D(D(this).j(w));if(x(w))return D(this.j(D(w)));if(0>this.l(S)&&0>w.l(S))return d(this.m()*w.m());for(var m=this.g.length+w.g.length,_=[],I=0;I<2*m;I++)_[I]=0;for(I=0;I<this.g.length;I++)for(var T=0;T<w.g.length;T++){var b=this.i(I)>>>16,g=this.i(I)&65535,dt=w.i(T)>>>16,Tr=w.i(T)&65535;_[2*I+2*T]+=g*Tr,F(_,2*I+2*T),_[2*I+2*T+1]+=b*Tr,F(_,2*I+2*T+1),_[2*I+2*T+1]+=g*dt,F(_,2*I+2*T+1),_[2*I+2*T+2]+=b*dt,F(_,2*I+2*T+2)}for(I=0;I<m;I++)_[I]=_[2*I+1]<<16|_[2*I];for(I=m;I<2*m;I++)_[I]=0;return new a(_,0)};function F(w,m){for(;(w[m]&65535)!=w[m];)w[m+1]+=w[m]>>>16,w[m]&=65535,m++}function z(w,m){this.g=w,this.h=m}function ne(w,m){if(P(m))throw Error("division by zero");if(P(w))return new z(y,y);if(x(w))return m=ne(D(w),m),new z(D(m.g),D(m.h));if(x(m))return m=ne(w,D(m)),new z(D(m.g),m.h);if(30<w.g.length){if(x(w)||x(m))throw Error("slowDivide_ only works with positive integers.");for(var _=v,I=m;0>=I.l(w);)_=Ne(_),I=Ne(I);var T=te(_,1),b=te(I,1);for(I=te(I,2),_=te(_,2);!P(I);){var g=b.add(I);0>=g.l(w)&&(T=T.add(_),b=g),I=te(I,1),_=te(_,1)}return m=$(w,T.j(m)),new z(T,m)}for(T=y;0<=w.l(m);){for(_=Math.max(1,Math.floor(w.m()/m.m())),I=Math.ceil(Math.log(_)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),b=d(_),g=b.j(m);x(g)||0<g.l(w);)_-=I,b=d(_),g=b.j(m);P(b)&&(b=v),T=T.add(b),w=$(w,g)}return new z(T,w)}n.A=function(w){return ne(this,w).h},n.and=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],I=0;I<m;I++)_[I]=this.i(I)&w.i(I);return new a(_,this.h&w.h)},n.or=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],I=0;I<m;I++)_[I]=this.i(I)|w.i(I);return new a(_,this.h|w.h)},n.xor=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],I=0;I<m;I++)_[I]=this.i(I)^w.i(I);return new a(_,this.h^w.h)};function Ne(w){for(var m=w.g.length+1,_=[],I=0;I<m;I++)_[I]=w.i(I)<<1|w.i(I-1)>>>31;return new a(_,w.h)}function te(w,m){var _=m>>5;m%=32;for(var I=w.g.length-_,T=[],b=0;b<I;b++)T[b]=0<m?w.i(b+_)>>>m|w.i(b+_+1)<<32-m:w.i(b+_);return new a(T,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,lc=Qf.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,Tt=Qf.Integer=a}).apply(typeof Hf<"u"?Hf:typeof self<"u"?self:typeof window<"u"?window:{});var Os=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Et={};var hc,$I,Wn,dc,oi,Vs,fc,pc,mc;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(s,c,l){return s==Array.prototype||s==Object.prototype||(s[c]=l.value),s};function t(s){s=[typeof globalThis=="object"&&globalThis,s,typeof window=="object"&&window,typeof self=="object"&&self,typeof Os=="object"&&Os];for(var c=0;c<s.length;++c){var l=s[c];if(l&&l.Math==Math)return l}throw Error("Cannot find global object")}var r=t(this);function i(s,c){if(c)e:{var l=r;s=s.split(".");for(var f=0;f<s.length-1;f++){var E=s[f];if(!(E in l))break e;l=l[E]}s=s[s.length-1],f=l[s],c=c(f),c!=f&&c!=null&&e(l,s,{configurable:!0,writable:!0,value:c})}}function o(s,c){s instanceof String&&(s+="");var l=0,f=!1,E={next:function(){if(!f&&l<s.length){var k=l++;return{value:c(k,s[k]),done:!1}}return f=!0,{done:!0,value:void 0}}};return E[Symbol.iterator]=function(){return E},E}i("Array.prototype.values",function(s){return s||function(){return o(this,function(c,l){return l})}});var a=a||{},u=this||self;function h(s){var c=typeof s;return c=c!="object"?c:s?Array.isArray(s)?"array":c:"null",c=="array"||c=="object"&&typeof s.length=="number"}function d(s){var c=typeof s;return c=="object"&&s!=null||c=="function"}function p(s,c,l){return s.call.apply(s.bind,arguments)}function y(s,c,l){if(!s)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var E=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(E,f),s.apply(c,E)}}return function(){return s.apply(c,arguments)}}function v(s,c,l){return v=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:y,v.apply(null,arguments)}function S(s,c){var l=Array.prototype.slice.call(arguments,1);return function(){var f=l.slice();return f.push.apply(f,arguments),s.apply(this,f)}}function P(s,c){function l(){}l.prototype=c.prototype,s.aa=c.prototype,s.prototype=new l,s.prototype.constructor=s,s.Qb=function(f,E,k){for(var N=Array(arguments.length-2),re=2;re<arguments.length;re++)N[re-2]=arguments[re];return c.prototype[E].apply(f,N)}}function x(s){let c=s.length;if(0<c){let l=Array(c);for(let f=0;f<c;f++)l[f]=s[f];return l}return[]}function D(s,c){for(let l=1;l<arguments.length;l++){let f=arguments[l];if(h(f)){let E=s.length||0,k=f.length||0;s.length=E+k;for(let N=0;N<k;N++)s[E+N]=f[N]}else s.push(f)}}class ${constructor(c,l){this.i=c,this.j=l,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function F(s){return/^[\s\xa0]*$/.test(s)}function z(){var s=u.navigator;return s&&(s=s.userAgent)?s:""}function ne(s){return ne[" "](s),s}ne[" "]=function(){};var Ne=z().indexOf("Gecko")!=-1&&!(z().toLowerCase().indexOf("webkit")!=-1&&z().indexOf("Edge")==-1)&&!(z().indexOf("Trident")!=-1||z().indexOf("MSIE")!=-1)&&z().indexOf("Edge")==-1;function te(s,c,l){for(let f in s)c.call(l,s[f],f,s)}function w(s,c){for(let l in s)c.call(void 0,s[l],l,s)}function m(s){let c={};for(let l in s)c[l]=s[l];return c}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(s,c){let l,f;for(let E=1;E<arguments.length;E++){f=arguments[E];for(l in f)s[l]=f[l];for(let k=0;k<_.length;k++)l=_[k],Object.prototype.hasOwnProperty.call(f,l)&&(s[l]=f[l])}}function T(s){var c=1;s=s.split(":");let l=[];for(;0<c&&s.length;)l.push(s.shift()),c--;return s.length&&l.push(s.join(":")),l}function b(s){u.setTimeout(()=>{throw s},0)}function g(){var s=Bo;let c=null;return s.g&&(c=s.g,s.g=s.g.next,s.g||(s.h=null),c.next=null),c}class dt{constructor(){this.h=this.g=null}add(c,l){let f=Tr.get();f.set(c,l),this.h?this.h.next=f:this.g=f,this.h=f}}var Tr=new $(()=>new Ng,s=>s.reset());class Ng{constructor(){this.next=this.g=this.h=null}set(c,l){this.h=c,this.g=l,this.next=null}reset(){this.next=this.g=this.h=null}}let Er,br=!1,Bo=new dt,ql=()=>{let s=u.Promise.resolve(void 0);Er=()=>{s.then(xg)}};var xg=()=>{for(var s;s=g();){try{s.h.call(s.g)}catch(l){b(l)}var c=Tr;c.j(s),100>c.h&&(c.h++,s.next=c.g,c.g=s)}br=!1};function Pt(){this.s=this.s,this.C=this.C}Pt.prototype.s=!1,Pt.prototype.ma=function(){this.s||(this.s=!0,this.N())},Pt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ee(s,c){this.type=s,this.g=this.target=c,this.defaultPrevented=!1}Ee.prototype.h=function(){this.defaultPrevented=!0};var Og=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var s=!1,c=Object.defineProperty({},"passive",{get:function(){s=!0}});try{let l=()=>{};u.addEventListener("test",l,c),u.removeEventListener("test",l,c)}catch{}return s}();function Ar(s,c){if(Ee.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s){var l=this.type=s.type,f=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;if(this.target=s.target||s.srcElement,this.g=c,c=s.relatedTarget){if(Ne){e:{try{ne(c.nodeName);var E=!0;break e}catch{}E=!1}E||(c=null)}}else l=="mouseover"?c=s.fromElement:l=="mouseout"&&(c=s.toElement);this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType=typeof s.pointerType=="string"?s.pointerType:Vg[s.pointerType]||"",this.state=s.state,this.i=s,s.defaultPrevented&&Ar.aa.h.call(this)}}P(Ar,Ee);var Vg={2:"touch",3:"pen",4:"mouse"};Ar.prototype.h=function(){Ar.aa.h.call(this);var s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var kr="closure_listenable_"+(1e6*Math.random()|0),Mg=0;function Lg(s,c,l,f,E){this.listener=s,this.proxy=null,this.src=c,this.type=l,this.capture=!!f,this.ha=E,this.key=++Mg,this.da=this.fa=!1}function Ri(s){s.da=!0,s.listener=null,s.proxy=null,s.src=null,s.ha=null}function Pi(s){this.src=s,this.g={},this.h=0}Pi.prototype.add=function(s,c,l,f,E){var k=s.toString();s=this.g[k],s||(s=this.g[k]=[],this.h++);var N=$o(s,c,f,E);return-1<N?(c=s[N],l||(c.fa=!1)):(c=new Lg(c,this.src,k,!!f,E),c.fa=l,s.push(c)),c};function qo(s,c){var l=c.type;if(l in s.g){var f=s.g[l],E=Array.prototype.indexOf.call(f,c,void 0),k;(k=0<=E)&&Array.prototype.splice.call(f,E,1),k&&(Ri(c),s.g[l].length==0&&(delete s.g[l],s.h--))}}function $o(s,c,l,f){for(var E=0;E<s.length;++E){var k=s[E];if(!k.da&&k.listener==c&&k.capture==!!l&&k.ha==f)return E}return-1}var zo="closure_lm_"+(1e6*Math.random()|0),jo={};function $l(s,c,l,f,E){if(f&&f.once)return jl(s,c,l,f,E);if(Array.isArray(c)){for(var k=0;k<c.length;k++)$l(s,c[k],l,f,E);return null}return l=Ho(l),s&&s[kr]?s.K(c,l,d(f)?!!f.capture:!!f,E):zl(s,c,l,!1,f,E)}function zl(s,c,l,f,E,k){if(!c)throw Error("Invalid event type");var N=d(E)?!!E.capture:!!E,re=Wo(s);if(re||(s[zo]=re=new Pi(s)),l=re.add(c,l,f,N,k),l.proxy)return l;if(f=Fg(),l.proxy=f,f.src=s,f.listener=l,s.addEventListener)Og||(E=N),E===void 0&&(E=!1),s.addEventListener(c.toString(),f,E);else if(s.attachEvent)s.attachEvent(Wl(c.toString()),f);else if(s.addListener&&s.removeListener)s.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return l}function Fg(){function s(l){return c.call(s.src,s.listener,l)}let c=Ug;return s}function jl(s,c,l,f,E){if(Array.isArray(c)){for(var k=0;k<c.length;k++)jl(s,c[k],l,f,E);return null}return l=Ho(l),s&&s[kr]?s.L(c,l,d(f)?!!f.capture:!!f,E):zl(s,c,l,!0,f,E)}function Gl(s,c,l,f,E){if(Array.isArray(c))for(var k=0;k<c.length;k++)Gl(s,c[k],l,f,E);else f=d(f)?!!f.capture:!!f,l=Ho(l),s&&s[kr]?(s=s.i,c=String(c).toString(),c in s.g&&(k=s.g[c],l=$o(k,l,f,E),-1<l&&(Ri(k[l]),Array.prototype.splice.call(k,l,1),k.length==0&&(delete s.g[c],s.h--)))):s&&(s=Wo(s))&&(c=s.g[c.toString()],s=-1,c&&(s=$o(c,l,f,E)),(l=-1<s?c[s]:null)&&Go(l))}function Go(s){if(typeof s!="number"&&s&&!s.da){var c=s.src;if(c&&c[kr])qo(c.i,s);else{var l=s.type,f=s.proxy;c.removeEventListener?c.removeEventListener(l,f,s.capture):c.detachEvent?c.detachEvent(Wl(l),f):c.addListener&&c.removeListener&&c.removeListener(f),(l=Wo(c))?(qo(l,s),l.h==0&&(l.src=null,c[zo]=null)):Ri(s)}}}function Wl(s){return s in jo?jo[s]:jo[s]="on"+s}function Ug(s,c){if(s.da)s=!0;else{c=new Ar(c,this);var l=s.listener,f=s.ha||s.src;s.fa&&Go(s),s=l.call(f,c)}return s}function Wo(s){return s=s[zo],s instanceof Pi?s:null}var Ko="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ho(s){return typeof s=="function"?s:(s[Ko]||(s[Ko]=function(c){return s.handleEvent(c)}),s[Ko])}function be(){Pt.call(this),this.i=new Pi(this),this.M=this,this.F=null}P(be,Pt),be.prototype[kr]=!0,be.prototype.removeEventListener=function(s,c,l,f){Gl(this,s,c,l,f)};function xe(s,c){var l,f=s.F;if(f)for(l=[];f;f=f.F)l.push(f);if(s=s.M,f=c.type||c,typeof c=="string")c=new Ee(c,s);else if(c instanceof Ee)c.target=c.target||s;else{var E=c;c=new Ee(f,s),I(c,E)}if(E=!0,l)for(var k=l.length-1;0<=k;k--){var N=c.g=l[k];E=Di(N,f,!0,c)&&E}if(N=c.g=s,E=Di(N,f,!0,c)&&E,E=Di(N,f,!1,c)&&E,l)for(k=0;k<l.length;k++)N=c.g=l[k],E=Di(N,f,!1,c)&&E}be.prototype.N=function(){if(be.aa.N.call(this),this.i){var s=this.i,c;for(c in s.g){for(var l=s.g[c],f=0;f<l.length;f++)Ri(l[f]);delete s.g[c],s.h--}}this.F=null},be.prototype.K=function(s,c,l,f){return this.i.add(String(s),c,!1,l,f)},be.prototype.L=function(s,c,l,f){return this.i.add(String(s),c,!0,l,f)};function Di(s,c,l,f){if(c=s.i.g[String(c)],!c)return!0;c=c.concat();for(var E=!0,k=0;k<c.length;++k){var N=c[k];if(N&&!N.da&&N.capture==l){var re=N.listener,Ie=N.ha||N.src;N.fa&&qo(s.i,N),E=re.call(Ie,f)!==!1&&E}}return E&&!f.defaultPrevented}function Kl(s,c,l){if(typeof s=="function")l&&(s=v(s,l));else if(s&&typeof s.handleEvent=="function")s=v(s.handleEvent,s);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:u.setTimeout(s,c||0)}function Hl(s){s.g=Kl(()=>{s.g=null,s.i&&(s.i=!1,Hl(s))},s.l);let c=s.h;s.h=null,s.m.apply(null,c)}class Bg extends Pt{constructor(c,l){super(),this.m=c,this.l=l,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:Hl(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Sr(s){Pt.call(this),this.h=s,this.g={}}P(Sr,Pt);var Ql=[];function Yl(s){te(s.g,function(c,l){this.g.hasOwnProperty(l)&&Go(c)},s),s.g={}}Sr.prototype.N=function(){Sr.aa.N.call(this),Yl(this)},Sr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Qo=u.JSON.stringify,qg=u.JSON.parse,$g=class{stringify(s){return u.JSON.stringify(s,void 0)}parse(s){return u.JSON.parse(s,void 0)}};function Yo(){}Yo.prototype.h=null;function Jl(s){return s.h||(s.h=s.i())}function Xl(){}var Cr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Jo(){Ee.call(this,"d")}P(Jo,Ee);function Xo(){Ee.call(this,"c")}P(Xo,Ee);var Xt={},Zl=null;function Ni(){return Zl=Zl||new be}Xt.La="serverreachability";function eh(s){Ee.call(this,Xt.La,s)}P(eh,Ee);function Rr(s){let c=Ni();xe(c,new eh(c))}Xt.STAT_EVENT="statevent";function th(s,c){Ee.call(this,Xt.STAT_EVENT,s),this.stat=c}P(th,Ee);function Oe(s){let c=Ni();xe(c,new th(c,s))}Xt.Ma="timingevent";function nh(s,c){Ee.call(this,Xt.Ma,s),this.size=c}P(nh,Ee);function Pr(s,c){if(typeof s!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){s()},c)}function Dr(){this.g=!0}Dr.prototype.xa=function(){this.g=!1};function zg(s,c,l,f,E,k){s.info(function(){if(s.g)if(k)for(var N="",re=k.split("&"),Ie=0;Ie<re.length;Ie++){var X=re[Ie].split("=");if(1<X.length){var Ae=X[0];X=X[1];var ke=Ae.split("_");N=2<=ke.length&&ke[1]=="type"?N+(Ae+"="+X+"&"):N+(Ae+"=redacted&")}}else N=null;else N=k;return"XMLHTTP REQ ("+f+") [attempt "+E+"]: "+c+`
`+l+`
`+N})}function jg(s,c,l,f,E,k,N){s.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+E+"]: "+c+`
`+l+`
`+k+" "+N})}function Rn(s,c,l,f){s.info(function(){return"XMLHTTP TEXT ("+c+"): "+Wg(s,l)+(f?" "+f:"")})}function Gg(s,c){s.info(function(){return"TIMEOUT: "+c})}Dr.prototype.info=function(){};function Wg(s,c){if(!s.g)return c;if(!c)return null;try{var l=JSON.parse(c);if(l){for(s=0;s<l.length;s++)if(Array.isArray(l[s])){var f=l[s];if(!(2>f.length)){var E=f[1];if(Array.isArray(E)&&!(1>E.length)){var k=E[0];if(k!="noop"&&k!="stop"&&k!="close")for(var N=1;N<E.length;N++)E[N]=""}}}}return Qo(l)}catch{return c}}var xi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},rh={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Zo;function Oi(){}P(Oi,Yo),Oi.prototype.g=function(){return new XMLHttpRequest},Oi.prototype.i=function(){return{}},Zo=new Oi;function Dt(s,c,l,f){this.j=s,this.i=c,this.l=l,this.R=f||1,this.U=new Sr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ih}function ih(){this.i=null,this.g="",this.h=!1}var sh={},ea={};function ta(s,c,l){s.L=1,s.v=Fi(ft(c)),s.m=l,s.P=!0,oh(s,null)}function oh(s,c){s.F=Date.now(),Vi(s),s.A=ft(s.v);var l=s.A,f=s.R;Array.isArray(f)||(f=[String(f)]),Ih(l.i,"t",f),s.C=0,l=s.j.J,s.h=new ih,s.g=Fh(s.j,l?c:null,!s.m),0<s.O&&(s.M=new Bg(v(s.Y,s,s.g),s.O)),c=s.U,l=s.g,f=s.ca;var E="readystatechange";Array.isArray(E)||(E&&(Ql[0]=E.toString()),E=Ql);for(var k=0;k<E.length;k++){var N=$l(l,E[k],f||c.handleEvent,!1,c.h||c);if(!N)break;c.g[N.key]=N}c=s.H?m(s.H):{},s.m?(s.u||(s.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.A,s.u,s.m,c)):(s.u="GET",s.g.ea(s.A,s.u,null,c)),Rr(),zg(s.i,s.u,s.A,s.l,s.R,s.m)}Dt.prototype.ca=function(s){s=s.target;let c=this.M;c&&pt(s)==3?c.j():this.Y(s)},Dt.prototype.Y=function(s){try{if(s==this.g)e:{let ke=pt(this.g);var c=this.g.Ba();let Nn=this.g.Z();if(!(3>ke)&&(ke!=3||this.g&&(this.h.h||this.g.oa()||Sh(this.g)))){this.J||ke!=4||c==7||(c==8||0>=Nn?Rr(3):Rr(2)),na(this);var l=this.g.Z();this.X=l;t:if(ah(this)){var f=Sh(this.g);s="";var E=f.length,k=pt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Zt(this),Nr(this);var N="";break t}this.h.i=new u.TextDecoder}for(c=0;c<E;c++)this.h.h=!0,s+=this.h.i.decode(f[c],{stream:!(k&&c==E-1)});f.length=0,this.h.g+=s,this.C=0,N=this.h.g}else N=this.g.oa();if(this.o=l==200,jg(this.i,this.u,this.A,this.l,this.R,ke,l),this.o){if(this.T&&!this.K){t:{if(this.g){var re,Ie=this.g;if((re=Ie.g?Ie.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!F(re)){var X=re;break t}}X=null}if(l=X)Rn(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ra(this,l);else{this.o=!1,this.s=3,Oe(12),Zt(this),Nr(this);break e}}if(this.P){l=!0;let Xe;for(;!this.J&&this.C<N.length;)if(Xe=Kg(this,N),Xe==ea){ke==4&&(this.s=4,Oe(14),l=!1),Rn(this.i,this.l,null,"[Incomplete Response]");break}else if(Xe==sh){this.s=4,Oe(15),Rn(this.i,this.l,N,"[Invalid Chunk]"),l=!1;break}else Rn(this.i,this.l,Xe,null),ra(this,Xe);if(ah(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ke!=4||N.length!=0||this.h.h||(this.s=1,Oe(16),l=!1),this.o=this.o&&l,!l)Rn(this.i,this.l,N,"[Invalid Chunked Response]"),Zt(this),Nr(this);else if(0<N.length&&!this.W){this.W=!0;var Ae=this.j;Ae.g==this&&Ae.ba&&!Ae.M&&(Ae.j.info("Great, no buffering proxy detected. Bytes received: "+N.length),ua(Ae),Ae.M=!0,Oe(11))}}else Rn(this.i,this.l,N,null),ra(this,N);ke==4&&Zt(this),this.o&&!this.J&&(ke==4?Oh(this.j,this):(this.o=!1,Vi(this)))}else l_(this.g),l==400&&0<N.indexOf("Unknown SID")?(this.s=3,Oe(12)):(this.s=0,Oe(13)),Zt(this),Nr(this)}}}catch{}finally{}};function ah(s){return s.g?s.u=="GET"&&s.L!=2&&s.j.Ca:!1}function Kg(s,c){var l=s.C,f=c.indexOf(`
`,l);return f==-1?ea:(l=Number(c.substring(l,f)),isNaN(l)?sh:(f+=1,f+l>c.length?ea:(c=c.slice(f,f+l),s.C=f+l,c)))}Dt.prototype.cancel=function(){this.J=!0,Zt(this)};function Vi(s){s.S=Date.now()+s.I,ch(s,s.I)}function ch(s,c){if(s.B!=null)throw Error("WatchDog timer not null");s.B=Pr(v(s.ba,s),c)}function na(s){s.B&&(u.clearTimeout(s.B),s.B=null)}Dt.prototype.ba=function(){this.B=null;let s=Date.now();0<=s-this.S?(Gg(this.i,this.A),this.L!=2&&(Rr(),Oe(17)),Zt(this),this.s=2,Nr(this)):ch(this,this.S-s)};function Nr(s){s.j.G==0||s.J||Oh(s.j,s)}function Zt(s){na(s);var c=s.M;c&&typeof c.ma=="function"&&c.ma(),s.M=null,Yl(s.U),s.g&&(c=s.g,s.g=null,c.abort(),c.ma())}function ra(s,c){try{var l=s.j;if(l.G!=0&&(l.g==s||ia(l.h,s))){if(!s.K&&ia(l.h,s)&&l.G==3){try{var f=l.Da.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var E=f;if(E[0]==0){e:if(!l.u){if(l.g)if(l.g.F+3e3<s.F)zi(l),qi(l);else break e;ca(l),Oe(18)}}else l.za=E[1],0<l.za-l.T&&37500>E[2]&&l.F&&l.v==0&&!l.C&&(l.C=Pr(v(l.Za,l),6e3));if(1>=hh(l.h)&&l.ca){try{l.ca()}catch{}l.ca=void 0}}else tn(l,11)}else if((s.K||l.g==s)&&zi(l),!F(c))for(E=l.Da.g.parse(c),c=0;c<E.length;c++){let X=E[c];if(l.T=X[0],X=X[1],l.G==2)if(X[0]=="c"){l.K=X[1],l.ia=X[2];let Ae=X[3];Ae!=null&&(l.la=Ae,l.j.info("VER="+l.la));let ke=X[4];ke!=null&&(l.Aa=ke,l.j.info("SVER="+l.Aa));let Nn=X[5];Nn!=null&&typeof Nn=="number"&&0<Nn&&(f=1.5*Nn,l.L=f,l.j.info("backChannelRequestTimeoutMs_="+f)),f=l;let Xe=s.g;if(Xe){let Gi=Xe.g?Xe.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Gi){var k=f.h;k.g||Gi.indexOf("spdy")==-1&&Gi.indexOf("quic")==-1&&Gi.indexOf("h2")==-1||(k.j=k.l,k.g=new Set,k.h&&(sa(k,k.h),k.h=null))}if(f.D){let la=Xe.g?Xe.g.getResponseHeader("X-HTTP-Session-Id"):null;la&&(f.ya=la,ie(f.I,f.D,la))}}l.G=3,l.l&&l.l.ua(),l.ba&&(l.R=Date.now()-s.F,l.j.info("Handshake RTT: "+l.R+"ms")),f=l;var N=s;if(f.qa=Lh(f,f.J?f.ia:null,f.W),N.K){dh(f.h,N);var re=N,Ie=f.L;Ie&&(re.I=Ie),re.B&&(na(re),Vi(re)),f.g=N}else Nh(f);0<l.i.length&&$i(l)}else X[0]!="stop"&&X[0]!="close"||tn(l,7);else l.G==3&&(X[0]=="stop"||X[0]=="close"?X[0]=="stop"?tn(l,7):aa(l):X[0]!="noop"&&l.l&&l.l.ta(X),l.v=0)}}Rr(4)}catch{}}var Hg=class{constructor(s,c){this.g=s,this.map=c}};function uh(s){this.l=s||10,u.PerformanceNavigationTiming?(s=u.performance.getEntriesByType("navigation"),s=0<s.length&&(s[0].nextHopProtocol=="hq"||s[0].nextHopProtocol=="h2")):s=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=s?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function lh(s){return s.h?!0:s.g?s.g.size>=s.j:!1}function hh(s){return s.h?1:s.g?s.g.size:0}function ia(s,c){return s.h?s.h==c:s.g?s.g.has(c):!1}function sa(s,c){s.g?s.g.add(c):s.h=c}function dh(s,c){s.h&&s.h==c?s.h=null:s.g&&s.g.has(c)&&s.g.delete(c)}uh.prototype.cancel=function(){if(this.i=fh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let s of this.g.values())s.cancel();this.g.clear()}};function fh(s){if(s.h!=null)return s.i.concat(s.h.D);if(s.g!=null&&s.g.size!==0){let c=s.i;for(let l of s.g.values())c=c.concat(l.D);return c}return x(s.i)}function Qg(s){if(s.V&&typeof s.V=="function")return s.V();if(typeof Map<"u"&&s instanceof Map||typeof Set<"u"&&s instanceof Set)return Array.from(s.values());if(typeof s=="string")return s.split("");if(h(s)){for(var c=[],l=s.length,f=0;f<l;f++)c.push(s[f]);return c}c=[],l=0;for(f in s)c[l++]=s[f];return c}function Yg(s){if(s.na&&typeof s.na=="function")return s.na();if(!s.V||typeof s.V!="function"){if(typeof Map<"u"&&s instanceof Map)return Array.from(s.keys());if(!(typeof Set<"u"&&s instanceof Set)){if(h(s)||typeof s=="string"){var c=[];s=s.length;for(var l=0;l<s;l++)c.push(l);return c}c=[],l=0;for(let f in s)c[l++]=f;return c}}}function ph(s,c){if(s.forEach&&typeof s.forEach=="function")s.forEach(c,void 0);else if(h(s)||typeof s=="string")Array.prototype.forEach.call(s,c,void 0);else for(var l=Yg(s),f=Qg(s),E=f.length,k=0;k<E;k++)c.call(void 0,f[k],l&&l[k],s)}var mh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Jg(s,c){if(s){s=s.split("&");for(var l=0;l<s.length;l++){var f=s[l].indexOf("="),E=null;if(0<=f){var k=s[l].substring(0,f);E=s[l].substring(f+1)}else k=s[l];c(k,E?decodeURIComponent(E.replace(/\+/g," ")):"")}}}function en(s){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,s instanceof en){this.h=s.h,Mi(this,s.j),this.o=s.o,this.g=s.g,Li(this,s.s),this.l=s.l;var c=s.i,l=new Vr;l.i=c.i,c.g&&(l.g=new Map(c.g),l.h=c.h),gh(this,l),this.m=s.m}else s&&(c=String(s).match(mh))?(this.h=!1,Mi(this,c[1]||"",!0),this.o=xr(c[2]||""),this.g=xr(c[3]||"",!0),Li(this,c[4]),this.l=xr(c[5]||"",!0),gh(this,c[6]||"",!0),this.m=xr(c[7]||"")):(this.h=!1,this.i=new Vr(null,this.h))}en.prototype.toString=function(){var s=[],c=this.j;c&&s.push(Or(c,_h,!0),":");var l=this.g;return(l||c=="file")&&(s.push("//"),(c=this.o)&&s.push(Or(c,_h,!0),"@"),s.push(encodeURIComponent(String(l)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l=this.s,l!=null&&s.push(":",String(l))),(l=this.l)&&(this.g&&l.charAt(0)!="/"&&s.push("/"),s.push(Or(l,l.charAt(0)=="/"?e_:Zg,!0))),(l=this.i.toString())&&s.push("?",l),(l=this.m)&&s.push("#",Or(l,n_)),s.join("")};function ft(s){return new en(s)}function Mi(s,c,l){s.j=l?xr(c,!0):c,s.j&&(s.j=s.j.replace(/:$/,""))}function Li(s,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);s.s=c}else s.s=null}function gh(s,c,l){c instanceof Vr?(s.i=c,r_(s.i,s.h)):(l||(c=Or(c,t_)),s.i=new Vr(c,s.h))}function ie(s,c,l){s.i.set(c,l)}function Fi(s){return ie(s,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),s}function xr(s,c){return s?c?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function Or(s,c,l){return typeof s=="string"?(s=encodeURI(s).replace(c,Xg),l&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function Xg(s){return s=s.charCodeAt(0),"%"+(s>>4&15).toString(16)+(s&15).toString(16)}var _h=/[#\/\?@]/g,Zg=/[#\?:]/g,e_=/[#\?]/g,t_=/[#\?@]/g,n_=/#/g;function Vr(s,c){this.h=this.g=null,this.i=s||null,this.j=!!c}function Nt(s){s.g||(s.g=new Map,s.h=0,s.i&&Jg(s.i,function(c,l){s.add(decodeURIComponent(c.replace(/\+/g," ")),l)}))}n=Vr.prototype,n.add=function(s,c){Nt(this),this.i=null,s=Pn(this,s);var l=this.g.get(s);return l||this.g.set(s,l=[]),l.push(c),this.h+=1,this};function yh(s,c){Nt(s),c=Pn(s,c),s.g.has(c)&&(s.i=null,s.h-=s.g.get(c).length,s.g.delete(c))}function vh(s,c){return Nt(s),c=Pn(s,c),s.g.has(c)}n.forEach=function(s,c){Nt(this),this.g.forEach(function(l,f){l.forEach(function(E){s.call(c,E,f,this)},this)},this)},n.na=function(){Nt(this);let s=Array.from(this.g.values()),c=Array.from(this.g.keys()),l=[];for(let f=0;f<c.length;f++){let E=s[f];for(let k=0;k<E.length;k++)l.push(c[f])}return l},n.V=function(s){Nt(this);let c=[];if(typeof s=="string")vh(this,s)&&(c=c.concat(this.g.get(Pn(this,s))));else{s=Array.from(this.g.values());for(let l=0;l<s.length;l++)c=c.concat(s[l])}return c},n.set=function(s,c){return Nt(this),this.i=null,s=Pn(this,s),vh(this,s)&&(this.h-=this.g.get(s).length),this.g.set(s,[c]),this.h+=1,this},n.get=function(s,c){return s?(s=this.V(s),0<s.length?String(s[0]):c):c};function Ih(s,c,l){yh(s,c),0<l.length&&(s.i=null,s.g.set(Pn(s,c),x(l)),s.h+=l.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let s=[],c=Array.from(this.g.keys());for(var l=0;l<c.length;l++){var f=c[l];let k=encodeURIComponent(String(f)),N=this.V(f);for(f=0;f<N.length;f++){var E=k;N[f]!==""&&(E+="="+encodeURIComponent(String(N[f]))),s.push(E)}}return this.i=s.join("&")};function Pn(s,c){return c=String(c),s.j&&(c=c.toLowerCase()),c}function r_(s,c){c&&!s.j&&(Nt(s),s.i=null,s.g.forEach(function(l,f){var E=f.toLowerCase();f!=E&&(yh(this,f),Ih(this,E,l))},s)),s.j=c}function i_(s,c){let l=new Dr;if(u.Image){let f=new Image;f.onload=S(xt,l,"TestLoadImage: loaded",!0,c,f),f.onerror=S(xt,l,"TestLoadImage: error",!1,c,f),f.onabort=S(xt,l,"TestLoadImage: abort",!1,c,f),f.ontimeout=S(xt,l,"TestLoadImage: timeout",!1,c,f),u.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=s}else c(!1)}function s_(s,c){let l=new Dr,f=new AbortController,E=setTimeout(()=>{f.abort(),xt(l,"TestPingServer: timeout",!1,c)},1e4);fetch(s,{signal:f.signal}).then(k=>{clearTimeout(E),k.ok?xt(l,"TestPingServer: ok",!0,c):xt(l,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(E),xt(l,"TestPingServer: error",!1,c)})}function xt(s,c,l,f,E){try{E&&(E.onload=null,E.onerror=null,E.onabort=null,E.ontimeout=null),f(l)}catch{}}function o_(){this.g=new $g}function a_(s,c,l){let f=l||"";try{ph(s,function(E,k){let N=E;d(E)&&(N=Qo(E)),c.push(f+k+"="+encodeURIComponent(N))})}catch(E){throw c.push(f+"type="+encodeURIComponent("_badmap")),E}}function Mr(s){this.l=s.Ub||null,this.j=s.eb||!1}P(Mr,Yo),Mr.prototype.g=function(){return new Ui(this.l,this.j)},Mr.prototype.i=function(s){return function(){return s}}({});function Ui(s,c){be.call(this),this.D=s,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}P(Ui,be),n=Ui.prototype,n.open=function(s,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=s,this.A=c,this.readyState=1,Fr(this)},n.send=function(s){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};s&&(c.body=s),(this.D||u).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Lr(this)),this.readyState=0},n.Sa=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,Fr(this)),this.g&&(this.readyState=3,Fr(this),this.g)))if(this.responseType==="arraybuffer")s.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in s){if(this.j=s.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;wh(this)}else s.text().then(this.Ra.bind(this),this.ga.bind(this))};function wh(s){s.j.read().then(s.Pa.bind(s)).catch(s.ga.bind(s))}n.Pa=function(s){if(this.g){if(this.o&&s.value)this.response.push(s.value);else if(!this.o){var c=s.value?s.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!s.done}))&&(this.response=this.responseText+=c)}s.done?Lr(this):Fr(this),this.readyState==3&&wh(this)}},n.Ra=function(s){this.g&&(this.response=this.responseText=s,Lr(this))},n.Qa=function(s){this.g&&(this.response=s,Lr(this))},n.ga=function(){this.g&&Lr(this)};function Lr(s){s.readyState=4,s.l=null,s.j=null,s.v=null,Fr(s)}n.setRequestHeader=function(s,c){this.u.append(s,c)},n.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let s=[],c=this.h.entries();for(var l=c.next();!l.done;)l=l.value,s.push(l[0]+": "+l[1]),l=c.next();return s.join(`\r
`)};function Fr(s){s.onreadystatechange&&s.onreadystatechange.call(s)}Object.defineProperty(Ui.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(s){this.m=s?"include":"same-origin"}});function Th(s){let c="";return te(s,function(l,f){c+=f,c+=":",c+=l,c+=`\r
`}),c}function oa(s,c,l){e:{for(f in l){var f=!1;break e}f=!0}f||(l=Th(l),typeof s=="string"?l!=null&&encodeURIComponent(String(l)):ie(s,c,l))}function ae(s){be.call(this),this.headers=new Map,this.o=s||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}P(ae,be);var c_=/^https?$/i,u_=["POST","PUT"];n=ae.prototype,n.Ha=function(s){this.J=s},n.ea=function(s,c,l,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+s);c=c?c.toUpperCase():"GET",this.D=s,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Zo.g(),this.v=this.o?Jl(this.o):Jl(Zo),this.g.onreadystatechange=v(this.Ea,this);try{this.B=!0,this.g.open(c,String(s),!0),this.B=!1}catch(k){Eh(this,k);return}if(s=l||"",l=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var E in f)l.set(E,f[E]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let k of f.keys())l.set(k,f.get(k));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(l.keys()).find(k=>k.toLowerCase()=="content-type"),E=u.FormData&&s instanceof u.FormData,!(0<=Array.prototype.indexOf.call(u_,c,void 0))||f||E||l.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[k,N]of l)this.g.setRequestHeader(k,N);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{kh(this),this.u=!0,this.g.send(s),this.u=!1}catch(k){Eh(this,k)}};function Eh(s,c){s.h=!1,s.g&&(s.j=!0,s.g.abort(),s.j=!1),s.l=c,s.m=5,bh(s),Bi(s)}function bh(s){s.A||(s.A=!0,xe(s,"complete"),xe(s,"error"))}n.abort=function(s){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=s||7,xe(this,"complete"),xe(this,"abort"),Bi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Bi(this,!0)),ae.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Ah(this):this.bb())},n.bb=function(){Ah(this)};function Ah(s){if(s.h&&typeof a<"u"&&(!s.v[1]||pt(s)!=4||s.Z()!=2)){if(s.u&&pt(s)==4)Kl(s.Ea,0,s);else if(xe(s,"readystatechange"),pt(s)==4){s.h=!1;try{let N=s.Z();e:switch(N){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var l;if(!(l=c)){var f;if(f=N===0){var E=String(s.D).match(mh)[1]||null;!E&&u.self&&u.self.location&&(E=u.self.location.protocol.slice(0,-1)),f=!c_.test(E?E.toLowerCase():"")}l=f}if(l)xe(s,"complete"),xe(s,"success");else{s.m=6;try{var k=2<pt(s)?s.g.statusText:""}catch{k=""}s.l=k+" ["+s.Z()+"]",bh(s)}}finally{Bi(s)}}}}function Bi(s,c){if(s.g){kh(s);let l=s.g,f=s.v[0]?()=>{}:null;s.g=null,s.v=null,c||xe(s,"ready");try{l.onreadystatechange=f}catch{}}}function kh(s){s.I&&(u.clearTimeout(s.I),s.I=null)}n.isActive=function(){return!!this.g};function pt(s){return s.g?s.g.readyState:0}n.Z=function(){try{return 2<pt(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(s){if(this.g){var c=this.g.responseText;return s&&c.indexOf(s)==0&&(c=c.substring(s.length)),qg(c)}};function Sh(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.H){case"":case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch{return null}}function l_(s){let c={};s=(s.g&&2<=pt(s)&&s.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<s.length;f++){if(F(s[f]))continue;var l=T(s[f]);let E=l[0];if(l=l[1],typeof l!="string")continue;l=l.trim();let k=c[E]||[];c[E]=k,k.push(l)}w(c,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ur(s,c,l){return l&&l.internalChannelParams&&l.internalChannelParams[s]||c}function Ch(s){this.Aa=0,this.i=[],this.j=new Dr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ur("failFast",!1,s),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ur("baseRetryDelayMs",5e3,s),this.cb=Ur("retryDelaySeedMs",1e4,s),this.Wa=Ur("forwardChannelMaxRetries",2,s),this.wa=Ur("forwardChannelRequestTimeoutMs",2e4,s),this.pa=s&&s.xmlHttpFactory||void 0,this.Xa=s&&s.Tb||void 0,this.Ca=s&&s.useFetchStreams||!1,this.L=void 0,this.J=s&&s.supportsCrossDomainXhr||!1,this.K="",this.h=new uh(s&&s.concurrentRequestLimit),this.Da=new o_,this.P=s&&s.fastHandshake||!1,this.O=s&&s.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=s&&s.Rb||!1,s&&s.xa&&this.j.xa(),s&&s.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&s&&s.detectBufferingProxy||!1,this.ja=void 0,s&&s.longPollingTimeout&&0<s.longPollingTimeout&&(this.ja=s.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Ch.prototype,n.la=8,n.G=1,n.connect=function(s,c,l,f){Oe(0),this.W=s,this.H=c||{},l&&f!==void 0&&(this.H.OSID=l,this.H.OAID=f),this.F=this.X,this.I=Lh(this,null,this.W),$i(this)};function aa(s){if(Rh(s),s.G==3){var c=s.U++,l=ft(s.I);if(ie(l,"SID",s.K),ie(l,"RID",c),ie(l,"TYPE","terminate"),Br(s,l),c=new Dt(s,s.j,c),c.L=2,c.v=Fi(ft(l)),l=!1,u.navigator&&u.navigator.sendBeacon)try{l=u.navigator.sendBeacon(c.v.toString(),"")}catch{}!l&&u.Image&&(new Image().src=c.v,l=!0),l||(c.g=Fh(c.j,null),c.g.ea(c.v)),c.F=Date.now(),Vi(c)}Mh(s)}function qi(s){s.g&&(ua(s),s.g.cancel(),s.g=null)}function Rh(s){qi(s),s.u&&(u.clearTimeout(s.u),s.u=null),zi(s),s.h.cancel(),s.s&&(typeof s.s=="number"&&u.clearTimeout(s.s),s.s=null)}function $i(s){if(!lh(s.h)&&!s.s){s.s=!0;var c=s.Ga;Er||ql(),br||(Er(),br=!0),Bo.add(c,s),s.B=0}}function h_(s,c){return hh(s.h)>=s.h.j-(s.s?1:0)?!1:s.s?(s.i=c.D.concat(s.i),!0):s.G==1||s.G==2||s.B>=(s.Va?0:s.Wa)?!1:(s.s=Pr(v(s.Ga,s,c),Vh(s,s.B)),s.B++,!0)}n.Ga=function(s){if(this.s)if(this.s=null,this.G==1){if(!s){this.U=Math.floor(1e5*Math.random()),s=this.U++;let E=new Dt(this,this.j,s),k=this.o;if(this.S&&(k?(k=m(k),I(k,this.S)):k=this.S),this.m!==null||this.O||(E.H=k,k=null),this.P)e:{for(var c=0,l=0;l<this.i.length;l++){t:{var f=this.i[l];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,4096<c){c=l;break e}if(c===4096||l===this.i.length-1){c=l+1;break e}}c=1e3}else c=1e3;c=Dh(this,E,c),l=ft(this.I),ie(l,"RID",s),ie(l,"CVER",22),this.D&&ie(l,"X-HTTP-Session-Id",this.D),Br(this,l),k&&(this.O?c="headers="+encodeURIComponent(String(Th(k)))+"&"+c:this.m&&oa(l,this.m,k)),sa(this.h,E),this.Ua&&ie(l,"TYPE","init"),this.P?(ie(l,"$req",c),ie(l,"SID","null"),E.T=!0,ta(E,l,null)):ta(E,l,c),this.G=2}}else this.G==3&&(s?Ph(this,s):this.i.length==0||lh(this.h)||Ph(this))};function Ph(s,c){var l;c?l=c.l:l=s.U++;let f=ft(s.I);ie(f,"SID",s.K),ie(f,"RID",l),ie(f,"AID",s.T),Br(s,f),s.m&&s.o&&oa(f,s.m,s.o),l=new Dt(s,s.j,l,s.B+1),s.m===null&&(l.H=s.o),c&&(s.i=c.D.concat(s.i)),c=Dh(s,l,1e3),l.I=Math.round(.5*s.wa)+Math.round(.5*s.wa*Math.random()),sa(s.h,l),ta(l,f,c)}function Br(s,c){s.H&&te(s.H,function(l,f){ie(c,f,l)}),s.l&&ph({},function(l,f){ie(c,f,l)})}function Dh(s,c,l){l=Math.min(s.i.length,l);var f=s.l?v(s.l.Na,s.l,s):null;e:{var E=s.i;let k=-1;for(;;){let N=["count="+l];k==-1?0<l?(k=E[0].g,N.push("ofs="+k)):k=0:N.push("ofs="+k);let re=!0;for(let Ie=0;Ie<l;Ie++){let X=E[Ie].g,Ae=E[Ie].map;if(X-=k,0>X)k=Math.max(0,E[Ie].g-100),re=!1;else try{a_(Ae,N,"req"+X+"_")}catch{f&&f(Ae)}}if(re){f=N.join("&");break e}}}return s=s.i.splice(0,l),c.D=s,f}function Nh(s){if(!s.g&&!s.u){s.Y=1;var c=s.Fa;Er||ql(),br||(Er(),br=!0),Bo.add(c,s),s.v=0}}function ca(s){return s.g||s.u||3<=s.v?!1:(s.Y++,s.u=Pr(v(s.Fa,s),Vh(s,s.v)),s.v++,!0)}n.Fa=function(){if(this.u=null,xh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var s=2*this.R;this.j.info("BP detection timer enabled: "+s),this.A=Pr(v(this.ab,this),s)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Oe(10),qi(this),xh(this))};function ua(s){s.A!=null&&(u.clearTimeout(s.A),s.A=null)}function xh(s){s.g=new Dt(s,s.j,"rpc",s.Y),s.m===null&&(s.g.H=s.o),s.g.O=0;var c=ft(s.qa);ie(c,"RID","rpc"),ie(c,"SID",s.K),ie(c,"AID",s.T),ie(c,"CI",s.F?"0":"1"),!s.F&&s.ja&&ie(c,"TO",s.ja),ie(c,"TYPE","xmlhttp"),Br(s,c),s.m&&s.o&&oa(c,s.m,s.o),s.L&&(s.g.I=s.L);var l=s.g;s=s.ia,l.L=1,l.v=Fi(ft(c)),l.m=null,l.P=!0,oh(l,s)}n.Za=function(){this.C!=null&&(this.C=null,qi(this),ca(this),Oe(19))};function zi(s){s.C!=null&&(u.clearTimeout(s.C),s.C=null)}function Oh(s,c){var l=null;if(s.g==c){zi(s),ua(s),s.g=null;var f=2}else if(ia(s.h,c))l=c.D,dh(s.h,c),f=1;else return;if(s.G!=0){if(c.o)if(f==1){l=c.m?c.m.length:0,c=Date.now()-c.F;var E=s.B;f=Ni(),xe(f,new nh(f,l)),$i(s)}else Nh(s);else if(E=c.s,E==3||E==0&&0<c.X||!(f==1&&h_(s,c)||f==2&&ca(s)))switch(l&&0<l.length&&(c=s.h,c.i=c.i.concat(l)),E){case 1:tn(s,5);break;case 4:tn(s,10);break;case 3:tn(s,6);break;default:tn(s,2)}}}function Vh(s,c){let l=s.Ta+Math.floor(Math.random()*s.cb);return s.isActive()||(l*=2),l*c}function tn(s,c){if(s.j.info("Error code "+c),c==2){var l=v(s.fb,s),f=s.Xa;let E=!f;f=new en(f||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Mi(f,"https"),Fi(f),E?i_(f.toString(),l):s_(f.toString(),l)}else Oe(2);s.G=0,s.l&&s.l.sa(c),Mh(s),Rh(s)}n.fb=function(s){s?(this.j.info("Successfully pinged google.com"),Oe(2)):(this.j.info("Failed to ping google.com"),Oe(1))};function Mh(s){if(s.G=0,s.ka=[],s.l){let c=fh(s.h);(c.length!=0||s.i.length!=0)&&(D(s.ka,c),D(s.ka,s.i),s.h.i.length=0,x(s.i),s.i.length=0),s.l.ra()}}function Lh(s,c,l){var f=l instanceof en?ft(l):new en(l);if(f.g!="")c&&(f.g=c+"."+f.g),Li(f,f.s);else{var E=u.location;f=E.protocol,c=c?c+"."+E.hostname:E.hostname,E=+E.port;var k=new en(null);f&&Mi(k,f),c&&(k.g=c),E&&Li(k,E),l&&(k.l=l),f=k}return l=s.D,c=s.ya,l&&c&&ie(f,l,c),ie(f,"VER",s.la),Br(s,f),f}function Fh(s,c,l){if(c&&!s.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=s.Ca&&!s.pa?new ae(new Mr({eb:l})):new ae(s.pa),c.Ha(s.J),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Uh(){}n=Uh.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ji(){}ji.prototype.g=function(s,c){return new Fe(s,c)};function Fe(s,c){be.call(this),this.g=new Ch(c),this.l=s,this.h=c&&c.messageUrlParams||null,s=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.o=s,s=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(s?s["X-WebChannel-Content-Type"]=c.messageContentType:s={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(s?s["X-WebChannel-Client-Profile"]=c.va:s={"X-WebChannel-Client-Profile":c.va}),this.g.S=s,(s=c&&c.Sb)&&!F(s)&&(this.g.m=s),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!F(c)&&(this.g.D=c,s=this.h,s!==null&&c in s&&(s=this.h,c in s&&delete s[c])),this.j=new Dn(this)}P(Fe,be),Fe.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Fe.prototype.close=function(){aa(this.g)},Fe.prototype.o=function(s){var c=this.g;if(typeof s=="string"){var l={};l.__data__=s,s=l}else this.u&&(l={},l.__data__=Qo(s),s=l);c.i.push(new Hg(c.Ya++,s)),c.G==3&&$i(c)},Fe.prototype.N=function(){this.g.l=null,delete this.j,aa(this.g),delete this.g,Fe.aa.N.call(this)};function Bh(s){Jo.call(this),s.__headers__&&(this.headers=s.__headers__,this.statusCode=s.__status__,delete s.__headers__,delete s.__status__);var c=s.__sm__;if(c){e:{for(let l in c){s=l;break e}s=void 0}(this.i=s)&&(s=this.i,c=c!==null&&s in c?c[s]:void 0),this.data=c}else this.data=s}P(Bh,Jo);function qh(){Xo.call(this),this.status=1}P(qh,Xo);function Dn(s){this.g=s}P(Dn,Uh),Dn.prototype.ua=function(){xe(this.g,"a")},Dn.prototype.ta=function(s){xe(this.g,new Bh(s))},Dn.prototype.sa=function(s){xe(this.g,new qh)},Dn.prototype.ra=function(){xe(this.g,"b")},ji.prototype.createWebChannel=ji.prototype.g,Fe.prototype.send=Fe.prototype.o,Fe.prototype.open=Fe.prototype.m,Fe.prototype.close=Fe.prototype.close,mc=Et.createWebChannelTransport=function(){return new ji},pc=Et.getStatEventTarget=function(){return Ni()},fc=Et.Event=Xt,Vs=Et.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},xi.NO_ERROR=0,xi.TIMEOUT=8,xi.HTTP_ERROR=6,oi=Et.ErrorCode=xi,rh.COMPLETE="complete",dc=Et.EventType=rh,Xl.EventType=Cr,Cr.OPEN="a",Cr.CLOSE="b",Cr.ERROR="c",Cr.MESSAGE="d",be.prototype.listen=be.prototype.K,Wn=Et.WebChannel=Xl,$I=Et.FetchXmlHttpFactory=Mr,ae.prototype.listenOnce=ae.prototype.L,ae.prototype.getLastError=ae.prototype.Ka,ae.prototype.getLastErrorCode=ae.prototype.Ba,ae.prototype.getStatus=ae.prototype.Z,ae.prototype.getResponseJson=ae.prototype.Oa,ae.prototype.getResponseText=ae.prototype.oa,ae.prototype.send=ae.prototype.ea,ae.prototype.setWithCredentials=ae.prototype.Ha,hc=Et.XhrIo=ae}).apply(typeof Os<"u"?Os:typeof self<"u"?self:typeof window<"u"?window:{});var Yf="@firebase/firestore",Jf="4.7.14";var ye=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ye.UNAUTHENTICATED=new ye(null),ye.GOOGLE_CREDENTIALS=new ye("google-credentials-uid"),ye.FIRST_PARTY=new ye("first-party-uid"),ye.MOCK_USER=new ye("mock-user");var mr="11.7.3";var vn=new st("@firebase/firestore");function Kn(){return vn.logLevel}function O(n,...e){if(vn.logLevel<=H.DEBUG){let t=e.map(ol);vn.debug(`Firestore (${mr}): ${n}`,...t)}}function At(n,...e){if(vn.logLevel<=H.ERROR){let t=e.map(ol);vn.error(`Firestore (${mr}): ${n}`,...t)}}function er(n,...e){if(vn.logLevel<=H.WARN){let t=e.map(ol);vn.warn(`Firestore (${mr}): ${n}`,...t)}}function ol(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function L(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,jp(n,r,t)}function jp(n,e,t){let r=`FIRESTORE (${mr}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw At(r),new Error(r)}function ee(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||jp(e,i,r)}function U(n,e){return n}var C={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},V=class extends He{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var bt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var $s=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Ic=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ye.UNAUTHENTICATED))}shutdown(){}},wc=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Tc=class{constructor(e){this.t=e,this.currentUser=ye.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ee(this.o===void 0,42304);let r=this.i,i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve(),o=new bt;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new bt,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let h=o;e.enqueueRetryable(()=>A(this,null,function*(){yield h.promise,yield i(this.currentUser)}))},u=h=>{O("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?u(h):(O("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new bt)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(O("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ee(typeof r.accessToken=="string",31837,{l:r}),new $s(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return ee(e===null||typeof e=="string",2055,{h:e}),new ye(e)}},Ec=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=ye.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},bc=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Ec(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(ye.FIRST_PARTY))}shutdown(){}invalidateToken(){}},zs=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Ac=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,wt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ee(this.o===void 0,3512);let r=o=>{o.error!=null&&O("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let a=o.token!==this.m;return this.m=o.token,O("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{O("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?i(o):O("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new zs(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ee(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new zs(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function zI(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function Gp(){return new TextEncoder}var js=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=zI(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%62))}return r}};function K(n,e){return n<e?-1:n>e?1:0}function kc(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return K(r,i);{let o=Gp(),a=jI(o.encode(Xf(n,t)),o.encode(Xf(e,t)));return a!==0?a:K(r,i)}}t+=r>65535?2:1}return K(n.length,e.length)}function Xf(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function jI(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return K(n[t],e[t]);return K(n.length,e.length)}function tr(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Zf=-62135596800,ep=1e6,Te=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*ep);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new V(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new V(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Zf)throw new V(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new V(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ep}_compareTo(e){return this.seconds===e.seconds?K(this.nanoseconds,e.nanoseconds):K(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds-Zf;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var B=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Te(0,0))}static max(){return new n(new Te(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var tp="__name__",Gs=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&L(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&L(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=n.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return K(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):kc(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Tt.fromString(e.substring(4,e.length-2))}},oe=class n extends Gs{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new V(C.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},GI=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ze=class n extends Gs{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return GI.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===tp}static keyField(){return new n([tp])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new V(C.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new V(C.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new V(C.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(o(),i++)}if(o(),a)throw new V(C.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var M=class n{constructor(e){this.path=e}static fromPath(e){return new n(oe.fromString(e))}static fromName(e){return new n(oe.fromString(e).popFirst(5))}static empty(){return new n(oe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&oe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return oe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new oe(e.slice()))}};var di=-1,Sc=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Sc.UNKNOWN_ID=-1;function WI(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=B.fromTimestamp(r===1e9?new Te(t+1,0):new Te(t,r));return new In(i,M.empty(),e)}function KI(n){return new In(n.readTime,n.key,di)}var In=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(B.min(),M.empty(),di)}static max(){return new n(B.max(),M.empty(),di)}};function HI(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=M.comparator(n.documentKey,e.documentKey),t!==0?t:K(n.largestBatchId,e.largestBatchId))}var QI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Cc=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function gr(n){return A(this,null,function*(){if(n.code!==C.FAILED_PRECONDITION||n.message!==QI)throw n;O("LocalStore","Unexpectedly lost primary lease")})}var R=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&L(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++o,a&&o===i&&t()},h=>r(h))}),a=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,a=new Array(o),u=0;for(let h=0;h<o;h++){let d=h;t(e[d]).next(p=>{a[d]=p,++u,u===o&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};function YI(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function _r(n){return n.name==="IndexedDbTransactionError"}var al=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ue(i),this.ce=i=>r.writeSequenceNumber(i))}ue(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ce&&this.ce(t),t}}n.le=-1;return n})(),cl=-1;function Ao(n){return n==null}function fi(n){return n===0&&1/n==-1/0}function JI(n){return typeof n=="number"&&Number.isInteger(n)&&!fi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var Wp="";function XI(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=np(e)),e=ZI(n.get(t),e);return np(e)}function ZI(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case Wp:t+="";break;default:t+=o}}return t}function np(n){return n+Wp+""}var ew="remoteDocuments",Kp="owner";var Hp="mutationQueues";var Qp="mutations";var Yp="documentMutations",tw="remoteDocumentsV14";var Jp="remoteDocumentGlobal";var Xp="targets";var Zp="targetDocuments";var em="targetGlobal",tm="collectionParents";var nm="clientMetadata";var rm="bundles";var im="namedQueries";var nw="indexConfiguration";var rw="indexState";var iw="indexEntries";var sm="documentOverlays";var sw="globals";var ow=[Hp,Qp,Yp,ew,Xp,Kp,em,Zp,nm,Jp,tm,rm,im],LA=[...ow,sm],aw=[Hp,Qp,Yp,tw,Xp,Kp,em,Zp,nm,Jp,tm,rm,im,sm],cw=aw,uw=[...cw,nw,rw,iw];var FA=[...uw,sw];function rp(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Jt(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function om(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ue=class n{constructor(e,t){this.comparator=e,this.root=t||at.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,at.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,at.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Jn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Jn(this.root,e,this.comparator,!1)}getReverseIterator(){return new Jn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Jn(this.root,e,this.comparator,!0)}},Jn=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},at=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw L(43730,{key:this.key,value:this.value});if(this.right.isRed())throw L(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw L(27949);return e+(this.isRed()?0:1)}};at.EMPTY=null,at.RED=!0,at.BLACK=!1;at.EMPTY=new class{constructor(){this.size=0}get key(){throw L(57766)}get value(){throw L(16141)}get color(){throw L(16727)}get left(){throw L(29726)}get right(){throw L(36894)}copy(e,t,r,i,o){return this}insert(e,t,r){return new at(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var ve=class n{constructor(e){this.comparator=e,this.data=new ue(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ws(this.data.getIterator())}getIteratorFrom(e){return new Ws(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Ws=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Ye=class n{constructor(e){this.fields=e,e.sort(ze.comparator)}static empty(){return new n([])}unionWith(e){let t=new ve(ze.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return tr(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Ks=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var De=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Ks("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return K(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};De.EMPTY_BYTE_STRING=new De("");var lw=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function kt(n){if(ee(!!n,39018),typeof n=="string"){let e=0,t=lw.exec(n);if(ee(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:se(n.seconds),nanos:se(n.nanos)}}function se(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function St(n){return typeof n=="string"?De.fromBase64String(n):De.fromUint8Array(n)}var am="server_timestamp",cm="__type__",um="__previous_value__",lm="__local_write_time__";function ul(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[cm])===null||t===void 0?void 0:t.stringValue)===am}function ko(n){let e=n.mapValue.fields[um];return ul(e)?ko(e):e}function pi(n){let e=kt(n.mapValue.fields[lm].timestampValue);return new Te(e.seconds,e.nanos)}var Rc=class{constructor(e,t,r,i,o,a,u,h,d,p){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d,this.isUsingEmulator=p}},Hs="(default)",Qs=class n{constructor(e,t){this.projectId=e,this.database=t||Hs}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===Hs}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var ll="__type__",hm="__max__",Ms={mapValue:{fields:{__type__:{stringValue:hm}}}},hl="__vector__",nr="value";function Ht(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?ul(n)?4:fm(n)?9007199254740991:dm(n)?10:11:L(28295,{value:n})}function lt(n,e){if(n===e)return!0;let t=Ht(n);if(t!==Ht(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return pi(n).isEqual(pi(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let a=kt(i.timestampValue),u=kt(o.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return St(i.bytesValue).isEqual(St(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return se(i.geoPointValue.latitude)===se(o.geoPointValue.latitude)&&se(i.geoPointValue.longitude)===se(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return se(i.integerValue)===se(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let a=se(i.doubleValue),u=se(o.doubleValue);return a===u?fi(a)===fi(u):isNaN(a)&&isNaN(u)}return!1}(n,e);case 9:return tr(n.arrayValue.values||[],e.arrayValue.values||[],lt);case 10:case 11:return function(i,o){let a=i.mapValue.fields||{},u=o.mapValue.fields||{};if(rp(a)!==rp(u))return!1;for(let h in a)if(a.hasOwnProperty(h)&&(u[h]===void 0||!lt(a[h],u[h])))return!1;return!0}(n,e);default:return L(52216,{left:n})}}function mi(n,e){return(n.values||[]).find(t=>lt(t,e))!==void 0}function rr(n,e){if(n===e)return 0;let t=Ht(n),r=Ht(e);if(t!==r)return K(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return K(n.booleanValue,e.booleanValue);case 2:return function(o,a){let u=se(o.integerValue||o.doubleValue),h=se(a.integerValue||a.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1}(n,e);case 3:return ip(n.timestampValue,e.timestampValue);case 4:return ip(pi(n),pi(e));case 5:return kc(n.stringValue,e.stringValue);case 6:return function(o,a){let u=St(o),h=St(a);return u.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(o,a){let u=o.split("/"),h=a.split("/");for(let d=0;d<u.length&&d<h.length;d++){let p=K(u[d],h[d]);if(p!==0)return p}return K(u.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,a){let u=K(se(o.latitude),se(a.latitude));return u!==0?u:K(se(o.longitude),se(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return sp(n.arrayValue,e.arrayValue);case 10:return function(o,a){var u,h,d,p;let y=o.fields||{},v=a.fields||{},S=(u=y[nr])===null||u===void 0?void 0:u.arrayValue,P=(h=v[nr])===null||h===void 0?void 0:h.arrayValue,x=K(((d=S?.values)===null||d===void 0?void 0:d.length)||0,((p=P?.values)===null||p===void 0?void 0:p.length)||0);return x!==0?x:sp(S,P)}(n.mapValue,e.mapValue);case 11:return function(o,a){if(o===Ms.mapValue&&a===Ms.mapValue)return 0;if(o===Ms.mapValue)return 1;if(a===Ms.mapValue)return-1;let u=o.fields||{},h=Object.keys(u),d=a.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let y=0;y<h.length&&y<p.length;++y){let v=kc(h[y],p[y]);if(v!==0)return v;let S=rr(u[h[y]],d[p[y]]);if(S!==0)return S}return K(h.length,p.length)}(n.mapValue,e.mapValue);default:throw L(23264,{Pe:t})}}function ip(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return K(n,e);let t=kt(n),r=kt(e),i=K(t.seconds,r.seconds);return i!==0?i:K(t.nanos,r.nanos)}function sp(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=rr(t[i],r[i]);if(o)return o}return K(t.length,r.length)}function ir(n){return Pc(n)}function Pc(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=kt(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return St(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return M.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=Pc(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let a of r)o?o=!1:i+=",",i+=`${a}:${Pc(t.fields[a])}`;return i+"}"}(n.mapValue):L(61005,{value:n})}function Us(n){switch(Ht(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=ko(n);return e?16+Us(e):16;case 5:return 2*n.stringValue.length;case 6:return St(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,o)=>i+Us(o),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return Jt(r.fields,(o,a)=>{i+=o.length+Us(a)}),i}(n.mapValue);default:throw L(13486,{value:n})}}function op(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Dc(n){return!!n&&"integerValue"in n}function dl(n){return!!n&&"arrayValue"in n}function ap(n){return!!n&&"nullValue"in n}function cp(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Bs(n){return!!n&&"mapValue"in n}function dm(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[ll])===null||t===void 0?void 0:t.stringValue)===hl}function ci(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Jt(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=ci(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ci(n.arrayValue.values[t]);return e}return Object.assign({},n)}function fm(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===hm}var BA={mapValue:{fields:{[ll]:{stringValue:hl},[nr]:{arrayValue:{}}}}};var $e=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Bs(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ci(t)}setAll(e){let t=ze.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){let h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=u.popLast()}a?r[u.lastSegment()]=ci(a):i.push(u.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());Bs(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return lt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Bs(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Jt(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(ci(this.value))}};function pm(n){let e=[];return Jt(n.fields,(t,r)=>{let i=new ze([t]);if(Bs(r)){let o=pm(r.mapValue).fields;if(o.length===0)e.push(i);else for(let a of o)e.push(i.child(a))}else e.push(i)}),new Ye(e)}var nt=class n{constructor(e,t,r,i,o,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=a,this.documentState=u}static newInvalidDocument(e){return new n(e,0,B.min(),B.min(),B.min(),$e.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,B.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,B.min(),B.min(),$e.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,B.min(),B.min(),$e.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(B.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=$e.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=$e.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=B.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var sr=class{constructor(e,t){this.position=e,this.inclusive=t}};function up(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],a=n.position[i];if(o.field.isKeyField()?r=M.comparator(M.fromName(a.referenceValue),t.key):r=rr(a,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function lp(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!lt(n.position[t],e.position[t]))return!1;return!0}var or=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function hw(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Ys=class{},pe=class n extends Ys{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new xc(e,t,r):t==="array-contains"?new Mc(e,r):t==="in"?new Lc(e,r):t==="not-in"?new Fc(e,r):t==="array-contains-any"?new Uc(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Oc(e,r):new Vc(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(rr(t,this.value)):t!==null&&Ht(this.value)===Ht(t)&&this.matchesComparison(rr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return L(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},rt=class n extends Ys{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new n(e,t)}matches(e){return mm(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}};function mm(n){return n.op==="and"}function gm(n){return dw(n)&&mm(n)}function dw(n){for(let e of n.filters)if(e instanceof rt)return!1;return!0}function Nc(n){if(n instanceof pe)return n.field.canonicalString()+n.op.toString()+ir(n.value);if(gm(n))return n.filters.map(e=>Nc(e)).join(",");{let e=n.filters.map(t=>Nc(t)).join(",");return`${n.op}(${e})`}}function _m(n,e){return n instanceof pe?function(r,i){return i instanceof pe&&r.op===i.op&&r.field.isEqual(i.field)&&lt(r.value,i.value)}(n,e):n instanceof rt?function(r,i){return i instanceof rt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,a,u)=>o&&_m(a,i.filters[u]),!0):!1}(n,e):void L(19439)}function ym(n){return n instanceof pe?function(t){return`${t.field.canonicalString()} ${t.op} ${ir(t.value)}`}(n):n instanceof rt?function(t){return t.op.toString()+" {"+t.getFilters().map(ym).join(" ,")+"}"}(n):"Filter"}var xc=class extends pe{constructor(e,t,r){super(e,t,r),this.key=M.fromName(r.referenceValue)}matches(e){let t=M.comparator(e.key,this.key);return this.matchesComparison(t)}},Oc=class extends pe{constructor(e,t){super(e,"in",t),this.keys=vm("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Vc=class extends pe{constructor(e,t){super(e,"not-in",t),this.keys=vm("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function vm(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>M.fromName(r.referenceValue))}var Mc=class extends pe{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return dl(t)&&mi(t.arrayValue,this.value)}},Lc=class extends pe{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&mi(this.value.arrayValue,t)}},Fc=class extends pe{constructor(e,t){super(e,"not-in",t)}matches(e){if(mi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!mi(this.value.arrayValue,t)}},Uc=class extends pe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!dl(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>mi(this.value.arrayValue,r))}};var Bc=class{constructor(e,t=null,r=[],i=[],o=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=a,this.endAt=u,this.Ie=null}};function hp(n,e=null,t=[],r=[],i=null,o=null,a=null){return new Bc(n,e,t,r,i,o,a)}function fl(n){let e=U(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Nc(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),Ao(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>ir(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>ir(r)).join(",")),e.Ie=t}return e.Ie}function pl(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!hw(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!_m(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!lp(n.startAt,e.startAt)&&lp(n.endAt,e.endAt)}function qc(n){return M.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var wn=class{constructor(e,t=null,r=[],i=[],o=null,a="F",u=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=a,this.startAt=u,this.endAt=h,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}};function fw(n,e,t,r,i,o,a,u){return new wn(n,e,t,r,i,o,a,u)}function ml(n){return new wn(n)}function dp(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Im(n){return n.collectionGroup!==null}function ui(n){let e=U(n);if(e.Ee===null){e.Ee=[];let t=new Set;for(let o of e.explicitOrderBy)e.Ee.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new ve(ze.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ee.push(new or(o,r))}),t.has(ze.keyField().canonicalString())||e.Ee.push(new or(ze.keyField(),r))}return e.Ee}function ct(n){let e=U(n);return e.de||(e.de=pw(e,ui(n))),e.de}function pw(n,e){if(n.limitType==="F")return hp(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new or(i.field,o)});let t=n.endAt?new sr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new sr(n.startAt.position,n.startAt.inclusive):null;return hp(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function $c(n,e){let t=n.filters.concat([e]);return new wn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function zc(n,e,t){return new wn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function So(n,e){return pl(ct(n),ct(e))&&n.limitType===e.limitType}function wm(n){return`${fl(ct(n))}|lt:${n.limitType}`}function Hn(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>ym(i)).join(", ")}]`),Ao(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>ir(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>ir(i)).join(",")),`Target(${r})`}(ct(n))}; limitType=${n.limitType})`}function Co(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):M.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of ui(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,u,h){let d=up(a,u,h);return a.inclusive?d<=0:d<0}(r.startAt,ui(r),i)||r.endAt&&!function(a,u,h){let d=up(a,u,h);return a.inclusive?d>=0:d>0}(r.endAt,ui(r),i))}(n,e)}function mw(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Tm(n){return(e,t)=>{let r=!1;for(let i of ui(n)){let o=gw(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function gw(n,e,t){let r=n.field.isKeyField()?M.comparator(e.key,t.key):function(o,a,u){let h=a.data.field(o),d=u.data.field(o);return h!==null&&d!==null?rr(h,d):L(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return L(19790,{direction:n.dir})}}var Ct=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Jt(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return om(this.inner)}size(){return this.innerSize}};var _w=new ue(M.comparator);function Rt(){return _w}var Em=new ue(M.comparator);function ai(...n){let e=Em;for(let t of n)e=e.insert(t.key,t);return e}function bm(n){let e=Em;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function mn(){return li()}function Am(){return li()}function li(){return new Ct(n=>n.toString(),(n,e)=>n.isEqual(e))}var yw=new ue(M.comparator),vw=new ve(M.comparator);function Q(...n){let e=vw;for(let t of n)e=e.add(t);return e}var Iw=new ve(K);function ww(){return Iw}function gl(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fi(e)?"-0":e}}function km(n){return{integerValue:""+n}}function Tw(n,e){return JI(e)?km(e):gl(n,e)}var ar=class{constructor(){this._=void 0}};function Ew(n,e,t){return n instanceof cr?function(i,o){let a={fields:{[cm]:{stringValue:am},[lm]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&ul(o)&&(o=ko(o)),o&&(a.fields[um]=o),{mapValue:a}}(t,e):n instanceof Tn?Cm(n,e):n instanceof En?Rm(n,e):function(i,o){let a=Sm(i,o),u=fp(a)+fp(i.Re);return Dc(a)&&Dc(i.Re)?km(u):gl(i.serializer,u)}(n,e)}function bw(n,e,t){return n instanceof Tn?Cm(n,e):n instanceof En?Rm(n,e):t}function Sm(n,e){return n instanceof ur?function(r){return Dc(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var cr=class extends ar{},Tn=class extends ar{constructor(e){super(),this.elements=e}};function Cm(n,e){let t=Pm(e);for(let r of n.elements)t.some(i=>lt(i,r))||t.push(r);return{arrayValue:{values:t}}}var En=class extends ar{constructor(e){super(),this.elements=e}};function Rm(n,e){let t=Pm(e);for(let r of n.elements)t=t.filter(i=>!lt(i,r));return{arrayValue:{values:t}}}var ur=class extends ar{constructor(e,t){super(),this.serializer=e,this.Re=t}};function fp(n){return se(n.integerValue||n.doubleValue)}function Pm(n){return dl(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Aw(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Tn&&i instanceof Tn||r instanceof En&&i instanceof En?tr(r.elements,i.elements,lt):r instanceof ur&&i instanceof ur?lt(r.Re,i.Re):r instanceof cr&&i instanceof cr}(n.transform,e.transform)}var jc=class{constructor(e,t){this.version=e,this.transformResults=t}},Wt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function qs(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var lr=class{};function Dm(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Js(n.key,Wt.none()):new bn(n.key,n.data,Wt.none());{let t=n.data,r=$e.empty(),i=new ve(ze.comparator);for(let o of e.fields)if(!i.has(o)){let a=t.field(o);a===null&&o.length>1&&(o=o.popLast(),a=t.field(o)),a===null?r.delete(o):r.set(o,a),i=i.add(o)}return new ht(n.key,r,new Ye(i.toArray()),Wt.none())}}function kw(n,e,t){n instanceof bn?function(i,o,a){let u=i.value.clone(),h=mp(i.fieldTransforms,o,a.transformResults);u.setAll(h),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(n,e,t):n instanceof ht?function(i,o,a){if(!qs(i.precondition,o))return void o.convertToUnknownDocument(a.version);let u=mp(i.fieldTransforms,o,a.transformResults),h=o.data;h.setAll(Nm(i)),h.setAll(u),o.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function hi(n,e,t,r){return n instanceof bn?function(o,a,u,h){if(!qs(o.precondition,a))return u;let d=o.value.clone(),p=gp(o.fieldTransforms,h,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof ht?function(o,a,u,h){if(!qs(o.precondition,a))return u;let d=gp(o.fieldTransforms,h,a),p=a.data;return p.setAll(Nm(o)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(y=>y.field))}(n,e,t,r):function(o,a,u){return qs(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(n,e,t)}function Sw(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=Sm(r.transform,i||null);o!=null&&(t===null&&(t=$e.empty()),t.set(r.field,o))}return t||null}function pp(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&tr(r,i,(o,a)=>Aw(o,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var bn=class extends lr{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},ht=class extends lr{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function Nm(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function mp(n,e,t){let r=new Map;ee(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let i=0;i<t.length;i++){let o=n[i],a=o.transform,u=e.data.field(o.field);r.set(o.field,bw(a,u,t[i]))}return r}function gp(n,e,t){let r=new Map;for(let i of n){let o=i.transform,a=t.data.field(i.field);r.set(i.field,Ew(o,a,e))}return r}var Js=class extends lr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Gc=class extends lr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Wc=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&kw(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=hi(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=hi(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Am();return this.mutations.forEach(i=>{let o=e.get(i.key),a=o.overlayedDocument,u=this.applyToLocalView(a,o.mutatedFields);u=t.has(i.key)?null:u;let h=Dm(a,u);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(B.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Q())}isEqual(e){return this.batchId===e.batchId&&tr(this.mutations,e.mutations,(t,r)=>pp(t,r))&&tr(this.baseMutations,e.baseMutations,(t,r)=>pp(t,r))}},Kc=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ee(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let i=function(){return yw}(),o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new n(e,t,r,i)}};var Hc=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Qc=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var de,J;function Cw(n){switch(n){case C.OK:return L(64938);case C.CANCELLED:case C.UNKNOWN:case C.DEADLINE_EXCEEDED:case C.RESOURCE_EXHAUSTED:case C.INTERNAL:case C.UNAVAILABLE:case C.UNAUTHENTICATED:return!1;case C.INVALID_ARGUMENT:case C.NOT_FOUND:case C.ALREADY_EXISTS:case C.PERMISSION_DENIED:case C.FAILED_PRECONDITION:case C.ABORTED:case C.OUT_OF_RANGE:case C.UNIMPLEMENTED:case C.DATA_LOSS:return!0;default:return L(15467,{code:n})}}function xm(n){if(n===void 0)return At("GRPC error has no .code"),C.UNKNOWN;switch(n){case de.OK:return C.OK;case de.CANCELLED:return C.CANCELLED;case de.UNKNOWN:return C.UNKNOWN;case de.DEADLINE_EXCEEDED:return C.DEADLINE_EXCEEDED;case de.RESOURCE_EXHAUSTED:return C.RESOURCE_EXHAUSTED;case de.INTERNAL:return C.INTERNAL;case de.UNAVAILABLE:return C.UNAVAILABLE;case de.UNAUTHENTICATED:return C.UNAUTHENTICATED;case de.INVALID_ARGUMENT:return C.INVALID_ARGUMENT;case de.NOT_FOUND:return C.NOT_FOUND;case de.ALREADY_EXISTS:return C.ALREADY_EXISTS;case de.PERMISSION_DENIED:return C.PERMISSION_DENIED;case de.FAILED_PRECONDITION:return C.FAILED_PRECONDITION;case de.ABORTED:return C.ABORTED;case de.OUT_OF_RANGE:return C.OUT_OF_RANGE;case de.UNIMPLEMENTED:return C.UNIMPLEMENTED;case de.DATA_LOSS:return C.DATA_LOSS;default:return L(39323,{code:n})}}(J=de||(de={}))[J.OK=0]="OK",J[J.CANCELLED=1]="CANCELLED",J[J.UNKNOWN=2]="UNKNOWN",J[J.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",J[J.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",J[J.NOT_FOUND=5]="NOT_FOUND",J[J.ALREADY_EXISTS=6]="ALREADY_EXISTS",J[J.PERMISSION_DENIED=7]="PERMISSION_DENIED",J[J.UNAUTHENTICATED=16]="UNAUTHENTICATED",J[J.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",J[J.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",J[J.ABORTED=10]="ABORTED",J[J.OUT_OF_RANGE=11]="OUT_OF_RANGE",J[J.UNIMPLEMENTED=12]="UNIMPLEMENTED",J[J.INTERNAL=13]="INTERNAL",J[J.UNAVAILABLE=14]="UNAVAILABLE",J[J.DATA_LOSS=15]="DATA_LOSS";var _p=null;var Rw=new Tt([4294967295,4294967295],0);function yp(n){let e=Gp().encode(n),t=new lc;return t.update(e),new Uint8Array(t.digest())}function vp(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Tt([t,r],0),new Tt([i,o],0)]}var Yc=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new gn(`Invalid padding: ${t}`);if(r<0)throw new gn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new gn(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new gn(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=Tt.fromNumber(this.pe)}we(e,t,r){let i=e.add(t.multiply(Tt.fromNumber(r)));return i.compare(Rw)===1&&(i=new Tt([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;let t=yp(e),[r,i]=vp(t);for(let o=0;o<this.hashCount;o++){let a=this.we(r,i,o);if(!this.be(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new n(o,i,t);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.pe===0)return;let t=yp(e),[r,i]=vp(t);for(let o=0;o<this.hashCount;o++){let a=this.we(r,i,o);this.Se(a)}}Se(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},gn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Xs=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,gi.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(B.min(),i,new ue(K),Rt(),Q())}},gi=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,Q(),Q(),Q())}};var Xn=class{constructor(e,t,r,i){this.De=e,this.removedTargetIds=t,this.key=r,this.ve=i}},Zs=class{constructor(e,t){this.targetId=e,this.Ce=t}},eo=class{constructor(e,t,r=De.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},to=class{constructor(){this.Fe=0,this.Me=Ip(),this.xe=De.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Q(),t=Q(),r=Q();return this.Me.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:L(38017,{changeType:o})}}),new gi(this.xe,this.Oe,e,t,r)}Qe(){this.Ne=!1,this.Me=Ip()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,ee(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}},Jc=class{constructor(e){this.ze=e,this.je=new Map,this.He=Rt(),this.Je=Ls(),this.Ye=Ls(),this.Ze=new ue(K)}Xe(e){for(let t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(let t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{let r=this.rt(t);switch(e.state){case 0:this.it(t)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(t);break;case 3:this.it(t)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),r.ke(e.resumeToken));break;default:L(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((r,i)=>{this.it(i)&&t(i)})}ot(e){let t=e.targetId,r=e.Ce.count,i=this._t(t);if(i){let o=i.target;if(qc(o))if(r===0){let a=new M(o.path);this.tt(t,a,nt.newNoDocument(a,B.min()))}else ee(r===1,20013,{expectedCount:r});else{let a=this.ut(t);if(a!==r){let u=this.ct(e),h=u?this.lt(u,e,a):1;if(h!==0){this.st(t);let d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,d)}_p?.ht(function(p,y,v,S,P){var x,D,$,F,z,ne;let Ne={localCacheCount:p,existenceFilterCount:y.count,databaseId:v.database,projectId:v.projectId},te=y.unchangedNames;return te&&(Ne.bloomFilter={applied:P===0,hashCount:(x=te?.hashCount)!==null&&x!==void 0?x:0,bitmapLength:(F=($=(D=te?.bits)===null||D===void 0?void 0:D.bitmap)===null||$===void 0?void 0:$.length)!==null&&F!==void 0?F:0,padding:(ne=(z=te?.bits)===null||z===void 0?void 0:z.padding)!==null&&ne!==void 0?ne:0,mightContain:w=>{var m;return(m=S?.mightContain(w))!==null&&m!==void 0&&m}}),Ne}(a,e.Ce,this.ze.Pt(),u,h))}}}}ct(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,a,u;try{a=St(r).toUint8Array()}catch(h){if(h instanceof Ks)return er("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new Yc(a,i,o)}catch(h){return er(h instanceof gn?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.pe===0?null:u}lt(e,t,r){return t.Ce.count===r-this.Tt(e,t.targetId)?0:2}Tt(e,t){let r=this.ze.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let a=this.ze.Pt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.tt(t,o,null),i++)}),i}It(e){let t=new Map;this.je.forEach((o,a)=>{let u=this._t(a);if(u){if(o.current&&qc(u.target)){let h=new M(u.target.path);this.Et(h).has(a)||this.dt(a,h)||this.tt(a,h,nt.newNoDocument(h,e))}o.Le&&(t.set(a,o.qe()),o.Qe())}});let r=Q();this.Ye.forEach((o,a)=>{let u=!0;a.forEachWhile(h=>{let d=this._t(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(o))}),this.He.forEach((o,a)=>a.setReadTime(e));let i=new Xs(e,t,this.Ze,this.He,r);return this.He=Rt(),this.Je=Ls(),this.Ye=Ls(),this.Ze=new ue(K),i}et(e,t){if(!this.it(e))return;let r=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,r),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,r){if(!this.it(e))return;let i=this.rt(e);this.dt(e,t)?i.$e(t,1):i.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),r&&(this.He=this.He.insert(t,r))}removeTarget(e){this.je.delete(e)}ut(e){let t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new to,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new ve(K),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new ve(K),this.Je=this.Je.insert(e,t)),t}it(e){let t=this._t(e)!==null;return t||O("WatchChangeAggregator","Detected inactive target",e),t}_t(e){let t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new to),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}};function Ls(){return new ue(M.comparator)}function Ip(){return new ue(M.comparator)}var Pw={asc:"ASCENDING",desc:"DESCENDING"},Dw={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Nw={and:"AND",or:"OR"},Xc=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Zc(n,e){return n.useProto3Json||Ao(e)?e:{value:e}}function no(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Om(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function xw(n,e){return no(n,e.toTimestamp())}function ut(n){return ee(!!n,49232),B.fromTimestamp(function(t){let r=kt(t);return new Te(r.seconds,r.nanos)}(n))}function _l(n,e){return eu(n,e).canonicalString()}function eu(n,e){let t=function(i){return new oe(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Vm(n){let e=oe.fromString(n);return ee(Bm(e),10190,{key:e.toString()}),e}function tu(n,e){return _l(n.databaseId,e.path)}function gc(n,e){let t=Vm(e);if(t.get(1)!==n.databaseId.projectId)throw new V(C.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new V(C.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new M(Lm(t))}function Mm(n,e){return _l(n.databaseId,e)}function Ow(n){let e=Vm(n);return e.length===4?oe.emptyPath():Lm(e)}function nu(n){return new oe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Lm(n){return ee(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function wp(n,e,t){return{name:tu(n,e),fields:t.value.mapValue.fields}}function Vw(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:L(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(d,p){return d.useProto3Json?(ee(p===void 0||typeof p=="string",58123),De.fromBase64String(p||"")):(ee(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),De.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(d){let p=d.code===void 0?C.UNKNOWN:xm(d.code);return new V(p,d.message||"")}(a);t=new eo(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=gc(n,r.document.name),o=ut(r.document.updateTime),a=r.document.createTime?ut(r.document.createTime):B.min(),u=new $e({mapValue:{fields:r.document.fields}}),h=nt.newFoundDocument(i,o,a,u),d=r.targetIds||[],p=r.removedTargetIds||[];t=new Xn(d,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=gc(n,r.document),o=r.readTime?ut(r.readTime):B.min(),a=nt.newNoDocument(i,o),u=r.removedTargetIds||[];t=new Xn([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=gc(n,r.document),o=r.removedTargetIds||[];t=new Xn([],o,i,null)}else{if(!("filter"in e))return L(11601,{Vt:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,a=new Qc(i,o),u=r.targetId;t=new Zs(u,a)}}return t}function Mw(n,e){let t;if(e instanceof bn)t={update:wp(n,e.key,e.value)};else if(e instanceof Js)t={delete:tu(n,e.key)};else if(e instanceof ht)t={update:wp(n,e.key,e.data),updateMask:Gw(e.fieldMask)};else{if(!(e instanceof Gc))return L(16599,{ft:e.type});t={verify:tu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,a){let u=a.transform;if(u instanceof cr)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Tn)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof En)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof ur)return{fieldPath:a.field.canonicalString(),increment:u.Re};throw L(20930,{transform:a.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:xw(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:L(27497)}(n,e.precondition)),t}function Lw(n,e){return n&&n.length>0?(ee(e!==void 0,14353),n.map(t=>function(i,o){let a=i.updateTime?ut(i.updateTime):ut(o);return a.isEqual(B.min())&&(a=ut(o)),new jc(a,i.transformResults||[])}(t,e))):[]}function Fw(n,e){return{documents:[Mm(n,e.path)]}}function Uw(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Mm(n,i);let o=function(d){if(d.length!==0)return Um(rt.create(d,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let a=function(d){if(d.length!==0)return d.map(p=>function(v){return{field:Qn(v.field),direction:$w(v.dir)}}(p))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let u=Zc(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{gt:t,parent:i}}function Bw(n){let e=Ow(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ee(r===1,65062);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let o=[];t.where&&(o=function(y){let v=Fm(y);return v instanceof rt&&gm(v)?v.getFilters():[v]}(t.where));let a=[];t.orderBy&&(a=function(y){return y.map(v=>function(P){return new or(Yn(P.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(P.direction))}(v))}(t.orderBy));let u=null;t.limit&&(u=function(y){let v;return v=typeof y=="object"?y.value:y,Ao(v)?null:v}(t.limit));let h=null;t.startAt&&(h=function(y){let v=!!y.before,S=y.values||[];return new sr(S,v)}(t.startAt));let d=null;return t.endAt&&(d=function(y){let v=!y.before,S=y.values||[];return new sr(S,v)}(t.endAt)),fw(e,i,a,o,u,"F",h,d)}function qw(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return L(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Fm(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Yn(t.unaryFilter.field);return pe.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Yn(t.unaryFilter.field);return pe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Yn(t.unaryFilter.field);return pe.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Yn(t.unaryFilter.field);return pe.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return L(61313);default:return L(60726)}}(n):n.fieldFilter!==void 0?function(t){return pe.create(Yn(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return L(58110);default:return L(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return rt.create(t.compositeFilter.filters.map(r=>Fm(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return L(1026)}}(t.compositeFilter.op))}(n):L(30097,{filter:n})}function $w(n){return Pw[n]}function zw(n){return Dw[n]}function jw(n){return Nw[n]}function Qn(n){return{fieldPath:n.canonicalString()}}function Yn(n){return ze.fromServerFormat(n.fieldPath)}function Um(n){return n instanceof pe?function(t){if(t.op==="=="){if(cp(t.value))return{unaryFilter:{field:Qn(t.field),op:"IS_NAN"}};if(ap(t.value))return{unaryFilter:{field:Qn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(cp(t.value))return{unaryFilter:{field:Qn(t.field),op:"IS_NOT_NAN"}};if(ap(t.value))return{unaryFilter:{field:Qn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Qn(t.field),op:zw(t.op),value:t.value}}}(n):n instanceof rt?function(t){let r=t.getFilters().map(i=>Um(i));return r.length===1?r[0]:{compositeFilter:{op:jw(t.op),filters:r}}}(n):L(54877,{filter:n})}function Gw(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Bm(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var _i=class n{constructor(e,t,r,i,o=B.min(),a=B.min(),u=De.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var ru=class{constructor(e){this.wt=e}};function Ww(n){let e=Bw({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?zc(e,e.limit,"L"):e}var ro=class{constructor(){}vt(e,t){this.Ct(e,t),t.Ft()}Ct(e,t){if("nullValue"in e)this.Mt(t,5);else if("booleanValue"in e)this.Mt(t,10),t.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(t,15),t.xt(se(e.integerValue));else if("doubleValue"in e){let r=se(e.doubleValue);isNaN(r)?this.Mt(t,13):(this.Mt(t,15),fi(r)?t.xt(0):t.xt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Mt(t,20),typeof r=="string"&&(r=kt(r)),t.Ot(`${r.seconds||""}`),t.xt(r.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,t),this.Bt(t);else if("bytesValue"in e)this.Mt(t,30),t.Lt(St(e.bytesValue)),this.Bt(t);else if("referenceValue"in e)this.kt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Mt(t,45),t.xt(r.latitude||0),t.xt(r.longitude||0)}else"mapValue"in e?fm(e)?this.Mt(t,Number.MAX_SAFE_INTEGER):dm(e)?this.qt(e.mapValue,t):(this.Qt(e.mapValue,t),this.Bt(t)):"arrayValue"in e?(this.$t(e.arrayValue,t),this.Bt(t)):L(19022,{Ut:e})}Nt(e,t){this.Mt(t,25),this.Kt(e,t)}Kt(e,t){t.Ot(e)}Qt(e,t){let r=e.fields||{};this.Mt(t,55);for(let i of Object.keys(r))this.Nt(i,t),this.Ct(r[i],t)}qt(e,t){var r,i;let o=e.fields||{};this.Mt(t,53);let a=nr,u=((i=(r=o[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Mt(t,15),t.xt(se(u)),this.Nt(a,t),this.Ct(o[a],t)}$t(e,t){let r=e.values||[];this.Mt(t,50);for(let i of r)this.Ct(i,t)}kt(e,t){this.Mt(t,37),M.fromName(e).path.forEach(r=>{this.Mt(t,60),this.Kt(r,t)})}Mt(e,t){e.xt(t)}Bt(e){e.xt(2)}};ro.Wt=new ro;var iu=class{constructor(){this.yn=new su}addToCollectionParentIndex(e,t){return this.yn.add(t),R.resolve()}getCollectionParents(e,t){return R.resolve(this.yn.getEntries(t))}addFieldIndex(e,t){return R.resolve()}deleteFieldIndex(e,t){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,t){return R.resolve()}getDocumentsMatchingTarget(e,t){return R.resolve(null)}getIndexType(e,t){return R.resolve(0)}getFieldIndexes(e,t){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,t){return R.resolve(In.min())}getMinOffsetFromCollectionGroup(e,t){return R.resolve(In.min())}updateCollectionGroup(e,t,r){return R.resolve()}updateIndexEntries(e,t){return R.resolve()}},su=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new ve(oe.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new ve(oe.comparator)).toArray()}};var qA=new Uint8Array(0);var Tp={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},qm=41943040,Qe=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};Qe.DEFAULT_COLLECTION_PERCENTILE=10,Qe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Qe.DEFAULT=new Qe(qm,Qe.DEFAULT_COLLECTION_PERCENTILE,Qe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Qe.DISABLED=new Qe(-1,0,0);var yi=class n{constructor(e){this.nr=e}next(){return this.nr+=2,this.nr}static rr(){return new n(0)}static ir(){return new n(-1)}};var Ep="LruGarbageCollector",Kw=1048576;function bp([n,e],[t,r]){let i=K(n,t);return i===0?K(e,r):i}var ou=class{constructor(e){this.cr=e,this.buffer=new ve(bp),this.lr=0}hr(){return++this.lr}Pr(e){let t=[e,this.hr()];if(this.buffer.size<this.cr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();bp(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},au=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Tr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ir(6e4)}stop(){this.Tr&&(this.Tr.cancel(),this.Tr=null)}get started(){return this.Tr!==null}Ir(e){O(Ep,`Garbage collection scheduled in ${e}ms`),this.Tr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>A(this,null,function*(){this.Tr=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){_r(t)?O(Ep,"Ignoring IndexedDB error during garbage collection: ",t):yield gr(t)}yield this.Ir(3e5)}))}},cu=class{constructor(e,t){this.Er=e,this.params=t}calculateTargetCount(e,t){return this.Er.dr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return R.resolve(al.le);let r=new ou(t);return this.Er.forEachTarget(e,i=>r.Pr(i.sequenceNumber)).next(()=>this.Er.Ar(e,i=>r.Pr(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Er.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Er.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(O("LruGarbageCollector","Garbage collection skipped; disabled"),R.resolve(Tp)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(O("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Tp):this.Rr(e,t))}getCacheSize(e){return this.Er.getCacheSize(e)}Rr(e,t){let r,i,o,a,u,h,d,p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(O("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),i=this.params.maximumSequenceNumbersToCollect):i=y,a=Date.now(),this.nthSequenceNumber(e,i))).next(y=>(r=y,u=Date.now(),this.removeTargets(e,r,t))).next(y=>(o=y,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(y=>(d=Date.now(),Kn()<=H.DEBUG&&O("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-p}ms
	Determined least recently used ${i} in `+(u-a)+`ms
	Removed ${o} targets in `+(h-u)+`ms
	Removed ${y} documents in `+(d-h)+`ms
Total Duration: ${d-p}ms`),R.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:y})))}};function Hw(n,e){return new cu(n,e)}var uu=class{constructor(){this.changes=new Ct(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,nt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?R.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var lu=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var hu=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&hi(r.mutation,i,Ye.empty(),Te.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Q()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Q()){let i=mn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let a=ai();return o.forEach((u,h)=>{a=a.insert(u,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=mn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Q()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,r,i){let o=Rt(),a=li(),u=function(){return li()}();return t.forEach((h,d)=>{let p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof ht)?o=o.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),hi(p.mutation,d,p.mutation.getFieldMask(),Te.now())):a.set(d.key,Ye.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>{var y;return u.set(d,new lu(p,(y=a.get(d))!==null&&y!==void 0?y:null))}),u))}recalculateAndSaveOverlays(e,t){let r=li(),i=new ue((a,u)=>a-u),o=Q();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let u of a)u.keys().forEach(h=>{let d=t.get(h);if(d===null)return;let p=r.get(h)||Ye.empty();p=u.applyToLocalView(d,p),r.set(h,p);let y=(i.get(u.batchId)||Q()).add(h);i=i.insert(u.batchId,y)})}).next(()=>{let a=[],u=i.getReverseIterator();for(;u.hasNext();){let h=u.getNext(),d=h.key,p=h.value,y=Am();p.forEach(v=>{if(!o.has(v)){let S=Dm(t.get(v),r.get(v));S!==null&&y.set(v,S),o=o.add(v)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,y))}return R.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return M.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Im(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):R.resolve(mn()),u=di,h=o;return a.next(d=>R.forEach(d,(p,y)=>(u<y.largestBatchId&&(u=y.largestBatchId),o.get(p)?R.resolve():this.remoteDocumentCache.getEntry(e,p).next(v=>{h=h.insert(p,v)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,h,d,Q())).next(p=>({batchId:u,changes:bm(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new M(t)).next(r=>{let i=ai();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,a=ai();return this.indexManager.getCollectionParents(e,o).next(u=>R.forEach(u,h=>{let d=function(y,v){return new wn(v,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((y,v)=>{a=a.insert(y,v)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(a=>{o.forEach((h,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,nt.newInvalidDocument(p)))});let u=ai();return a.forEach((h,d)=>{let p=o.get(h);p!==void 0&&hi(p.mutation,d,Ye.empty(),Te.now()),Co(t,d)&&(u=u.insert(h,d))}),u})}};var du=class{constructor(e){this.serializer=e,this.Fr=new Map,this.Mr=new Map}getBundleMetadata(e,t){return R.resolve(this.Fr.get(t))}saveBundleMetadata(e,t){return this.Fr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:ut(i.createTime)}}(t)),R.resolve()}getNamedQuery(e,t){return R.resolve(this.Mr.get(t))}saveNamedQuery(e,t){return this.Mr.set(t.name,function(i){return{name:i.name,query:Ww(i.bundledQuery),readTime:ut(i.readTime)}}(t)),R.resolve()}};var fu=class{constructor(){this.overlays=new ue(M.comparator),this.Or=new Map}getOverlay(e,t){return R.resolve(this.overlays.get(t))}getOverlays(e,t){let r=mn();return R.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.St(e,t,o)}),R.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Or.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Or.delete(r)),R.resolve()}getOverlaysForCollection(e,t,r){let i=mn(),o=t.length+1,a=new M(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){let h=u.getNext().value,d=h.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>r&&i.set(h.getKey(),h)}return R.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new ue((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=o.get(d.largestBatchId);p===null&&(p=mn(),o=o.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let u=mn(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=i)););return R.resolve(u)}St(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.Or.get(i.largestBatchId).delete(r.key);this.Or.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Hc(t,r));let o=this.Or.get(t);o===void 0&&(o=Q(),this.Or.set(t,o)),this.Or.set(t,o.add(r.key))}};var pu=class{constructor(){this.sessionToken=De.EMPTY_BYTE_STRING}getSessionToken(e){return R.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,R.resolve()}};var vi=class{constructor(){this.Nr=new ve(fe.Br),this.Lr=new ve(fe.kr)}isEmpty(){return this.Nr.isEmpty()}addReference(e,t){let r=new fe(e,t);this.Nr=this.Nr.add(r),this.Lr=this.Lr.add(r)}qr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Qr(new fe(e,t))}$r(e,t){e.forEach(r=>this.removeReference(r,t))}Ur(e){let t=new M(new oe([])),r=new fe(t,e),i=new fe(t,e+1),o=[];return this.Lr.forEachInRange([r,i],a=>{this.Qr(a),o.push(a.key)}),o}Kr(){this.Nr.forEach(e=>this.Qr(e))}Qr(e){this.Nr=this.Nr.delete(e),this.Lr=this.Lr.delete(e)}Wr(e){let t=new M(new oe([])),r=new fe(t,e),i=new fe(t,e+1),o=Q();return this.Lr.forEachInRange([r,i],a=>{o=o.add(a.key)}),o}containsKey(e){let t=new fe(e,0),r=this.Nr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},fe=class{constructor(e,t){this.key=e,this.Gr=t}static Br(e,t){return M.comparator(e.key,t.key)||K(e.Gr,t.Gr)}static kr(e,t){return K(e.Gr,t.Gr)||M.comparator(e.key,t.key)}};var mu=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Jn=1,this.zr=new ve(fe.Br)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Jn;this.Jn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new Wc(o,t,r,i);this.mutationQueue.push(a);for(let u of i)this.zr=this.zr.add(new fe(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return R.resolve(a)}lookupMutationBatch(e,t){return R.resolve(this.jr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Hr(r),o=i<0?0:i;return R.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?cl:this.Jn-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new fe(t,0),i=new fe(t,Number.POSITIVE_INFINITY),o=[];return this.zr.forEachInRange([r,i],a=>{let u=this.jr(a.Gr);o.push(u)}),R.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ve(K);return t.forEach(i=>{let o=new fe(i,0),a=new fe(i,Number.POSITIVE_INFINITY);this.zr.forEachInRange([o,a],u=>{r=r.add(u.Gr)})}),R.resolve(this.Jr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;M.isDocumentKey(o)||(o=o.child(""));let a=new fe(new M(o),0),u=new ve(K);return this.zr.forEachWhile(h=>{let d=h.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(h.Gr)),!0)},a),R.resolve(this.Jr(u))}Jr(e){let t=[];return e.forEach(r=>{let i=this.jr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ee(this.Yr(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.zr;return R.forEach(t.mutations,i=>{let o=new fe(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.zr=r})}Xn(e){}containsKey(e,t){let r=new fe(t,0),i=this.zr.firstAfterOrEqual(r);return R.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}Yr(e,t){return this.Hr(e)}Hr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}jr(e){let t=this.Hr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var gu=class{constructor(e){this.Zr=e,this.docs=function(){return new ue(M.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.Zr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return R.resolve(r?r.document.mutableCopy():nt.newInvalidDocument(t))}getEntries(e,t){let r=Rt();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():nt.newInvalidDocument(i))}),R.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=Rt(),a=t.path,u=new M(a.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){let{key:d,value:{document:p}}=h.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||HI(KI(p),r)<=0||(i.has(p.key)||Co(t,p))&&(o=o.insert(p.key,p.mutableCopy()))}return R.resolve(o)}getAllFromCollectionGroup(e,t,r,i){L(9500)}Xr(e,t){return R.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new _u(this)}getSize(e){return R.resolve(this.size)}},_u=class extends uu{constructor(e){super(),this.vr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.vr.addEntry(e,i)):this.vr.removeEntry(r)}),R.waitFor(t)}getFromCache(e,t){return this.vr.getEntry(e,t)}getAllFromCache(e,t){return this.vr.getEntries(e,t)}};var yu=class{constructor(e){this.persistence=e,this.ei=new Ct(t=>fl(t),pl),this.lastRemoteSnapshotVersion=B.min(),this.highestTargetId=0,this.ti=0,this.ni=new vi,this.targetCount=0,this.ri=yi.rr()}forEachTarget(e,t){return this.ei.forEach((r,i)=>t(i)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.ti)}allocateTargetId(e){return this.highestTargetId=this.ri.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ti&&(this.ti=t),R.resolve()}ar(e){this.ei.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ri=new yi(t),this.highestTargetId=t),e.sequenceNumber>this.ti&&(this.ti=e.sequenceNumber)}addTargetData(e,t){return this.ar(t),this.targetCount+=1,R.resolve()}updateTargetData(e,t){return this.ar(t),R.resolve()}removeTargetData(e,t){return this.ei.delete(t.target),this.ni.Ur(t.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.ei.forEach((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.ei.delete(a),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),R.waitFor(o).next(()=>i)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,t){let r=this.ei.get(t)||null;return R.resolve(r)}addMatchingKeys(e,t,r){return this.ni.qr(t,r),R.resolve()}removeMatchingKeys(e,t,r){this.ni.$r(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),R.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.ni.Ur(t),R.resolve()}getMatchingKeysForTargetId(e,t){let r=this.ni.Wr(t);return R.resolve(r)}containsKey(e,t){return R.resolve(this.ni.containsKey(t))}};var io=class{constructor(e,t){this.ii={},this.overlays={},this.si=new al(0),this.oi=!1,this.oi=!0,this._i=new pu,this.referenceDelegate=e(this),this.ai=new yu(this),this.indexManager=new iu,this.remoteDocumentCache=function(i){return new gu(i)}(r=>this.referenceDelegate.ui(r)),this.serializer=new ru(t),this.ci=new du(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.oi=!1,Promise.resolve()}get started(){return this.oi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new fu,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ii[e.toKey()];return r||(r=new mu(t,this.referenceDelegate),this.ii[e.toKey()]=r),r}getGlobalsCache(){return this._i}getTargetCache(){return this.ai}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.ci}runTransaction(e,t,r){O("MemoryPersistence","Starting transaction:",e);let i=new vu(this.si.next());return this.referenceDelegate.li(),r(i).next(o=>this.referenceDelegate.hi(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Pi(e,t){return R.or(Object.values(this.ii).map(r=>()=>r.containsKey(e,t)))}},vu=class extends Cc{constructor(e){super(),this.currentSequenceNumber=e}},Iu=class n{constructor(e){this.persistence=e,this.Ti=new vi,this.Ii=null}static Ei(e){return new n(e)}get di(){if(this.Ii)return this.Ii;throw L(60996)}addReference(e,t,r){return this.Ti.addReference(r,t),this.di.delete(r.toString()),R.resolve()}removeReference(e,t,r){return this.Ti.removeReference(r,t),this.di.add(r.toString()),R.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),R.resolve()}removeTarget(e,t){this.Ti.Ur(t.targetId).forEach(i=>this.di.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.di.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}li(){this.Ii=new Set}hi(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.di,r=>{let i=M.fromPath(r);return this.Ai(e,i).next(o=>{o||t.removeEntry(i,B.min())})}).next(()=>(this.Ii=null,t.apply(e)))}updateLimboDocument(e,t){return this.Ai(e,t).next(r=>{r?this.di.delete(t.toString()):this.di.add(t.toString())})}ui(e){return 0}Ai(e,t){return R.or([()=>R.resolve(this.Ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Pi(e,t)])}},so=class n{constructor(e,t){this.persistence=e,this.Ri=new Ct(r=>XI(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=Hw(this,t)}static Ei(e,t){return new n(e,t)}li(){}hi(e){return R.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){let t=this.Vr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Vr(e){let t=0;return this.Ar(e,r=>{t++}).next(()=>t)}Ar(e,t){return R.forEach(this.Ri,(r,i)=>this.gr(e,r,i).next(o=>o?R.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.Xr(e,a=>this.gr(e,a,t).next(u=>{u||(r++,o.removeEntry(a,B.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.Ri.set(t,e.currentSequenceNumber),R.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.Ri.set(r,e.currentSequenceNumber),R.resolve()}removeReference(e,t,r){return this.Ri.set(r,e.currentSequenceNumber),R.resolve()}updateLimboDocument(e,t){return this.Ri.set(t,e.currentSequenceNumber),R.resolve()}ui(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Us(e.data.value)),t}gr(e,t,r){return R.or([()=>this.persistence.Pi(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.Ri.get(t);return R.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var wu=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.ls=r,this.hs=i}static Ps(e,t){let r=Q(),i=Q();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var Tu=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Eu=class{constructor(){this.Ts=!1,this.Is=!1,this.Es=100,this.ds=function(){return Zd()?8:YI(qe())>0?6:4}()}initialize(e,t){this.As=e,this.indexManager=t,this.Ts=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Rs(e,t).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.Vs(e,t,i,r).next(a=>{o.result=a})}).next(()=>{if(o.result)return;let a=new Tu;return this.fs(e,t,a).next(u=>{if(o.result=u,this.Is)return this.gs(e,t,a,u.size)})}).next(()=>o.result)}gs(e,t,r,i){return r.documentReadCount<this.Es?(Kn()<=H.DEBUG&&O("QueryEngine","SDK will not create cache indexes for query:",Hn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Es,"documents"),R.resolve()):(Kn()<=H.DEBUG&&O("QueryEngine","Query:",Hn(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ds*i?(Kn()<=H.DEBUG&&O("QueryEngine","The SDK decides to create cache indexes for query:",Hn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ct(t))):R.resolve())}Rs(e,t){if(dp(t))return R.resolve(null);let r=ct(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=zc(t,null,"F"),r=ct(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let a=Q(...o);return this.As.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(h=>{let d=this.ps(t,u);return this.ys(t,d,a,h.readTime)?this.Rs(e,zc(t,null,"F")):this.ws(e,d,t,h)}))})))}Vs(e,t,r,i){return dp(t)||i.isEqual(B.min())?R.resolve(null):this.As.getDocuments(e,r).next(o=>{let a=this.ps(t,o);return this.ys(t,a,r,i)?R.resolve(null):(Kn()<=H.DEBUG&&O("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Hn(t)),this.ws(e,a,t,WI(i,di)).next(u=>u))})}ps(e,t){let r=new ve(Tm(e));return t.forEach((i,o)=>{Co(e,o)&&(r=r.add(o))}),r}ys(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}fs(e,t,r){return Kn()<=H.DEBUG&&O("QueryEngine","Using full collection scan to execute query:",Hn(t)),this.As.getDocumentsMatchingQuery(e,t,In.min(),r)}ws(e,t,r,i){return this.As.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(a=>{o=o.insert(a.key,a)}),o))}};var yl="LocalStore",Qw=3e8,bu=class{constructor(e,t,r,i){this.persistence=e,this.bs=t,this.serializer=i,this.Ss=new ue(K),this.Ds=new Ct(o=>fl(o),pl),this.vs=new Map,this.Cs=e.getRemoteDocumentCache(),this.ai=e.getTargetCache(),this.ci=e.getBundleCache(),this.Fs(r)}Fs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new hu(this.Cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Cs.setIndexManager(this.indexManager),this.bs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ss))}};function Yw(n,e,t,r){return new bu(n,e,t,r)}function $m(n,e){return A(this,null,function*(){let t=U(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.Fs(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let a=[],u=[],h=Q();for(let d of i){a.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}for(let d of o){u.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(r,h).next(d=>({Ms:d,removedBatchIds:a,addedBatchIds:u}))})})})}function Jw(n,e){let t=U(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.Cs.newChangeBuffer({trackRemovals:!0});return function(u,h,d,p){let y=d.batch,v=y.keys(),S=R.resolve();return v.forEach(P=>{S=S.next(()=>p.getEntry(h,P)).next(x=>{let D=d.docVersions.get(P);ee(D!==null,48541),x.version.compareTo(D)<0&&(y.applyToRemoteDocument(x,d),x.isValidDocument()&&(x.setReadTime(d.commitVersion),p.addEntry(x)))})}),S.next(()=>u.mutationQueue.removeMutationBatch(h,y))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let h=Q();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(h=h.add(u.batch.mutations[d].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function zm(n){let e=U(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.ai.getLastRemoteSnapshotVersion(t))}function Xw(n,e){let t=U(n),r=e.snapshotVersion,i=t.Ss;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let a=t.Cs.newChangeBuffer({trackRemovals:!0});i=t.Ss;let u=[];e.targetChanges.forEach((p,y)=>{let v=i.get(y);if(!v)return;u.push(t.ai.removeMatchingKeys(o,p.removedDocuments,y).next(()=>t.ai.addMatchingKeys(o,p.addedDocuments,y)));let S=v.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(y)!==null?S=S.withResumeToken(De.EMPTY_BYTE_STRING,B.min()).withLastLimboFreeSnapshotVersion(B.min()):p.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(p.resumeToken,r)),i=i.insert(y,S),function(x,D,$){return x.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=Qw?!0:$.addedDocuments.size+$.modifiedDocuments.size+$.removedDocuments.size>0}(v,S,p)&&u.push(t.ai.updateTargetData(o,S))});let h=Rt(),d=Q();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(o,p))}),u.push(Zw(o,a,e.documentUpdates).next(p=>{h=p.xs,d=p.Os})),!r.isEqual(B.min())){let p=t.ai.getLastRemoteSnapshotVersion(o).next(y=>t.ai.setTargetsMetadata(o,o.currentSequenceNumber,r));u.push(p)}return R.waitFor(u).next(()=>a.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,h,d)).next(()=>h)}).then(o=>(t.Ss=i,o))}function Zw(n,e,t){let r=Q(),i=Q();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let a=Rt();return t.forEach((u,h)=>{let d=o.get(u);h.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual(B.min())?(e.removeEntry(u,h.readTime),a=a.insert(u,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),a=a.insert(u,h)):O(yl,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",h.version)}),{xs:a,Os:i}})}function eT(n,e){let t=U(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=cl),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function tT(n,e){let t=U(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.ai.getTargetData(r,e).next(o=>o?(i=o,R.resolve(i)):t.ai.allocateTargetId(r).next(a=>(i=new _i(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.ai.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Ss.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ss=t.Ss.insert(r.targetId,r),t.Ds.set(e,r.targetId)),r})}function Au(n,e,t){return A(this,null,function*(){let r=U(n),i=r.Ss.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!_r(a))throw a;O(yl,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ss=r.Ss.remove(e),r.Ds.delete(i.target)})}function Ap(n,e,t){let r=U(n),i=B.min(),o=Q();return r.persistence.runTransaction("Execute query","readwrite",a=>function(h,d,p){let y=U(h),v=y.Ds.get(p);return v!==void 0?R.resolve(y.Ss.get(v)):y.ai.getTargetData(d,p)}(r,a,ct(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.ai.getMatchingKeysForTargetId(a,u.targetId).next(h=>{o=h})}).next(()=>r.bs.getDocumentsMatchingQuery(a,e,t?i:B.min(),t?o:Q())).next(u=>(nT(r,mw(e),u),{documents:u,Ns:o})))}function nT(n,e,t){let r=n.vs.get(e)||B.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.vs.set(e,r)}var oo=class{constructor(){this.activeTargetIds=ww()}$s(e){this.activeTargetIds=this.activeTargetIds.add(e)}Us(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Qs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var ku=class{constructor(){this.So=new oo,this.Do={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.So.$s(e),this.Do[e]||"not-current"}updateQueryState(e,t,r){this.Do[e]=t}removeLocalQueryTarget(e){this.So.Us(e)}isLocalQueryTarget(e){return this.So.activeTargetIds.has(e)}clearQueryState(e){delete this.Do[e]}getAllActiveQueryTargets(){return this.So.activeTargetIds}isActiveQueryTarget(e){return this.So.activeTargetIds.has(e)}start(){return this.So=new oo,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Su=class{vo(e){}shutdown(){}};var kp="ConnectivityMonitor",ao=class{constructor(){this.Co=()=>this.Fo(),this.Mo=()=>this.xo(),this.Oo=[],this.No()}vo(e){this.Oo.push(e)}shutdown(){window.removeEventListener("online",this.Co),window.removeEventListener("offline",this.Mo)}No(){window.addEventListener("online",this.Co),window.addEventListener("offline",this.Mo)}Fo(){O(kp,"Network connectivity changed: AVAILABLE");for(let e of this.Oo)e(0)}xo(){O(kp,"Network connectivity changed: UNAVAILABLE");for(let e of this.Oo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Fs=null;function Cu(){return Fs===null?Fs=function(){return 268435456+Math.round(2147483648*Math.random())}():Fs++,"0x"+Fs.toString(16)}var _c="RestConnection",rT={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},Ru=class{get Bo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Lo=t+"://"+e.host,this.ko=`projects/${r}/databases/${i}`,this.qo=this.databaseId.database===Hs?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Qo(e,t,r,i,o){let a=Cu(),u=this.$o(e,t.toUriEncodedString());O(_c,`Sending RPC '${e}' ${a}:`,u,r);let h={"google-cloud-resource-prefix":this.ko,"x-goog-request-params":this.qo};this.Uo(h,i,o);let{host:d}=new URL(u),p=qn(d);return this.Ko(e,u,h,r,p).then(y=>(O(_c,`Received RPC '${e}' ${a}: `,y),y),y=>{throw er(_c,`RPC '${e}' ${a} failed with error: `,y,"url: ",u,"request:",r),y})}Wo(e,t,r,i,o,a){return this.Qo(e,t,r,i,o)}Uo(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+mr}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,o)=>e[o]=i),r&&r.headers.forEach((i,o)=>e[o]=i)}$o(e,t){let r=rT[e];return`${this.Lo}/v1/${t}:${r}`}terminate(){}};var Pu=class{constructor(e){this.Go=e.Go,this.zo=e.zo}jo(e){this.Ho=e}Jo(e){this.Yo=e}Zo(e){this.Xo=e}onMessage(e){this.e_=e}close(){this.zo()}send(e){this.Go(e)}t_(){this.Ho()}n_(){this.Yo()}r_(e){this.Xo(e)}i_(e){this.e_(e)}};var Pe="WebChannelConnection",Du=class extends Ru{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ko(e,t,r,i,o){let a=Cu();return new Promise((u,h)=>{let d=new hc;d.setWithCredentials(!0),d.listenOnce(dc.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case oi.NO_ERROR:let y=d.getResponseJson();O(Pe,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(y)),u(y);break;case oi.TIMEOUT:O(Pe,`RPC '${e}' ${a} timed out`),h(new V(C.DEADLINE_EXCEEDED,"Request time out"));break;case oi.HTTP_ERROR:let v=d.getStatus();if(O(Pe,`RPC '${e}' ${a} failed with status:`,v,"response text:",d.getResponseText()),v>0){let S=d.getResponseJson();Array.isArray(S)&&(S=S[0]);let P=S?.error;if(P&&P.status&&P.message){let x=function($){let F=$.toLowerCase().replace(/_/g,"-");return Object.values(C).indexOf(F)>=0?F:C.UNKNOWN}(P.status);h(new V(x,P.message))}else h(new V(C.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new V(C.UNAVAILABLE,"Connection failed."));break;default:L(9055,{s_:e,streamId:a,o_:d.getLastErrorCode(),__:d.getLastError()})}}finally{O(Pe,`RPC '${e}' ${a} completed.`)}});let p=JSON.stringify(i);O(Pe,`RPC '${e}' ${a} sending request:`,i),d.send(t,"POST",p,r,15)})}a_(e,t,r){let i=Cu(),o=[this.Lo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=mc(),u=pc(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.useFetchStreams=!0),this.Uo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;let p=o.join("");O(Pe,`Creating RPC '${e}' stream ${i}: ${p}`,h);let y=a.createWebChannel(p,h),v=!1,S=!1,P=new Pu({Go:D=>{S?O(Pe,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(v||(O(Pe,`Opening RPC '${e}' stream ${i} transport.`),y.open(),v=!0),O(Pe,`RPC '${e}' stream ${i} sending:`,D),y.send(D))},zo:()=>y.close()}),x=(D,$,F)=>{D.listen($,z=>{try{F(z)}catch(ne){setTimeout(()=>{throw ne},0)}})};return x(y,Wn.EventType.OPEN,()=>{S||(O(Pe,`RPC '${e}' stream ${i} transport opened.`),P.t_())}),x(y,Wn.EventType.CLOSE,()=>{S||(S=!0,O(Pe,`RPC '${e}' stream ${i} transport closed`),P.r_())}),x(y,Wn.EventType.ERROR,D=>{S||(S=!0,er(Pe,`RPC '${e}' stream ${i} transport errored. Name:`,D.name,"Message:",D.message),P.r_(new V(C.UNAVAILABLE,"The operation could not be completed")))}),x(y,Wn.EventType.MESSAGE,D=>{var $;if(!S){let F=D.data[0];ee(!!F,16349);let z=F,ne=z?.error||(($=z[0])===null||$===void 0?void 0:$.error);if(ne){O(Pe,`RPC '${e}' stream ${i} received error:`,ne);let Ne=ne.status,te=function(_){let I=de[_];if(I!==void 0)return xm(I)}(Ne),w=ne.message;te===void 0&&(te=C.INTERNAL,w="Unknown error status: "+Ne+" with message "+ne.message),S=!0,P.r_(new V(te,w)),y.close()}else O(Pe,`RPC '${e}' stream ${i} received:`,F),P.i_(F)}}),x(u,fc.STAT_EVENT,D=>{D.stat===Vs.PROXY?O(Pe,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===Vs.NOPROXY&&O(Pe,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{P.n_()},0),P}};function yc(){return typeof document<"u"?document:null}function Ro(n){return new Xc(n,!0)}var co=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.bi=e,this.timerId=t,this.u_=r,this.c_=i,this.l_=o,this.h_=0,this.P_=null,this.T_=Date.now(),this.reset()}reset(){this.h_=0}I_(){this.h_=this.l_}E_(e){this.cancel();let t=Math.floor(this.h_+this.d_()),r=Math.max(0,Date.now()-this.T_),i=Math.max(0,t-r);i>0&&O("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.h_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.P_=this.bi.enqueueAfterDelay(this.timerId,i,()=>(this.T_=Date.now(),e())),this.h_*=this.c_,this.h_<this.u_&&(this.h_=this.u_),this.h_>this.l_&&(this.h_=this.l_)}A_(){this.P_!==null&&(this.P_.skipDelay(),this.P_=null)}cancel(){this.P_!==null&&(this.P_.cancel(),this.P_=null)}d_(){return(Math.random()-.5)*this.h_}};var Sp="PersistentStream",uo=class{constructor(e,t,r,i,o,a,u,h){this.bi=e,this.R_=r,this.V_=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.m_=0,this.f_=null,this.g_=null,this.stream=null,this.p_=0,this.y_=new co(e,t)}w_(){return this.state===1||this.state===5||this.b_()}b_(){return this.state===2||this.state===3}start(){this.p_=0,this.state!==4?this.auth():this.S_()}stop(){return A(this,null,function*(){this.w_()&&(yield this.close(0))})}D_(){this.state=0,this.y_.reset()}v_(){this.b_()&&this.f_===null&&(this.f_=this.bi.enqueueAfterDelay(this.R_,6e4,()=>this.C_()))}F_(e){this.M_(),this.stream.send(e)}C_(){return A(this,null,function*(){if(this.b_())return this.close(0)})}M_(){this.f_&&(this.f_.cancel(),this.f_=null)}x_(){this.g_&&(this.g_.cancel(),this.g_=null)}close(e,t){return A(this,null,function*(){this.M_(),this.x_(),this.y_.cancel(),this.m_++,e!==4?this.y_.reset():t&&t.code===C.RESOURCE_EXHAUSTED?(At(t.toString()),At("Using maximum backoff delay to prevent overloading the backend."),this.y_.I_()):t&&t.code===C.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.O_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Zo(t)})}O_(){}auth(){this.state=1;let e=this.N_(this.m_),t=this.m_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.m_===t&&this.B_(r,i)},r=>{e(()=>{let i=new V(C.UNKNOWN,"Fetching auth token failed: "+r.message);return this.L_(i)})})}B_(e,t){let r=this.N_(this.m_);this.stream=this.k_(e,t),this.stream.jo(()=>{r(()=>this.listener.jo())}),this.stream.Jo(()=>{r(()=>(this.state=2,this.g_=this.bi.enqueueAfterDelay(this.V_,1e4,()=>(this.b_()&&(this.state=3),Promise.resolve())),this.listener.Jo()))}),this.stream.Zo(i=>{r(()=>this.L_(i))}),this.stream.onMessage(i=>{r(()=>++this.p_==1?this.q_(i):this.onNext(i))})}S_(){this.state=5,this.y_.E_(()=>A(this,null,function*(){this.state=0,this.start()}))}L_(e){return O(Sp,`close with error: ${e}`),this.stream=null,this.close(4,e)}N_(e){return t=>{this.bi.enqueueAndForget(()=>this.m_===e?t():(O(Sp,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Nu=class extends uo{constructor(e,t,r,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}k_(e,t){return this.connection.a_("Listen",e,t)}q_(e){return this.onNext(e)}onNext(e){this.y_.reset();let t=Vw(this.serializer,e),r=function(o){if(!("targetChange"in o))return B.min();let a=o.targetChange;return a.targetIds&&a.targetIds.length?B.min():a.readTime?ut(a.readTime):B.min()}(e);return this.listener.Q_(t,r)}U_(e){let t={};t.database=nu(this.serializer),t.addTarget=function(o,a){let u,h=a.target;if(u=qc(h)?{documents:Fw(o,h)}:{query:Uw(o,h).gt},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=Om(o,a.resumeToken);let d=Zc(o,a.expectedCount);d!==null&&(u.expectedCount=d)}else if(a.snapshotVersion.compareTo(B.min())>0){u.readTime=no(o,a.snapshotVersion.toTimestamp());let d=Zc(o,a.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);let r=qw(this.serializer,e);r&&(t.labels=r),this.F_(t)}K_(e){let t={};t.database=nu(this.serializer),t.removeTarget=e,this.F_(t)}},xu=class extends uo{constructor(e,t,r,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}get W_(){return this.p_>0}start(){this.lastStreamToken=void 0,super.start()}O_(){this.W_&&this.G_([])}k_(e,t){return this.connection.a_("Write",e,t)}q_(e){return ee(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ee(!e.writeResults||e.writeResults.length===0,55816),this.listener.z_()}onNext(e){ee(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.y_.reset();let t=Lw(e.writeResults,e.commitTime),r=ut(e.commitTime);return this.listener.j_(r,t)}H_(){let e={};e.database=nu(this.serializer),this.F_(e)}G_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Mw(this.serializer,r))};this.F_(t)}};var Ou=class{},Vu=class extends Ou{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.J_=!1}Y_(){if(this.J_)throw new V(C.FAILED_PRECONDITION,"The client has already been terminated.")}Qo(e,t,r,i){return this.Y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Qo(e,eu(t,r),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new V(C.UNKNOWN,o.toString())})}Wo(e,t,r,i,o){return this.Y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Wo(e,eu(t,r),i,a,u,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new V(C.UNKNOWN,a.toString())})}terminate(){this.J_=!0,this.connection.terminate()}},Mu=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.Z_=0,this.X_=null,this.ea=!0}ta(){this.Z_===0&&(this.na("Unknown"),this.X_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.X_=null,this.ra("Backend didn't respond within 10 seconds."),this.na("Offline"),Promise.resolve())))}ia(e){this.state==="Online"?this.na("Unknown"):(this.Z_++,this.Z_>=1&&(this.sa(),this.ra(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.na("Offline")))}set(e){this.sa(),this.Z_=0,e==="Online"&&(this.ea=!1),this.na(e)}na(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ra(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ea?(At(t),this.ea=!1):O("OnlineStateTracker",t)}sa(){this.X_!==null&&(this.X_.cancel(),this.X_=null)}};var An="RemoteStore",Lu=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.oa=[],this._a=new Map,this.aa=new Set,this.ua=[],this.ca=o,this.ca.vo(a=>{r.enqueueAndForget(()=>A(this,null,function*(){Sn(this)&&(O(An,"Restarting streams for network reachability change."),yield function(h){return A(this,null,function*(){let d=U(h);d.aa.add(4),yield Ai(d),d.la.set("Unknown"),d.aa.delete(4),yield Po(d)})}(this))}))}),this.la=new Mu(r,i)}};function Po(n){return A(this,null,function*(){if(Sn(n))for(let e of n.ua)yield e(!0)})}function Ai(n){return A(this,null,function*(){for(let e of n.ua)yield e(!1)})}function jm(n,e){let t=U(n);t._a.has(e.targetId)||(t._a.set(e.targetId,e),Tl(t)?wl(t):yr(t).b_()&&Il(t,e))}function vl(n,e){let t=U(n),r=yr(t);t._a.delete(e),r.b_()&&Gm(t,e),t._a.size===0&&(r.b_()?r.v_():Sn(t)&&t.la.set("Unknown"))}function Il(n,e){if(n.ha.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(B.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}yr(n).U_(e)}function Gm(n,e){n.ha.Ke(e),yr(n).K_(e)}function wl(n){n.ha=new Jc({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n._a.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),yr(n).start(),n.la.ta()}function Tl(n){return Sn(n)&&!yr(n).w_()&&n._a.size>0}function Sn(n){return U(n).aa.size===0}function Wm(n){n.ha=void 0}function iT(n){return A(this,null,function*(){n.la.set("Online")})}function sT(n){return A(this,null,function*(){n._a.forEach((e,t)=>{Il(n,e)})})}function oT(n,e){return A(this,null,function*(){Wm(n),Tl(n)?(n.la.ia(e),wl(n)):n.la.set("Unknown")})}function aT(n,e,t){return A(this,null,function*(){if(n.la.set("Online"),e instanceof eo&&e.state===2&&e.cause)try{yield function(i,o){return A(this,null,function*(){let a=o.cause;for(let u of o.targetIds)i._a.has(u)&&(yield i.remoteSyncer.rejectListen(u,a),i._a.delete(u),i.ha.removeTarget(u))})}(n,e)}catch(r){O(An,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield lo(n,r)}else if(e instanceof Xn?n.ha.Xe(e):e instanceof Zs?n.ha.ot(e):n.ha.nt(e),!t.isEqual(B.min()))try{let r=yield zm(n.localStore);t.compareTo(r)>=0&&(yield function(o,a){let u=o.ha.It(a);return u.targetChanges.forEach((h,d)=>{if(h.resumeToken.approximateByteSize()>0){let p=o._a.get(d);p&&o._a.set(d,p.withResumeToken(h.resumeToken,a))}}),u.targetMismatches.forEach((h,d)=>{let p=o._a.get(h);if(!p)return;o._a.set(h,p.withResumeToken(De.EMPTY_BYTE_STRING,p.snapshotVersion)),Gm(o,h);let y=new _i(p.target,h,d,p.sequenceNumber);Il(o,y)}),o.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(r){O(An,"Failed to raise snapshot:",r),yield lo(n,r)}})}function lo(n,e,t){return A(this,null,function*(){if(!_r(e))throw e;n.aa.add(1),yield Ai(n),n.la.set("Offline"),t||(t=()=>zm(n.localStore)),n.asyncQueue.enqueueRetryable(()=>A(this,null,function*(){O(An,"Retrying IndexedDB access"),yield t(),n.aa.delete(1),yield Po(n)}))})}function Km(n,e){return e().catch(t=>lo(n,t,e))}function Do(n){return A(this,null,function*(){let e=U(n),t=Qt(e),r=e.oa.length>0?e.oa[e.oa.length-1].batchId:cl;for(;cT(e);)try{let i=yield eT(e.localStore,r);if(i===null){e.oa.length===0&&t.v_();break}r=i.batchId,uT(e,i)}catch(i){yield lo(e,i)}Hm(e)&&Qm(e)})}function cT(n){return Sn(n)&&n.oa.length<10}function uT(n,e){n.oa.push(e);let t=Qt(n);t.b_()&&t.W_&&t.G_(e.mutations)}function Hm(n){return Sn(n)&&!Qt(n).w_()&&n.oa.length>0}function Qm(n){Qt(n).start()}function lT(n){return A(this,null,function*(){Qt(n).H_()})}function hT(n){return A(this,null,function*(){let e=Qt(n);for(let t of n.oa)e.G_(t.mutations)})}function dT(n,e,t){return A(this,null,function*(){let r=n.oa.shift(),i=Kc.from(r,e,t);yield Km(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Do(n)})}function fT(n,e){return A(this,null,function*(){e&&Qt(n).W_&&(yield function(r,i){return A(this,null,function*(){if(function(a){return Cw(a)&&a!==C.ABORTED}(i.code)){let o=r.oa.shift();Qt(r).D_(),yield Km(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield Do(r)}})}(n,e)),Hm(n)&&Qm(n)})}function Cp(n,e){return A(this,null,function*(){let t=U(n);t.asyncQueue.verifyOperationInProgress(),O(An,"RemoteStore received new credentials");let r=Sn(t);t.aa.add(3),yield Ai(t),r&&t.la.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.aa.delete(3),yield Po(t)})}function pT(n,e){return A(this,null,function*(){let t=U(n);e?(t.aa.delete(2),yield Po(t)):e||(t.aa.add(2),yield Ai(t),t.la.set("Unknown"))})}function yr(n){return n.Pa||(n.Pa=function(t,r,i){let o=U(t);return o.Y_(),new Nu(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{jo:iT.bind(null,n),Jo:sT.bind(null,n),Zo:oT.bind(null,n),Q_:aT.bind(null,n)}),n.ua.push(e=>A(this,null,function*(){e?(n.Pa.D_(),Tl(n)?wl(n):n.la.set("Unknown")):(yield n.Pa.stop(),Wm(n))}))),n.Pa}function Qt(n){return n.Ta||(n.Ta=function(t,r,i){let o=U(t);return o.Y_(),new xu(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{jo:()=>Promise.resolve(),Jo:lT.bind(null,n),Zo:fT.bind(null,n),z_:hT.bind(null,n),j_:dT.bind(null,n)}),n.ua.push(e=>A(this,null,function*(){e?(n.Ta.D_(),yield Do(n)):(yield n.Ta.stop(),n.oa.length>0&&(O(An,`Stopping write stream with ${n.oa.length} pending writes`),n.oa=[]))}))),n.Ta}var Fu=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new bt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let a=Date.now()+r,u=new n(e,t,a,i,o);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new V(C.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function El(n,e){if(At("AsyncQueue",`${e}: ${n}`),_r(n))return new V(C.UNAVAILABLE,`${e}: ${n}`);throw n}var ho=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||M.comparator(t.key,r.key):(t,r)=>M.comparator(t.key,r.key),this.keyedMap=ai(),this.sortedSet=new ue(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var fo=class{constructor(){this.Ia=new ue(M.comparator)}track(e){let t=e.doc.key,r=this.Ia.get(t);r?e.type!==0&&r.type===3?this.Ia=this.Ia.insert(t,e):e.type===3&&r.type!==1?this.Ia=this.Ia.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Ia=this.Ia.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Ia=this.Ia.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Ia=this.Ia.remove(t):e.type===1&&r.type===2?this.Ia=this.Ia.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Ia=this.Ia.insert(t,{type:2,doc:e.doc}):L(63341,{Vt:e,Ea:r}):this.Ia=this.Ia.insert(t,e)}da(){let e=[];return this.Ia.inorderTraversal((t,r)=>{e.push(r)}),e}},hr=class n{constructor(e,t,r,i,o,a,u,h,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,o){let a=[];return t.forEach(u=>{a.push({type:0,doc:u})}),new n(e,t,ho.emptySet(t),a,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&So(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Uu=class{constructor(){this.Aa=void 0,this.Ra=[]}Va(){return this.Ra.some(e=>e.ma())}},Bu=class{constructor(){this.queries=Rp(),this.onlineState="Unknown",this.fa=new Set}terminate(){(function(t,r){let i=U(t),o=i.queries;i.queries=Rp(),o.forEach((a,u)=>{for(let h of u.Ra)h.onError(r)})})(this,new V(C.ABORTED,"Firestore shutting down"))}};function Rp(){return new Ct(n=>wm(n),So)}function mT(n,e){return A(this,null,function*(){let t=U(n),r=3,i=e.query,o=t.queries.get(i);o?!o.Va()&&e.ma()&&(r=2):(o=new Uu,r=e.ma()?0:1);try{switch(r){case 0:o.Aa=yield t.onListen(i,!0);break;case 1:o.Aa=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let u=El(a,`Initialization of query '${Hn(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,o),o.Ra.push(e),e.ga(t.onlineState),o.Aa&&e.pa(o.Aa)&&bl(t)})}function gT(n,e){return A(this,null,function*(){let t=U(n),r=e.query,i=3,o=t.queries.get(r);if(o){let a=o.Ra.indexOf(e);a>=0&&(o.Ra.splice(a,1),o.Ra.length===0?i=e.ma()?0:1:!o.Va()&&e.ma()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function _T(n,e){let t=U(n),r=!1;for(let i of e){let o=i.query,a=t.queries.get(o);if(a){for(let u of a.Ra)u.pa(i)&&(r=!0);a.Aa=i}}r&&bl(t)}function yT(n,e,t){let r=U(n),i=r.queries.get(e);if(i)for(let o of i.Ra)o.onError(t);r.queries.delete(e)}function bl(n){n.fa.forEach(e=>{e.next()})}var qu,Pp;(Pp=qu||(qu={})).ya="default",Pp.Cache="cache";var $u=class{constructor(e,t,r){this.query=e,this.wa=t,this.ba=!1,this.Sa=null,this.onlineState="Unknown",this.options=r||{}}pa(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new hr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ba?this.Da(e)&&(this.wa.next(e),t=!0):this.va(e,this.onlineState)&&(this.Ca(e),t=!0),this.Sa=e,t}onError(e){this.wa.error(e)}ga(e){this.onlineState=e;let t=!1;return this.Sa&&!this.ba&&this.va(this.Sa,e)&&(this.Ca(this.Sa),t=!0),t}va(e,t){if(!e.fromCache||!this.ma())return!0;let r=t!=="Offline";return(!this.options.Fa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Da(e){if(e.docChanges.length>0)return!0;let t=this.Sa&&this.Sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Ca(e){e=hr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ba=!0,this.wa.next(e)}ma(){return this.options.source!==qu.Cache}};var po=class{constructor(e){this.key=e}},mo=class{constructor(e){this.key=e}},zu=class{constructor(e,t){this.query=e,this.qa=t,this.Qa=null,this.hasCachedResults=!1,this.current=!1,this.$a=Q(),this.mutatedKeys=Q(),this.Ua=Tm(e),this.Ka=new ho(this.Ua)}get Wa(){return this.qa}Ga(e,t){let r=t?t.za:new fo,i=t?t.Ka:this.Ka,o=t?t.mutatedKeys:this.mutatedKeys,a=i,u=!1,h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,y)=>{let v=i.get(p),S=Co(this.query,y)?y:null,P=!!v&&this.mutatedKeys.has(v.key),x=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations),D=!1;v&&S?v.data.isEqual(S.data)?P!==x&&(r.track({type:3,doc:S}),D=!0):this.ja(v,S)||(r.track({type:2,doc:S}),D=!0,(h&&this.Ua(S,h)>0||d&&this.Ua(S,d)<0)&&(u=!0)):!v&&S?(r.track({type:0,doc:S}),D=!0):v&&!S&&(r.track({type:1,doc:v}),D=!0,(h||d)&&(u=!0)),D&&(S?(a=a.add(S),o=x?o.add(p):o.delete(p)):(a=a.delete(p),o=o.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),o=o.delete(p.key),r.track({type:1,doc:p})}return{Ka:a,za:r,ys:u,mutatedKeys:o}}ja(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.Ka;this.Ka=e.Ka,this.mutatedKeys=e.mutatedKeys;let a=e.za.da();a.sort((p,y)=>function(S,P){let x=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return L(20277,{Vt:D})}};return x(S)-x(P)}(p.type,y.type)||this.Ua(p.doc,y.doc)),this.Ha(r),i=i!=null&&i;let u=t&&!i?this.Ja():[],h=this.$a.size===0&&this.current&&!i?1:0,d=h!==this.Qa;return this.Qa=h,a.length!==0||d?{snapshot:new hr(this.query,e.Ka,o,a,e.mutatedKeys,h===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ya:u}:{Ya:u}}ga(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ka:this.Ka,za:new fo,mutatedKeys:this.mutatedKeys,ys:!1},!1)):{Ya:[]}}Za(e){return!this.qa.has(e)&&!!this.Ka.has(e)&&!this.Ka.get(e).hasLocalMutations}Ha(e){e&&(e.addedDocuments.forEach(t=>this.qa=this.qa.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.qa=this.qa.delete(t)),this.current=e.current)}Ja(){if(!this.current)return[];let e=this.$a;this.$a=Q(),this.Ka.forEach(r=>{this.Za(r.key)&&(this.$a=this.$a.add(r.key))});let t=[];return e.forEach(r=>{this.$a.has(r)||t.push(new mo(r))}),this.$a.forEach(r=>{e.has(r)||t.push(new po(r))}),t}Xa(e){this.qa=e.Ns,this.$a=Q();let t=this.Ga(e.documents);return this.applyChanges(t,!0)}eu(){return hr.fromInitialDocuments(this.query,this.Ka,this.mutatedKeys,this.Qa===0,this.hasCachedResults)}},Al="SyncEngine",ju=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Gu=class{constructor(e){this.key=e,this.tu=!1}},Wu=class{constructor(e,t,r,i,o,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.nu={},this.ru=new Ct(u=>wm(u),So),this.iu=new Map,this.su=new Set,this.ou=new ue(M.comparator),this._u=new Map,this.au=new vi,this.uu={},this.cu=new Map,this.lu=yi.ir(),this.onlineState="Unknown",this.hu=void 0}get isPrimaryClient(){return this.hu===!0}};function vT(n,e,t=!0){return A(this,null,function*(){let r=tg(n),i,o=r.ru.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.eu()):i=yield Ym(r,e,t,!0),i})}function IT(n,e){return A(this,null,function*(){let t=tg(n);yield Ym(t,e,!0,!1)})}function Ym(n,e,t,r){return A(this,null,function*(){let i=yield tT(n.localStore,ct(e)),o=i.targetId,a=n.sharedClientState.addLocalQueryTarget(o,t),u;return r&&(u=yield wT(n,e,o,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&jm(n.remoteStore,i),u})}function wT(n,e,t,r,i){return A(this,null,function*(){n.Pu=(y,v,S)=>function(x,D,$,F){return A(this,null,function*(){let z=D.view.Ga($);z.ys&&(z=yield Ap(x.localStore,D.query,!1).then(({documents:w})=>D.view.Ga(w,z)));let ne=F&&F.targetChanges.get(D.targetId),Ne=F&&F.targetMismatches.get(D.targetId)!=null,te=D.view.applyChanges(z,x.isPrimaryClient,ne,Ne);return Np(x,D.targetId,te.Ya),te.snapshot})}(n,y,v,S);let o=yield Ap(n.localStore,e,!0),a=new zu(e,o.Ns),u=a.Ga(o.documents),h=gi.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=a.applyChanges(u,n.isPrimaryClient,h);Np(n,t,d.Ya);let p=new ju(e,t,a);return n.ru.set(e,p),n.iu.has(t)?n.iu.get(t).push(e):n.iu.set(t,[e]),d.snapshot})}function TT(n,e,t){return A(this,null,function*(){let r=U(n),i=r.ru.get(e),o=r.iu.get(i.targetId);if(o.length>1)return r.iu.set(i.targetId,o.filter(a=>!So(a,e))),void r.ru.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Au(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&vl(r.remoteStore,i.targetId),Ku(r,i.targetId)}).catch(gr))):(Ku(r,i.targetId),yield Au(r.localStore,i.targetId,!0))})}function ET(n,e){return A(this,null,function*(){let t=U(n),r=t.ru.get(e),i=t.iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),vl(t.remoteStore,r.targetId))})}function bT(n,e,t){return A(this,null,function*(){let r=DT(n);try{let i=yield function(a,u){let h=U(a),d=Te.now(),p=u.reduce((S,P)=>S.add(P.key),Q()),y,v;return h.persistence.runTransaction("Locally write mutations","readwrite",S=>{let P=Rt(),x=Q();return h.Cs.getEntries(S,p).next(D=>{P=D,P.forEach(($,F)=>{F.isValidDocument()||(x=x.add($))})}).next(()=>h.localDocuments.getOverlayedDocuments(S,P)).next(D=>{y=D;let $=[];for(let F of u){let z=Sw(F,y.get(F.key).overlayedDocument);z!=null&&$.push(new ht(F.key,z,pm(z.value.mapValue),Wt.exists(!0)))}return h.mutationQueue.addMutationBatch(S,d,$,u)}).next(D=>{v=D;let $=D.applyToLocalDocumentSet(y,x);return h.documentOverlayCache.saveOverlays(S,D.batchId,$)})}).then(()=>({batchId:v.batchId,changes:bm(y)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,u,h){let d=a.uu[a.currentUser.toKey()];d||(d=new ue(K)),d=d.insert(u,h),a.uu[a.currentUser.toKey()]=d}(r,i.batchId,t),yield ki(r,i.changes),yield Do(r.remoteStore)}catch(i){let o=El(i,"Failed to persist write");t.reject(o)}})}function Jm(n,e){return A(this,null,function*(){let t=U(n);try{let r=yield Xw(t.localStore,e);e.targetChanges.forEach((i,o)=>{let a=t._u.get(o);a&&(ee(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.tu=!0:i.modifiedDocuments.size>0?ee(a.tu,14607):i.removedDocuments.size>0&&(ee(a.tu,42227),a.tu=!1))}),yield ki(t,r,e)}catch(r){yield gr(r)}})}function Dp(n,e,t){let r=U(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.ru.forEach((o,a)=>{let u=a.view.ga(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){let h=U(a);h.onlineState=u;let d=!1;h.queries.forEach((p,y)=>{for(let v of y.Ra)v.ga(u)&&(d=!0)}),d&&bl(h)}(r.eventManager,e),i.length&&r.nu.Q_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function AT(n,e,t){return A(this,null,function*(){let r=U(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r._u.get(e),o=i&&i.key;if(o){let a=new ue(M.comparator);a=a.insert(o,nt.newNoDocument(o,B.min()));let u=Q().add(o),h=new Xs(B.min(),new Map,new ue(K),a,u);yield Jm(r,h),r.ou=r.ou.remove(o),r._u.delete(e),kl(r)}else yield Au(r.localStore,e,!1).then(()=>Ku(r,e,t)).catch(gr)})}function kT(n,e){return A(this,null,function*(){let t=U(n),r=e.batch.batchId;try{let i=yield Jw(t.localStore,e);Zm(t,r,null),Xm(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield ki(t,i)}catch(i){yield gr(i)}})}function ST(n,e,t){return A(this,null,function*(){let r=U(n);try{let i=yield function(a,u){let h=U(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return h.mutationQueue.lookupMutationBatch(d,u).next(y=>(ee(y!==null,37113),p=y.keys(),h.mutationQueue.removeMutationBatch(d,y))).next(()=>h.mutationQueue.performConsistencyCheck(d)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(d,p,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>h.localDocuments.getDocuments(d,p))})}(r.localStore,e);Zm(r,e,t),Xm(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield ki(r,i)}catch(i){yield gr(i)}})}function Xm(n,e){(n.cu.get(e)||[]).forEach(t=>{t.resolve()}),n.cu.delete(e)}function Zm(n,e,t){let r=U(n),i=r.uu[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.uu[r.currentUser.toKey()]=i}}function Ku(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.iu.get(e))n.ru.delete(r),t&&n.nu.Tu(r,t);n.iu.delete(e),n.isPrimaryClient&&n.au.Ur(e).forEach(r=>{n.au.containsKey(r)||eg(n,r)})}function eg(n,e){n.su.delete(e.path.canonicalString());let t=n.ou.get(e);t!==null&&(vl(n.remoteStore,t),n.ou=n.ou.remove(e),n._u.delete(t),kl(n))}function Np(n,e,t){for(let r of t)r instanceof po?(n.au.addReference(r.key,e),CT(n,r)):r instanceof mo?(O(Al,"Document no longer in limbo: "+r.key),n.au.removeReference(r.key,e),n.au.containsKey(r.key)||eg(n,r.key)):L(19791,{Iu:r})}function CT(n,e){let t=e.key,r=t.path.canonicalString();n.ou.get(t)||n.su.has(r)||(O(Al,"New document in limbo: "+t),n.su.add(r),kl(n))}function kl(n){for(;n.su.size>0&&n.ou.size<n.maxConcurrentLimboResolutions;){let e=n.su.values().next().value;n.su.delete(e);let t=new M(oe.fromString(e)),r=n.lu.next();n._u.set(r,new Gu(t)),n.ou=n.ou.insert(t,r),jm(n.remoteStore,new _i(ct(ml(t.path)),r,"TargetPurposeLimboResolution",al.le))}}function ki(n,e,t){return A(this,null,function*(){let r=U(n),i=[],o=[],a=[];r.ru.isEmpty()||(r.ru.forEach((u,h)=>{a.push(r.Pu(h,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){let y=d?!d.fromCache:(p=t?.targetChanges.get(h.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(h.targetId,y?"current":"not-current")}if(d){i.push(d);let y=wu.Ps(h.targetId,d);o.push(y)}}))}),yield Promise.all(a),r.nu.Q_(i),yield function(h,d){return A(this,null,function*(){let p=U(h);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>R.forEach(d,v=>R.forEach(v.ls,S=>p.persistence.referenceDelegate.addReference(y,v.targetId,S)).next(()=>R.forEach(v.hs,S=>p.persistence.referenceDelegate.removeReference(y,v.targetId,S)))))}catch(y){if(!_r(y))throw y;O(yl,"Failed to update sequence numbers: "+y)}for(let y of d){let v=y.targetId;if(!y.fromCache){let S=p.Ss.get(v),P=S.snapshotVersion,x=S.withLastLimboFreeSnapshotVersion(P);p.Ss=p.Ss.insert(v,x)}}})}(r.localStore,o))})}function RT(n,e){return A(this,null,function*(){let t=U(n);if(!t.currentUser.isEqual(e)){O(Al,"User change. New user:",e.toKey());let r=yield $m(t.localStore,e);t.currentUser=e,function(o,a){o.cu.forEach(u=>{u.forEach(h=>{h.reject(new V(C.CANCELLED,a))})}),o.cu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ki(t,r.Ms)}})}function PT(n,e){let t=U(n),r=t._u.get(e);if(r&&r.tu)return Q().add(r.key);{let i=Q(),o=t.iu.get(e);if(!o)return i;for(let a of o){let u=t.ru.get(a);i=i.unionWith(u.view.Wa)}return i}}function tg(n){let e=U(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Jm.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=PT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=AT.bind(null,e),e.nu.Q_=_T.bind(null,e.eventManager),e.nu.Tu=yT.bind(null,e.eventManager),e}function DT(n){let e=U(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=kT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ST.bind(null,e),e}var ng=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return A(this,null,function*(){this.serializer=Ro(t.databaseInfo.databaseId),this.sharedClientState=this.Au(t),this.persistence=this.Ru(t),yield this.persistence.start(),this.localStore=this.Vu(t),this.gcScheduler=this.mu(t,this.localStore),this.indexBackfillerScheduler=this.fu(t,this.localStore)})}mu(t,r){return null}fu(t,r){return null}Vu(t){return Yw(this.persistence,new Eu,t.initialUser,this.serializer)}Ru(t){return new io(Iu.Ei,this.serializer)}Au(t){return new ku}terminate(){return A(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),Hu=class extends ng{constructor(e){super(),this.cacheSizeBytes=e}mu(e,t){ee(this.persistence.referenceDelegate instanceof so,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new au(r,e.asyncQueue,t)}Ru(e){let t=this.cacheSizeBytes!==void 0?Qe.withCacheSize(this.cacheSizeBytes):Qe.DEFAULT;return new io(r=>so.Ei(r,t),this.serializer)}};var NT=(()=>{class n{initialize(t,r){return A(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Dp(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=RT.bind(null,this.syncEngine),yield pT(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new Bu}()}createDatastore(t){let r=Ro(t.databaseInfo.databaseId),i=function(a){return new Du(a)}(t.databaseInfo);return function(a,u,h,d){return new Vu(a,u,h,d)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,o,a,u,h){return new Lu(i,o,a,u,h)}(this.localStore,this.datastore,t.asyncQueue,r=>Dp(this.syncEngine,r,0),function(){return ao.C()?new ao:new Su}())}createSyncEngine(t,r){return function(o,a,u,h,d,p,y){let v=new Wu(o,a,u,h,d,p);return y&&(v.hu=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return A(this,null,function*(){var t,r;yield function(o){return A(this,null,function*(){let a=U(o);O(An,"RemoteStore shutting down."),a.aa.add(5),yield Ai(a),a.ca.shutdown(),a.la.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var Qu=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.pu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.pu(this.observer.error,e):At("Uncaught Error in snapshot listener:",e.toString()))}yu(){this.muted=!0}pu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Yt="FirestoreClient",Yu=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=ye.UNAUTHENTICATED,this.clientId=js.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,a=>A(this,null,function*(){O(Yt,"Received user=",a.uid),yield this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,a=>(O(Yt,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new bt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>A(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=El(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function vc(n,e){return A(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),O(Yt,"Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>A(this,null,function*(){r.isEqual(i)||(yield $m(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function xp(n,e){return A(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield xT(n);O(Yt,"Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Cp(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Cp(e.remoteStore,i)),n._onlineComponents=e})}function xT(n){return A(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){O(Yt,"Using user provided OfflineComponentProvider");try{yield vc(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===C.FAILED_PRECONDITION||i.code===C.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;er("Error using user provided cache. Falling back to memory cache: "+t),yield vc(n,new ng)}}else O(Yt,"Using default OfflineComponentProvider"),yield vc(n,new Hu(void 0));return n._offlineComponents})}function rg(n){return A(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(O(Yt,"Using user provided OnlineComponentProvider"),yield xp(n,n._uninitializedComponentsProvider._online)):(O(Yt,"Using default OnlineComponentProvider"),yield xp(n,new NT))),n._onlineComponents})}function OT(n){return rg(n).then(e=>e.syncEngine)}function Op(n){return A(this,null,function*(){let e=yield rg(n),t=e.eventManager;return t.onListen=vT.bind(null,e.syncEngine),t.onUnlisten=TT.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=IT.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=ET.bind(null,e.syncEngine),t})}function ig(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Vp=new Map;function sg(n,e,t){if(!t)throw new V(C.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function VT(n,e,t,r){if(e===!0&&r===!0)throw new V(C.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Mp(n){if(!M.isDocumentKey(n))throw new V(C.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Lp(n){if(M.isDocumentKey(n))throw new V(C.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function No(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":L(12329,{type:typeof n})}function yn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new V(C.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=No(n);throw new V(C.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var og="firestore.googleapis.com",Fp=!0,go=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new V(C.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=og,this.ssl=Fp}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:Fp;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=qm;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Kw)throw new V(C.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}VT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ig((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new V(C.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new V(C.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new V(C.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},dr=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new go({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new V(C.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new V(C.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new go(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Ic;switch(r.type){case"firstParty":return new bc(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new V(C.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,fs("Firestore",this._settings.isUsingEmulator),this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return A(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=Vp.get(t);r&&(O("ComponentProvider","Removing Datastore"),Vp.delete(t),r.terminate())}(this),Promise.resolve()}};function ag(n,e,t,r={}){var i;n=yn(n,dr);let o=qn(e),a=n._getSettings(),u=Object.assign(Object.assign({},a),{emulatorOptions:n._getEmulatorOptions()}),h=`${e}:${t}`;a.host!==og&&a.host!==h&&er("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let d=Object.assign(Object.assign({},a),{host:h,ssl:o,emulatorOptions:r});if(!on(d,u)&&(n._setSettings(d),o&&(Aa(`https://${h}`),fs("Firestore",!0)),r.mockUserToken)){let p,y;if(typeof r.mockUserToken=="string")p=r.mockUserToken,y=ye.MOCK_USER;else{p=Hd(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let v=r.mockUserToken.sub||r.mockUserToken.user_id;if(!v)throw new V(C.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new ye(v)}n._authCredentials=new wc(new $s(p,y))}}var fr=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Le=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Kt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Kt=class n extends fr{constructor(e,t,r){super(e,t,ml(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Le(this.firestore,null,new M(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function cg(n,e,...t){if(n=we(n),sg("collection","path",e),n instanceof dr){let r=oe.fromString(e,...t);return Lp(r),new Kt(n,null,r)}{if(!(n instanceof Le||n instanceof Kt))throw new V(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(oe.fromString(e,...t));return Lp(r),new Kt(n.firestore,null,r)}}function Sl(n,e,...t){if(n=we(n),arguments.length===1&&(e=js.newId()),sg("doc","path",e),n instanceof dr){let r=oe.fromString(e,...t);return Mp(r),new Le(n,null,new M(r))}{if(!(n instanceof Le||n instanceof Kt))throw new V(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(oe.fromString(e,...t));return Mp(r),new Le(n.firestore,n instanceof Kt?n.converter:null,new M(r))}}var Up="AsyncQueue",_o=class{constructor(e=Promise.resolve()){this.Qu=[],this.$u=!1,this.Uu=[],this.Ku=null,this.Wu=!1,this.Gu=!1,this.zu=[],this.y_=new co(this,"async_queue_retry"),this.ju=()=>{let r=yc();r&&O(Up,"Visibility state changed to "+r.visibilityState),this.y_.A_()},this.Hu=e;let t=yc();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.ju)}get isShuttingDown(){return this.$u}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Ju(),this.Yu(e)}enterRestrictedMode(e){if(!this.$u){this.$u=!0,this.Gu=e||!1;let t=yc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.ju)}}enqueue(e){if(this.Ju(),this.$u)return new Promise(()=>{});let t=new bt;return this.Yu(()=>this.$u&&this.Gu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qu.push(e),this.Zu()))}Zu(){return A(this,null,function*(){if(this.Qu.length!==0){try{yield this.Qu[0](),this.Qu.shift(),this.y_.reset()}catch(e){if(!_r(e))throw e;O(Up,"Operation failed with retryable error: "+e)}this.Qu.length>0&&this.y_.E_(()=>this.Zu())}})}Yu(e){let t=this.Hu.then(()=>(this.Wu=!0,e().catch(r=>{throw this.Ku=r,this.Wu=!1,At("INTERNAL UNHANDLED ERROR: ",Bp(r)),r}).then(r=>(this.Wu=!1,r))));return this.Hu=t,t}enqueueAfterDelay(e,t,r){this.Ju(),this.zu.indexOf(e)>-1&&(t=0);let i=Fu.createAndSchedule(this,e,t,r,o=>this.Xu(o));return this.Uu.push(i),i}Ju(){this.Ku&&L(47125,{ec:Bp(this.Ku)})}verifyOperationInProgress(){}tc(){return A(this,null,function*(){let e;do e=this.Hu,yield e;while(e!==this.Hu)})}nc(e){for(let t of this.Uu)if(t.timerId===e)return!0;return!1}rc(e){return this.tc().then(()=>{this.Uu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Uu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.tc()})}sc(e){this.zu.push(e)}Xu(e){let t=this.Uu.indexOf(e);this.Uu.splice(t,1)}};function Bp(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function qp(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var kn=class extends dr{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new _o,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return A(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new _o(e),this._firestoreClient=void 0,yield e}})}};function ug(n,e){let t=typeof n=="object"?n:zn(),r=typeof n=="string"?n:e||Hs,i=gs(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=Wd("firestore");o&&ag(i,...o)}return i}function lg(n){if(n._terminated)throw new V(C.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||MT(n),n._firestoreClient}function MT(n){var e,t,r;let i=n._freezeSettings(),o=function(u,h,d,p){return new Rc(u,h,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,ig(p.experimentalLongPollingOptions),p.useFetchStreams,p.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new Yu(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(u){let h=u?._online.build();return{_offline:u?._offline.build(h),_online:h}}(n._componentsProvider))}var Ii=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(De.fromBase64String(e))}catch(t){throw new V(C.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(De.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var pr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new V(C.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ze(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var wi=class{constructor(e){this._methodName=e}};var Ti=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new V(C.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new V(C.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return K(this._lat,e._lat)||K(this._long,e._long)}};var Ei=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var LT=/^__.*__$/,Ju=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ht(e,this.data,this.fieldMask,t,this.fieldTransforms):new bn(e,this.data,t,this.fieldTransforms)}},yo=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new ht(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function hg(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw L(40011,{oc:n})}}var Xu=class n{constructor(e,t,r,i,o,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this._c(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get oc(){return this.settings.oc}ac(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}uc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ac({path:r,cc:!1});return i.lc(e),i}hc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ac({path:r,cc:!1});return i._c(),i}Pc(e){return this.ac({path:void 0,cc:!0})}Tc(e){return Io(e,this.settings.methodName,this.settings.Ic||!1,this.path,this.settings.Ec)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}_c(){if(this.path)for(let e=0;e<this.path.length;e++)this.lc(this.path.get(e))}lc(e){if(e.length===0)throw this.Tc("Document fields must not be empty");if(hg(this.oc)&&LT.test(e))throw this.Tc('Document fields cannot begin and end with "__"')}},Zu=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Ro(e)}dc(e,t,r,i=!1){return new Xu({oc:e,methodName:t,Ec:r,path:ze.emptyPath(),cc:!1,Ic:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Cl(n){let e=n._freezeSettings(),t=Ro(n._databaseId);return new Zu(n._databaseId,!!e.ignoreUndefinedProperties,t)}function FT(n,e,t,r,i,o={}){let a=n.dc(o.merge||o.mergeFields?2:0,e,t,i);Rl("Data must be an object, but it was:",a,r);let u=dg(r,a),h,d;if(o.merge)h=new Ye(a.fieldMask),d=a.fieldTransforms;else if(o.mergeFields){let p=[];for(let y of o.mergeFields){let v=el(e,y,t);if(!a.contains(v))throw new V(C.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);pg(p,v)||p.push(v)}h=new Ye(p),d=a.fieldTransforms.filter(y=>h.covers(y.field))}else h=null,d=a.fieldTransforms;return new Ju(new $e(u),h,d)}var vo=class n extends wi{_toFieldTransform(e){if(e.oc!==2)throw e.oc===1?e.Tc(`${this._methodName}() can only appear at the top level of your update data`):e.Tc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function UT(n,e,t,r){let i=n.dc(1,e,t);Rl("Data must be an object, but it was:",i,r);let o=[],a=$e.empty();Jt(r,(h,d)=>{let p=Pl(e,h,t);d=we(d);let y=i.hc(p);if(d instanceof vo)o.push(p);else{let v=Si(d,y);v!=null&&(o.push(p),a.set(p,v))}});let u=new Ye(o);return new yo(a,u,i.fieldTransforms)}function BT(n,e,t,r,i,o){let a=n.dc(1,e,t),u=[el(e,r,t)],h=[i];if(o.length%2!=0)throw new V(C.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let v=0;v<o.length;v+=2)u.push(el(e,o[v])),h.push(o[v+1]);let d=[],p=$e.empty();for(let v=u.length-1;v>=0;--v)if(!pg(d,u[v])){let S=u[v],P=h[v];P=we(P);let x=a.hc(S);if(P instanceof vo)d.push(S);else{let D=Si(P,x);D!=null&&(d.push(S),p.set(S,D))}}let y=new Ye(d);return new yo(p,y,a.fieldTransforms)}function qT(n,e,t,r=!1){return Si(t,n.dc(r?4:3,e))}function Si(n,e){if(fg(n=we(n)))return Rl("Unsupported field value:",e,n),dg(n,e);if(n instanceof wi)return function(r,i){if(!hg(i.oc))throw i.Tc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Tc(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.cc&&e.oc!==4)throw e.Tc("Nested arrays are not supported");return function(r,i){let o=[],a=0;for(let u of r){let h=Si(u,i.Pc(a));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),a++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=we(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Tw(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=Te.fromDate(r);return{timestampValue:no(i.serializer,o)}}if(r instanceof Te){let o=new Te(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:no(i.serializer,o)}}if(r instanceof Ti)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ii)return{bytesValue:Om(i.serializer,r._byteString)};if(r instanceof Le){let o=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw i.Tc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:_l(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Ei)return function(a,u){return{mapValue:{fields:{[ll]:{stringValue:hl},[nr]:{arrayValue:{values:a.toArray().map(d=>{if(typeof d!="number")throw u.Tc("VectorValues must only contain numeric values.");return gl(u.serializer,d)})}}}}}}(r,i);throw i.Tc(`Unsupported field value: ${No(r)}`)}(n,e)}function dg(n,e){let t={};return om(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Jt(n,(r,i)=>{let o=Si(i,e.uc(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function fg(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Te||n instanceof Ti||n instanceof Ii||n instanceof Le||n instanceof wi||n instanceof Ei)}function Rl(n,e,t){if(!fg(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=No(t);throw r==="an object"?e.Tc(n+" a custom object"):e.Tc(n+" "+r)}}function el(n,e,t){if((e=we(e))instanceof pr)return e._internalPath;if(typeof e=="string")return Pl(n,e);throw Io("Field path arguments must be of type string or ",n,!1,void 0,t)}var $T=new RegExp("[~\\*/\\[\\]]");function Pl(n,e,t){if(e.search($T)>=0)throw Io(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new pr(...e.split("."))._internalPath}catch{throw Io(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Io(n,e,t,r,i){let o=r&&!r.isEmpty(),a=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||a)&&(h+=" (found",o&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new V(C.INVALID_ARGUMENT,u+n+h)}function pg(n,e){return n.some(t=>t.isEqual(e))}var wo=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Le(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new tl(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Dl("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},tl=class extends wo{data(){return super.data()}};function Dl(n,e){return typeof e=="string"?Pl(n,e):e instanceof pr?e._internalPath:e._delegate._internalPath}function zT(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new V(C.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var bi=class{},nl=class extends bi{};function mg(n,e,...t){let r=[];e instanceof bi&&r.push(e),r=r.concat(t),function(o){let a=o.filter(h=>h instanceof rl).length,u=o.filter(h=>h instanceof To).length;if(a>1||a>0&&u>0)throw new V(C.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var To=class n extends nl{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return _g(e._query,t),new fr(e.firestore,e.converter,$c(e._query,t))}_parse(e){let t=Cl(e.firestore);return function(o,a,u,h,d,p,y){let v;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new V(C.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){zp(y,p);let P=[];for(let x of y)P.push($p(h,o,x));v={arrayValue:{values:P}}}else v=$p(h,o,y)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||zp(y,p),v=qT(u,a,y,p==="in"||p==="not-in");return pe.create(d,p,v)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function gg(n,e,t){let r=e,i=Dl("where",n);return To._create(i,r,t)}var rl=class n extends bi{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:rt.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let a=i,u=o.getFlattenedFilters();for(let h of u)_g(a,h),a=$c(a,h)}(e._query,t),new fr(e.firestore,e.converter,$c(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function $p(n,e,t){if(typeof(t=we(t))=="string"){if(t==="")throw new V(C.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Im(e)&&t.indexOf("/")!==-1)throw new V(C.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(oe.fromString(t));if(!M.isDocumentKey(r))throw new V(C.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return op(n,new M(r))}if(t instanceof Le)return op(n,t._key);throw new V(C.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${No(t)}.`)}function zp(n,e){if(!Array.isArray(n)||n.length===0)throw new V(C.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function _g(n,e){let t=function(i,o){for(let a of i)for(let u of a.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new V(C.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new V(C.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var il=class{convertValue(e,t="none"){switch(Ht(e)){case 0:return null;case 1:return e.booleanValue;case 2:return se(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(St(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw L(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Jt(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[nr].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>se(a.doubleValue));return new Ei(o)}convertGeoPoint(e){return new Ti(se(e.latitude),se(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=ko(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(pi(e));default:return null}}convertTimestamp(e){let t=kt(e);return new Te(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=oe.fromString(e);ee(Bm(r),9688,{name:e});let i=new Qs(r.get(1),r.get(3)),o=new M(r.popFirst(5));return i.isEqual(t)||At(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function jT(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var _n=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Eo=class extends wo{constructor(e,t,r,i,o,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Zn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Dl("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Zn=class extends Eo{data(e={}){return super.data(e)}},sl=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new _n(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Zn(this._firestore,this._userDataWriter,r.key,r,new _n(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new V(C.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{let h=new Zn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new _n(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{let h=new Zn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new _n(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,p=-1;return u.type!==0&&(d=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),p=a.indexOf(u.doc.key)),{type:GT(u.type),doc:h,oldIndex:d,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function GT(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return L(61501,{type:n})}}var bo=class extends il{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ii(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Le(this.firestore,null,t)}};function yg(n,e,t,...r){n=yn(n,Le);let i=yn(n.firestore,kn),o=Cl(i),a;return a=typeof(e=we(e))=="string"||e instanceof pr?BT(o,"updateDoc",n._key,e,t,r):UT(o,"updateDoc",n._key,e),Ig(i,[a.toMutation(n._key,Wt.exists(!0))])}function vg(n,e){let t=yn(n.firestore,kn),r=Sl(n),i=jT(n.converter,e);return Ig(t,[FT(Cl(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Wt.exists(!1))]).then(()=>r)}function Nl(n,...e){var t,r,i;n=we(n);let o={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||qp(e[a])||(o=e[a],a++);let u={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(qp(e[a])){let y=e[a];e[a]=(t=y.next)===null||t===void 0?void 0:t.bind(y),e[a+1]=(r=y.error)===null||r===void 0?void 0:r.bind(y),e[a+2]=(i=y.complete)===null||i===void 0?void 0:i.bind(y)}let h,d,p;if(n instanceof Le)d=yn(n.firestore,kn),p=ml(n._key.path),h={next:y=>{e[a]&&e[a](WT(d,n,y))},error:e[a+1],complete:e[a+2]};else{let y=yn(n,fr);d=yn(y.firestore,kn),p=y._query;let v=new bo(d);h={next:S=>{e[a]&&e[a](new sl(d,v,y,S))},error:e[a+1],complete:e[a+2]},zT(n._query)}return function(v,S,P,x){let D=new Qu(x),$=new $u(S,D,P);return v.asyncQueue.enqueueAndForget(()=>A(this,null,function*(){return mT(yield Op(v),$)})),()=>{D.yu(),v.asyncQueue.enqueueAndForget(()=>A(this,null,function*(){return gT(yield Op(v),$)}))}}(lg(d),p,u,h)}function Ig(n,e){return function(r,i){let o=new bt;return r.asyncQueue.enqueueAndForget(()=>A(this,null,function*(){return bT(yield OT(r),i,o)})),o.promise}(lg(n),e)}function WT(n,e,t){let r=t.docs.get(e._key),i=new bo(n);return new Eo(n,i,e._key,r,new _n(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){mr=i})($n),et(new Ve("firestore",(r,{instanceIdentifier:i,options:o})=>{let a=r.getProvider("app").getImmediate(),u=new kn(new Tc(r.getProvider("auth-internal")),new Ac(a,r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new V(C.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Qs(d.options.projectId,p)}(a,i),a);return o=Object.assign({useFetchStreams:t},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),he(Yf,Jf,e),he(Yf,Jf,"esm2017")})();var xo=function(){return xo=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},xo.apply(this,arguments)};var QT={includeMetadataChanges:!1};function xl(n,e){return e===void 0&&(e=QT),new nn(function(t){var r=Nl(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function wg(n){return xl(n,{includeMetadataChanges:!0})}function Tg(n,e){return e===void 0&&(e={}),wg(n).pipe(Wi(function(t){return Ol(t,e)}))}function Ol(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:xo(xo({},r),(t={},t[e.idField]=n.id,t))}function Eg(n){return xl(n,{includeMetadataChanges:!0}).pipe(Wi(function(e){return e.docs}))}function bg(n,e){return e===void 0&&(e={}),Eg(n).pipe(Wi(function(t){return t.map(function(r){return Ol(r,e)})}))}var Cn=class{constructor(e){return e}},Ag="firestore",Vl=class{constructor(){return Gn(Ag)}};var Ml=new Ki("angularfire2.firestore-instances");function YT(n,e){let t=vs(Ag,n,e);return t&&new Cn(t)}function JT(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Cn(r)}}var XT={provide:Vl,deps:[[new Vt,Ml]]},ZT={provide:Cn,useFactory:YT,deps:[[new Vt,Ml],hn]};function kg(n,...e){return he("angularfire",un.full,"fst"),Hi([ZT,XT,{provide:Ml,useFactory:JT(n),multi:!0,deps:[Mt,xn,ln,Zr,[new Vt,xs],[new Vt,ws],...e]}])}var Sg=Me(bg,!0);var Ll=Me(Tg,!0);var Fl=Me(vg,!0,2);var Oo=Me(cg,!0,2);var Ci=Me(Sl,!0,2);var Cg=Me(ug,!0);var Rg=Me(mg,!0,2);var Ul=Me(yg,!0,2);var Pg=Me(gg,!0,2);var Je=class n{firestore=j(Cn);addSession(e){return e.createdAt=new Date,Fl(Oo(this.firestore,"session"),{sessionData:e})}addTask(e){return e.createdAt=new Date,e=Object.assign({},e),Fl(Oo(this.firestore,"tasks"),{taskData:e})}getSession(e){let t=Ci(this.firestore,"session",e);return Ll(t,{idField:"id"})}getTask(e){let t=Ci(this.firestore,"tasks",e);return Ll(t,{idField:"id"})}getTasks(e){let t=Oo(this.firestore,"tasks"),r=Rg(t,Pg("taskData.sessionId","==",e));return Sg(r,{idField:"id"})}updateTask(e){let t=Ci(this.firestore,"tasks",e.id),r=e.taskData.voters.map(i=>Object.assign({},i));return e.taskData.voters=r,Ul(t,{taskData:e.taskData})}updateSession(e,t){let r=Ci(this.firestore,"session",e);return Ul(r,t)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Ot({token:n,factory:n.\u0275fac,providedIn:"root"})};var eE=["reactiveFormData"],vr=class n{reactiveFormModal;reactiveForm;sessionId;buttonLabel="Criar sess\xE3o";fb=j(ad);firebaseService=j(Je);router=j(Ge);route=j(it);modalPrimaryAction={action:()=>this.reactiveFormModal.close(),label:"Close"};constructor(){this.createReactiveForm()}ngOnInit(){this.route.paramMap.subscribe(e=>{this.sessionId=e.get("sessionId"),!this.sessionId&&localStorage.getItem("session")&&(this.sessionId=localStorage.getItem("session")),this.firebaseService.getSession(this.sessionId).subscribe(t=>{t&&(localStorage.setItem("sessionName",t.sessionData.name),localStorage.setItem("session",this.sessionId),localStorage.setItem("creator",t.sessionData.creator))},t=>{console.log(t)})}),localStorage.getItem("user")&&this.sessionId?this.router.navigate(["/session",this.sessionId]):this.sessionId&&(this.buttonLabel="Acessar sess\xE3o",this.reactiveForm.patchValue({name:this.sessionId}))}createReactiveForm(){this.reactiveForm=this.fb.group({creator:["",yt.compose([yt.required,yt.minLength(5),yt.maxLength(50)])],name:[this.sessionId,yt.compose([yt.required,yt.minLength(3),yt.maxLength(50)])]})}saveForm(){this.reactiveFormModal.open()}onClick(){let e=this.reactiveForm.value;this.sessionId?(localStorage.setItem("user",e.creator),this.router.navigate(["/session",this.sessionId])):this.reactiveForm.valid&&this.firebaseService.addSession(e).then(t=>{console.log("Sess\xE3o adicionada com sucesso!"+t),localStorage.setItem("session",t.id),localStorage.setItem("user",e.creator),localStorage.setItem("creator",e.creator),localStorage.setItem("sessionName",e.name),this.router.navigate(["/session",t.id]),this.reactiveForm.reset()}).catch(t=>{console.error("Erro ao adicionar sess\xE3o: ",t)})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=je({type:n,selectors:[["app-create-session"]],viewQuery:function(t,r){if(t&1&&mt(eE,7),t&2){let i;gt(i=_t())&&(r.reactiveFormModal=i.first)}},decls:10,vars:3,consts:[["p-title","Criar/Acessar sess\xE3o"],[1,"po-row"],[1,"po-md-4"],[3,"ngSubmit","formGroup"],[1,"po-row","po-mt-3"],["formControlName","creator","p-clean","","p-icon","an an-user","p-label","User Name",1,"po-md-12"],["formControlName","name","p-clean","","p-icon","an an-chalkboard-teacher","p-label","Session Name",1,"po-md-12","po-mt-2"],["type","submit","p-kind","primary",1,"po-p-5","po-md-12",3,"p-click","p-disabled","p-label"]],template:function(t,r){t&1&&(q(0,"po-page-default",0)(1,"div",1),le(2,"div",2),q(3,"div",2)(4,"form",3),_e("ngSubmit",function(){return r.onClick()}),q(5,"div",4),le(6,"po-input",5)(7,"po-input",6),W(),q(8,"po-button",7),_e("p-click",function(){return r.onClick()}),W()()(),le(9,"div",2),W()()),t&2&&(G(4),Y("formGroup",r.reactiveForm),G(4),Y("p-disabled",r.reactiveForm.invalid)("p-label",r.buttonLabel))},dependencies:[Ke,Bt,as,Un,ts,es,Ut,Zi,sd,od],encapsulation:2})};var Vo=class{sessionId;taskId;description;createdAt;updatedAt;result;voters;voting;complete;constructor(e,t,r,i,o,a,u,h,d){this.sessionId=e,this.taskId=t,this.description=r,this.createdAt=i,this.updatedAt=o,this.result=a,this.voters=u,this.voting=h,this.complete=d}},Mo=class{name;hasVoted;vote;size;constructor(e,t,r,i){this.name=e,this.hasVoted=t,this.vote=r,this.size=i}};var tE=()=>({legend:!1}),nE=()=>({label:"P",value:1}),rE=()=>({label:"M",value:2}),iE=()=>({label:"G",value:3}),sE=(n,e,t)=>[n,e,t];function oE(n,e){if(n&1){let t=Be();q(0,"po-button",23),_e("p-click",function(){Se(t);let i=ce(3);return Ce(i.complete())}),W()}n&2&&Y("p-label","Concluir")}function aE(n,e){if(n&1){let t=Be();q(0,"po-button",21),_e("p-click",function(){Se(t);let i=ce(2);return Ce(i.plan())}),W(),Ue(1,oE,1,1,"po-button",22)}if(n&2){let t=ce(2);Y("p-label",t.result()>0?"Nova vota\xE7\xE3o":"Refinar"),G(),Re(!(t.task==null||t.task.taskData==null)&&t.task.taskData.result?1:-1)}}function cE(n,e){if(n&1){let t=Be();q(0,"po-button",24),_e("p-click",function(){Se(t);let i=ce(2);return Ce(i.complete())}),W()}n&2&&Y("p-label","Finalizar vota\xE7\xE3o")}function uE(n,e){if(n&1&&Ue(0,aE,2,2)(1,cE,1,1,"po-button",20),n&2){let t=ce();Re(!t.task.taskData.voting&&!t.task.taskData.complete?0:-1),G(),Re(t.task.taskData.voting?1:-1)}}function lE(n,e){if(n&1){let t=Be();q(0,"po-button",25),_e("p-click",function(){Se(t);let i=ce();return Ce(i.vote())}),W()}}function hE(n,e){if(n&1&&le(0,"po-tag",11),n&2){let t=ce();Y("p-type",t.taskTag.type)("p-value",t.taskTag.value)}}function dE(n,e){if(n&1&&le(0,"po-info",12),n&2){let t=ce();Y("p-orientation",t.orientation)("p-value",t.resultSize())}}function fE(n,e){if(n&1){let t=Be();q(0,"po-button",26),_e("p-click",function(){Se(t);let i=ce();return Ce(i.openModal())}),W()}}var Ir=class n{poModal;task;isCreator=!1;sessionId=null;isInVotingRoom=!1;taskTag;orientation=Sd.Horizontal;votesBySize=[{label:"P",data:0},{label:"M",data:0},{label:"G",data:0}];newResult;result=qr(0);router=j(Ge);route=j(it);firebase=j(Je);poNotification=j($t);resultSize=ga(()=>{let e;return this.result()>0&&(this.result()==1?e="P":this.result()==2?e="M":(this.result()??!1)&&(e="G"),(this.task?.taskData?.voting??!1)||this.result()&&!this.task?.taskData?.complete?this.taskTag={value:"Em andamento",type:Gr.Warning}:this.taskTag=this.task?.taskData?.complete??!1?{value:"Finalizado",type:Gr.Success}:{value:"Pendente",type:Gr.Danger},this.calculateVotes()),e});get totalParticipantes(){let e=this.task?.taskData?.voters;return Array.isArray(e)?e.filter(t=>t.hasVoted).length.toString():"0"}ngOnInit(){this.sessionId=this.route.snapshot.paramMap.get("sessionId"),this.result.update(()=>this.task?.taskData?.result??0),this.calculateVotes()}calculateVotes(){this.votesBySize=[{label:"P",data:0},{label:"M",data:0},{label:"G",data:0}],this.task?.taskData?.voters.forEach(e=>{e.hasVoted&&e.vote>0&&(this.votesBySize[e.vote-1].data+=1)})}plan(){localStorage.setItem("voting","true"),this.task.taskData.voting=!0,this.task.taskData.updatedAt=new Date,this.task.taskData.voters=[],this.firebase.updateTask(this.task).then(()=>{this.poNotification.success("Item atualizado com sucesso!")}).catch(e=>{this.poNotification.error("Erro ao atualizar task: "+e)})}vote(){let e=new Mo(localStorage.getItem("user"),!1,0,"?");!this.task.taskData.voters.some(r=>r.name===e.name)&&(this.task.taskData.updatedAt=new Date,this.task.taskData.voters.push(e),this.firebase.updateTask(this.task).then(r=>{console.log("Task atualizada com sucesso!"+r)}).catch(r=>{this.poNotification.error("Erro ao atualizar task: "+r)})),this.router.navigate(["voting-room/",this.sessionId,this.task.id])}complete(){let e=0,t=0;!this.task.taskData.voting&&!this.task.taskData.complete&&(this.task.taskData.complete=!0,this.router.navigate(["/session",this.sessionId]),this.taskTag={value:"Finalizado",type:Gr.Success}),localStorage.setItem("voting","false"),this.task.taskData.updatedAt=new Date,this.task.taskData.voting=!1,this.newResult||(this.task?.taskData?.voters.forEach(r=>{r.hasVoted&&r.vote>0&&(e++,t+=r.vote)}),this.task.taskData.result=Math.round(t/e)),this.updateTask(this.task)}closeModal(){this.newResult=void 0,this.poModal.close()}openModal(){this.poModal.open()}setNewResult(){this.task.taskData.result=this.newResult??0,this.updateTask(this.task),this.poModal.close()}close={action:()=>{this.closeModal()},label:"Fechar",danger:!0};confirm={action:()=>{this.setNewResult()},label:"Confirmar"};updateTask(e){this.firebase.updateTask(e).then().catch(t=>{this.poNotification.error(t)}),this.result.update(()=>e.taskData?.result??0)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=je({type:n,selectors:[["app-task"]],viewQuery:function(t,r){if(t&1&&mt(qt,7),t&2){let i;gt(i=_t())&&(r.poModal=i.first)}},inputs:{task:"task",isCreator:"isCreator"},decls:26,vars:26,consts:[[1,"po-m-2"],[3,"p-title"],[1,"po-md-4","po-sm-12"],["p-label","Descri\xE7\xE3o",3,"p-value"],["p-label","Participantes",3,"p-orientation","p-value"],["p-label","Total de votos",3,"p-orientation","p-value"],[1,"po-md-4"],[3,"p-options","p-height","p-series"],[1,"po-md-12"],["p-label","Votar",1,"po-md-12"],[1,"po-md-12","po-row","po-m-2"],[3,"p-type","p-value"],["p-label","Resultado",3,"p-orientation","p-value"],["p-label","Ajustar resultado"],["p-title","Ajustar Resultado",3,"p-primary-action","p-secondary-action"],[1,"po-row"],["name","newResult","p-label","Novo resultado a ser definido",1,"po-md-12",3,"p-change","ngModel","p-options"],[3,"p-disabled-align"],["p-danger","true","p-label","Fechar",3,"p-click"],["p-kind","primary","p-label","Confirmar",3,"p-click"],["p-kind","primary",1,"po-md-12",3,"p-label"],[1,"po-md-12","btn-voting",3,"p-click","p-label"],["p-kind","primary",1,"po-md-12","po-mt-1",3,"p-label"],["p-kind","primary",1,"po-md-12","po-mt-1",3,"p-click","p-label"],["p-kind","primary",1,"po-md-12",3,"p-click","p-label"],["p-label","Votar",1,"po-md-12",3,"p-click"],["p-label","Ajustar resultado",3,"p-click"]],template:function(t,r){t&1&&(q(0,"div",0)(1,"po-container",1)(2,"div",2),le(3,"po-info",3)(4,"po-divider")(5,"po-info",4)(6,"po-info",5),W(),q(7,"div",6),le(8,"po-chart",7),W(),q(9,"div",2)(10,"div",8),Ue(11,uE,2,2)(12,lE,1,0,"po-button",9),W(),q(13,"div",10)(14,"div",6),Ue(15,hE,1,2,"po-tag",11)(16,dE,1,2,"po-info",12),W(),le(17,"div",6),q(18,"div",6),Ue(19,fE,1,0,"po-button",13),W()()()(),q(20,"po-modal",14)(21,"div",15)(22,"po-select",16),_e("p-change",function(o){return r.newResult=o}),W()(),q(23,"po-modal-footer",17)(24,"po-button",18),_e("p-click",function(){return r.closeModal()}),W(),q(25,"po-button",19),_e("p-click",function(){return r.setNewResult()}),W()()()()),t&2&&(G(),Y("p-title",r.task.taskData.taskId),G(2),Y("p-value",r.task.taskData.description),G(2),Y("p-orientation",r.orientation)("p-value",((r.task==null||r.task.taskData==null||r.task.taskData.voters==null?null:r.task.taskData.voters.length)||0).toString()),G(),Y("p-orientation",r.orientation)("p-value",r.totalParticipantes),G(2),Y("p-options",Lt(18,tE))("p-height",200)("p-series",r.votesBySize),G(3),Re(r.isCreator?11:r.task.taskData.voting?12:-1),G(4),Re(r.taskTag?15:-1),G(),Re(r.task&&r.task.taskData&&!r.task.taskData.voting&&r.resultSize()?16:-1),G(3),Re(r.task&&r.task.taskData&&r.isCreator&&r.task.taskData.result&&!r.task.taskData.voting&&!r.task.taskData.complete?19:-1),G(),Y("p-primary-action",r.confirm)("p-secondary-action",r.close),G(2),Y("ngModel",r.newResult)("p-options",Jh(22,sE,Lt(19,nE),Lt(20,rE),Lt(21,iE))),G(),Y("p-disabled-align",!1))},dependencies:[Ke,Bt,wd,Td,ns,Ad,ud,Cd,qt,os,Ft,Ln,Ut,Mn],encapsulation:2})};var pE=["optionsForm"],mE=(n,e)=>e.id;function gE(n,e){if(n&1&&le(0,"app-task",4),n&2){let t=e.$implicit,r=ce();Y("task",t)("isCreator",r.isCreator)}}var Lo=class n{form;poModal;userName=localStorage.getItem("user");sessionName=localStorage.getItem("sessionName");sessionId="";tasks;newTask=new Vo("","","",new Date,new Date,0,[],!1,!1);isCreator=!1;actions=[{label:"Vota\xE7\xE3o r\xE1pida",action:()=>this.startVoting()},{label:"Adicionar nova tarefa",action:()=>this.addTask()},{label:"Sair da sess\xE3o",action:()=>this.logout()}];firebaseService=j(Je);route=j(it);router=j(Ge);poNotification=j($t);ngOnInit(){this.sessionId=this.route.snapshot.paramMap.get("sessionId"),this.sessionId&&localStorage.getItem("session")!==this.sessionId&&(localStorage.setItem("session",this.sessionId),localStorage.getItem("user")||this.router.navigate(["createsession"]),this.firebaseService.getSession(this.sessionId).subscribe(e=>{e&&(localStorage.setItem("sessionName",e.sessionData.name),this.sessionName=e.sessionData.name)},e=>{console.log(e)})),this.isCreator=this.userName==localStorage.getItem("creator"),this.actions[0].visible=this.isCreator,this.getTasks()}addNewTask(){this.form.invalid?this.poNotification.warning("Verifique os campos"):(this.confirm.loading=!0,this.newTask.sessionId=this.sessionId,this.firebaseService.addTask(this.newTask).then(()=>{this.poNotification.success("Item adicionado com sucesso!"),this.confirm.loading=!1,this.form.reset(),this.closeModal()}).catch(e=>{this.poNotification.error(e)}))}getTasks(){this.firebaseService.getTasks(this.sessionId).subscribe(e=>{this.tasks=e})}logout(){localStorage.clear(),this.router.navigate(["createsession"])}addTask(){this.poModal.open()}close={action:()=>{this.closeModal()},label:"Close",danger:!0};confirm={action:()=>{this.addNewTask()},label:"Confirm"};closeModal(){this.form.reset(),this.poModal.close()}restore(){this.form.reset()}startVoting(){this.newTask.sessionId=this.sessionId,this.newTask.taskId=((this.tasks?this.tasks?.length:0)+1).toString(),this.newTask.description="Vota\xE7\xE3o r\xE1pida!",this.newTask.voting=!0,this.firebaseService.addTask(this.newTask).then(()=>{this.poNotification.success("Item adicionado com sucesso!"),this.confirm.loading=!1,this.form.reset(),this.closeModal()}).catch(e=>{this.poNotification.error(e)})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=je({type:n,selectors:[["app-session-tasks"]],viewQuery:function(t,r){if(t&1&&(mt(pE,7),mt(qt,7)),t&2){let i;gt(i=_t())&&(r.form=i.first),gt(i=_t())&&(r.poModal=i.first)}},decls:15,vars:9,consts:[["optionsForm","ngForm"],["p-title","Tarefas da sess\xE3o",3,"p-actions","p-subtitle"],[1,"po-m-2"],[1,"row","po-m-2"],[3,"task","isCreator"],["p-title","Criar tarefa",3,"p-primary-action","p-secondary-action"],[1,"po-row"],["name","taskId","p-label","C\xF3digo da tarefa:",1,"po-md-12",3,"ngModelChange","ngModel"],["name","description","p-label","Descri\xE7\xE3o:",1,"po-md-12",3,"ngModelChange","ngModel"],[3,"p-disabled-align"],["p-danger","true","p-label","Fechar",3,"p-click"],["p-kind","primary","p-label","Confirmar",3,"p-click"]],template:function(t,r){if(t&1){let i=Be();q(0,"po-page-default",1),le(1,"po-divider",2),q(2,"div",3),On(3,gE,1,2,"app-task",4,mE),W(),q(5,"po-modal",5)(6,"form",null,0)(8,"div",6)(9,"po-input",7),jr("ngModelChange",function(a){return Se(i),zr(r.newTask.taskId,a)||(r.newTask.taskId=a),Ce(a)}),W()(),q(10,"div",6)(11,"po-textarea",8),jr("ngModelChange",function(a){return Se(i),zr(r.newTask.description,a)||(r.newTask.description=a),Ce(a)}),W()()(),q(12,"po-modal-footer",9)(13,"po-button",10),_e("p-click",function(){return Se(i),Ce(r.closeModal())}),W(),q(14,"po-button",11),_e("p-click",function(){return Se(i),Ce(r.addNewTask())}),W()()()()}t&2&&(Ji("p-subtitle","Ol\xE1, ",r.userName,"! Bem vindo a sess\xE3o de planning ",r.sessionName,"."),Y("p-actions",r.actions),G(3),Vn(r.tasks),G(2),Y("p-primary-action",r.confirm)("p-secondary-action",r.close),G(4),$r("ngModel",r.newTask.taskId),G(2),$r("ngModel",r.newTask.description),G(),Y("p-disabled-align",!1))},dependencies:[Ke,Bt,ns,as,kd,qt,os,Un,ts,es,Ut,Zi,Ln,Mn,id,Ir,Ft],encapsulation:2})};var wr=class n{router=j(Ge);canActivate(e){return e.paramMap.get("sessionId"),!!localStorage.getItem("user")?!0:(this.router.navigate(["joinsession/",e.paramMap.get("sessionId")]),!1)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Ot({token:n,factory:n.\u0275fac,providedIn:"root"})};var _E=["meuStepper"],yE=(n,e)=>e.id;function vE(n,e){return this.task.id}function IE(n,e){if(n&1&&(q(0,"div"),le(1,"po-avatar",12),W()),n&2){let t=e.$implicit;G(),Y("p-tooltip",t.name)}}function wE(n,e){if(n&1&&On(0,IE,2,1,"div",null,vE,!0),n&2){let t=ce();Vn(t.task.taskData.voters)}}function TE(n,e){if(n&1&&(q(0,"p",13),Xi(1),W()),n&2){let t=e.$implicit;G(),pa(" * ",t,"")}}function EE(n,e){if(n&1){let t=Be();q(0,"po-step",7)(1,"h2"),Xi(2),W(),On(3,TE,2,1,"p",13,Hh),q(5,"po-radio-group",14),jr("ngModelChange",function(i){let o=Se(t).$implicit;return zr(o.answer,i)||(o.answer=i),Ce(i)}),W()()}if(n&2){let t=e.$implicit;Y("p-label",t.label)("p-icon-default",t.iconDefault),G(2),Qh(t.label),G(),Vn(t.values),G(2),Y("p-options",t.options),$r("ngModel",t.answer)}}function bE(n,e){if(n&1){let t=Be();q(0,"po-button",15),_e("p-click",function(){Se(t);let i=ce();return Ce(i.finalizarAcao())}),W()}if(n&2){let t=ce();Y("p-disabled",!t.steps[2].answer)}}function AE(n,e){if(n&1){let t=Be();q(0,"po-button",16),_e("p-click",function(){Se(t);let i=ce();return Ce(i.next())}),W()}if(n&2){let t=ce();Y("p-disabled",t.passoAtual()==="Escopo"&&!t.steps[0].answer||t.passoAtual()==="Desenvolvimento"&&!t.steps[1].answer)}}var Fo=class n{meuStepper;passoAtual=qr("");task;firebase=j(Je);route=j(it);router=j(Ge);poNotification=j($t);ngOnInit(){this.getTaskData()}objectiveOptions=[{label:"P - Muito claro com pouca chance de altera\xE7\xE3o",value:1},{label:"M - Claro com alguma chance de altera\xE7\xE3o",value:2},{label:"G - Pouco claro com alta chance de altera\xE7\xE3o",value:3},{label:"? - N\xE3o consigo opinar",value:-1}];developmentOptions=[{label:"P - Complexidade Baixa",value:1},{label:"M - Complexidade M\xE9dia",value:2},{label:"G - Complexidade Alta",value:3},{label:"? - N\xE3o consigo opinar",value:-1}];testsOptions=[{label:"P - Complexidade Baixa",value:1},{label:"M - Complexidade M\xE9dia",value:2},{label:"G - Complexidade Alta",value:3},{label:"? - N\xE3o consigo opinar",value:-1}];steps=[{label:"Escopo",id:"1",values:["Houve um completo entendimento de todo escopo dessa hist\xF3ria?","Enxerga a possibilidade de precisar refinar melhor o como a tarefa ser\xE1 realizada?","Acredita que a hist\xF3ria em quest\xE3o possa trazer novas demandas como o adapta\xE7\xE3o de funcionalidades pr\xE9-existentes?"],options:this.objectiveOptions,answer:0},{label:"Desenvolvimento",id:"2",values:["Desenvolvimento - Deve integrar com outro sistema?","A valida\xE7\xE3o exige contato com times externos?","Desenvolvimento do teste unit\xE1rio \xE9 complexo?"],options:this.developmentOptions,answer:0},{label:"Testes",id:"3",values:["O teste manual \xE9 necess\xE1rio? Domina a configura\xE7\xE3o necess\xE1ria e tem os pr\xE9-requisitos para o teste?","O teste exige intera\xE7\xE3o com times externos?"],options:this.testsOptions,answer:0}];getTaskData(){this.route.snapshot.paramMap.get("taskId")&&this.firebase.getTask(this.route.snapshot.paramMap.get("taskId")).subscribe(e=>{this.task=e},e=>this.poNotification.error(e))}atualizarPassoAtual(e){typeof e=="object"&&this.passoAtual.set(e.label)}next(){this.meuStepper?.next()}finalizarAcao(){let e=this.steps.length,t=0,r=0;if(this.task?.taskData?.voting){this.steps.forEach(i=>{i.answer>0?t+=i.answer:e--}),r=e>=1?Math.round(t/e):t,this.task.taskData.updatedAt=new Date;for(let i of this.task.taskData.voters)i.name===localStorage.getItem("user")&&(i.hasVoted=!0,i.vote=r,r==0?i.size="?":r==1?i.size="P":r==2?i.size="M":r==3&&(i.size="G"));this.firebase.updateTask(this.task).then().catch(i=>{this.poNotification.error(i)})}this.router.navigate(["/voting-result",this.route.snapshot.paramMap.get("sessionId"),this.route.snapshot.paramMap.get("taskId")])}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=je({type:n,selectors:[["app-voting-room"]],viewQuery:function(t,r){if(t&1&&mt(_E,5),t&2){let i;gt(i=_t())&&(r.meuStepper=i.first)}},decls:16,vars:5,consts:[["meuStepper",""],[1,"po-row","po-page"],[1,"po-md-12"],[1,"po-font-title"],[1,"container-usuarios"],[1,"po-row"],[3,"p-change-step","p-steps","p-disable-click"],[3,"p-label","p-icon-default"],[1,"po-row","po-mt-2"],[1,"po-md-12","po-text-right"],["p-label","Finalizar","p-kind","primary",1,"po-md-12",3,"p-disabled"],["p-label","Avan\xE7ar",1,"po-md-12",3,"p-disabled"],["p-src","https://po-ui.io/assets/graphics/logo-po.png",1,"usuarios",3,"p-tooltip"],[1,"po-m-2"],["name","tests","p-label","Selecione o valor mais adequado de acordo com a perguntas acima:",3,"ngModelChange","p-options","ngModel"],["p-label","Finalizar","p-kind","primary",1,"po-md-12",3,"p-click","p-disabled"],["p-label","Avan\xE7ar",1,"po-md-12",3,"p-click","p-disabled"]],template:function(t,r){if(t&1){let i=Be();q(0,"div",1)(1,"div",2)(2,"h1",3),Xi(3),W(),q(4,"div",4),Ue(5,wE,2,0),W(),q(6,"div",5)(7,"div",2)(8,"po-stepper",6,0),_e("p-change-step",function(a){return Se(i),Ce(r.atualizarPassoAtual(a))}),On(10,EE,6,5,"po-step",7,yE),W(),q(12,"div",8)(13,"div",9),Ue(14,bE,1,1,"po-button",10)(15,AE,1,1,"po-button",11),W()()()()()()}t&2&&(G(3),pa("Vota\xE7\xE3o: ",r.task==null||r.task.taskData==null?null:r.task.taskData.taskId,""),G(2),Re(r.task&&r.task.taskData?5:-1),G(3),Y("p-steps",r.steps)("p-disable-click",!0),G(2),Vn(r.steps),G(4),Re(r.passoAtual()==="Testes"?14:15))},dependencies:[Ke,ld,Bt,Ed,Rd,Pd,cd,Ln,Ut,Mn],styles:[".container-usuarios[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px}"]})};var kE=()=>({property:"name",label:"Nome"}),SE=()=>({property:"size",label:"Tamanho"}),CE=(n,e)=>[n,e];function RE(n,e){n&1&&le(0,"po-loading-overlay",1),n&2&&Y("p-screen-lock",!0)}function PE(n,e){if(n&1&&le(0,"po-table",3),n&2){let t=ce(3);Y("p-items",t.task.taskData.voters)("p-columns",Yh(4,CE,Lt(2,kE),Lt(3,SE)))}}function DE(n,e){if(n&1&&(le(0,"app-task",2),Ue(1,PE,1,7,"po-table",3)),n&2){let t=ce(2);Y("isCreator",!1)("task",t.task),G(),Re(t.task.taskData.voting?-1:1)}}function NE(n,e){if(n&1&&(q(0,"po-page-default",0),Ue(1,RE,1,1,"po-loading-overlay",1)(2,DE,2,3),W()),n&2){let t=ce();Ji("p-subtitle","Sess\xE3o de refinamento: ",t.sessionName,". | ",t.userName,""),Y("p-actions",t.actions),G(),Re(t.task.taskData.voting&&!t.task.taskData.result?1:-1),G(),Re(t.task?2:-1)}}var Uo=class n{task;actions=[{label:"Sair",action:()=>this.goToSession()}];userName=localStorage.getItem("user")??"";sessionName=localStorage.getItem("session")??"";firebase=j(Je);route=j(it);router=j(Ge);poNotification=j($t);ngOnInit(){this.route.snapshot.paramMap.get("taskId")&&this.firebase.getTask(this.route.snapshot.paramMap.get("taskId")).subscribe({next:e=>this.task=e,error:e=>console.log(e)})}voteAgain(){this.router.navigate(["voting-room/",this.route.snapshot.paramMap.get("sessionId"),this.route.snapshot.paramMap.get("taskId")])}goToSession(){this.task?.taskData?.complete?this.router.navigate(["/session",this.route.snapshot.paramMap.get("sessionId")]):this.poNotification.warning("Aguarde a conclus\xE3o")}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=je({type:n,selectors:[["app-voting-result"]],decls:1,vars:1,consts:[["p-title","Resultado",3,"p-subtitle","p-actions"],["p-text","Aguarde o fim da vota\xE7\xE3o",3,"p-screen-lock"],[3,"isCreator","task"],[3,"p-items","p-columns"]],template:function(t,r){t&1&&Ue(0,NE,3,6,"po-page-default",0),t&2&&Re(r.task&&r.task.taskData?0:-1)},dependencies:[Ke,Id,Un,bd,Ft,Ir],encapsulation:2})};var Dg=[{path:"",component:vr},{path:"createsession",component:vr},{path:"joinsession/:sessionId",component:vr},{path:"session/:sessionId",component:Lo,canActivate:[wr]},{path:"voting-room/:sessionId/:taskId",component:Fo,canActivate:[wr]},{path:"voting-result/:sessionId/:taskId",component:Uo,canActivate:[wr]}];td(us,{providers:[rd(Dg),vf(()=>If(Nd.firebaseConfig)),kg(()=>Cg()),ed()]}).catch(n=>console.error(n));
